<!DOCTYPE html><html lang="en" dir="ltr"><head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="generator" content="ReSpec 35.2.0">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-color:var(--warning-border,#f11);border-width:.2em;border-style:solid;background:#fbe9e9;background:var(--warning-bg,#fbe9e9);color:#000;color:var(--text,#000)}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;background:var(--indextable-hover-bg,#fff);color:#000;color:var(--text,#000);box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);box-shadow:0 1em 3em -.4em var(--tocsidebar-shadow,rgba(0,0,0,.3)),0 0 1px 1px var(--tocsidebar-shadow,rgba(0,0,0,.05));border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;border-bottom-color:var(--indextable-hover-bg,#fff);top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1;border-bottom-color:var(--indextable-hover-bg,#a2a9b1)}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;color:var(--text,#000);margin-top:.25em}
.dfn-panel ul a[href]{color:#333;color:var(--text,#333)}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
    
<title>Controlled Identifier Document 1.0</title>
    
    
    
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
    
    

    
    
<style>

code {
  color: rgb(199, 73, 0);
  font-weight: bold;
}
pre.highlight {
  font-weight: bold;
  color: green;
}
pre.nohighlight {
  overflow-x: auto;
  white-space: pre-wrap;
}
ol.algorithm { counter-reset:numsection; list-style-type: none; }
ol.algorithm li { margin: 0.5em 0; }
ol.algorithm li:before { font-weight: bold; counter-increment: numsection; content: counters(numsection, ".") ") "; }
table.simple {
    border-collapse: collapse;
    margin: 25px 0;
    min-width: 400px;
    border: 1px solid #dddddd;
}
table.simple thead tr {
    background-color: #005a9c;
    color: #ffffff;
    text-align: left;
}
table.simple th,
table.simple td {
    padding: 12px 15px;
    vertical-align: top;
    text-align: left;
}
table.simple tbody tr {
    border-bottom: 1px solid #dddddd;
}
table.simple tbody tr:nth-of-type(even) {
    background-color: #00000008;
}
table.simple tbody tr:last-of-type {
    border-bottom: 2px solid #005a9c;
}
    
</style>

<meta name="color-scheme" content="light">
<meta name="description" content="A controlled identifier document contains cryptographic material and lists service
endpoints for the purposes of verifying cryptographic proofs from, and
interacting with, the controller of an identifier.">
<link rel="canonical" href="https://www.w3.org/TR/cid-1.0/">
<style>
.hljs{--base:#fafafa;--mono-1:#383a42;--mono-2:#686b77;--mono-3:#717277;--hue-1:#0b76c5;--hue-2:#336ae3;--hue-3:#a626a4;--hue-4:#42803c;--hue-5:#ca4706;--hue-5-2:#c91243;--hue-6:#986801;--hue-6-2:#9a6a01}
@media (prefers-color-scheme:dark){
.hljs{--base:#282c34;--mono-1:#abb2bf;--mono-2:#818896;--mono-3:#5c6370;--hue-1:#56b6c2;--hue-2:#61aeee;--hue-3:#c678dd;--hue-4:#98c379;--hue-5:#e06c75;--hue-5-2:#be5046;--hue-6:#d19a66;--hue-6-2:#e6c07b}
}
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;color:var(--mono-1,#383a42);background:#fafafa;background:var(--base,#fafafa)}
.hljs-comment,.hljs-quote{color:#717277;color:var(--mono-3,#717277);font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4;color:var(--hue-3,#a626a4)}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;color:var(--hue-5,#ca4706);font-weight:700}
.hljs-literal{color:#0b76c5;color:var(--hue-1,#0b76c5)}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c;color:var(--hue-4,#42803c)}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01;color:var(--hue-6-2,#9a6a01)}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801;color:var(--hue-6,#986801)}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3;color:var(--hue-2,#336ae3)}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#222}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#222;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<style>

  .vc-tabbed {
    overflow-x: hidden;
    margin: 0 0;
  }

  .vc-tabbed [type="radio"] {
    display: none;
  }

  .vc-tabs {
    display: flex;
    align-items: stretch;
    list-style: none;
    padding: 0;
    border-bottom: 1px solid #ccc;
  }

  li.vc-tab {
    margin: unset;
  }

  .vc-tab > label {
    display: block;
    margin-bottom: -1px;
    padding: .4em .5em;
    border: 1px solid #ccc;
    border-top-right-radius: .4em;
    border-top-left-radius: .4em;
    background: #eee;
    color: #666;
    cursor: pointer;
    transition: all 0.3s;
  }
  .vc-tab:hover label {
    border-left-color: #333;
    border-top-color: #333;
    border-right-color: #333;
    color: #333;
  }

  .vc-tab-content {
    display: none;
  }

  .vc-tabbed [type="radio"]:nth-of-type(1):checked ~ .vc-tabs .vc-tab:nth-of-type(1) label,
  .vc-tabbed [type="radio"]:nth-of-type(2):checked ~ .vc-tabs .vc-tab:nth-of-type(2) label,
  .vc-tabbed [type="radio"]:nth-of-type(3):checked ~ .vc-tabs .vc-tab:nth-of-type(3) label,
  .vc-tabbed [type="radio"]:nth-of-type(4):checked ~ .vc-tabs .vc-tab:nth-of-type(4) label,
  .vc-tabbed [type="radio"]:nth-of-type(5):checked ~ .vc-tabs .vc-tab:nth-of-type(5) label,
  .vc-tabbed [type="radio"]:nth-of-type(6):checked ~ .vc-tabs .vc-tab:nth-of-type(6) label {
    border-bottom-color: #fff;
    background: #fff;
    color: #222;
  }

  .vc-tabbed [type="radio"]:nth-of-type(1):checked ~ .vc-tab-content:nth-of-type(1),
  .vc-tabbed [type="radio"]:nth-of-type(2):checked ~ .vc-tab-content:nth-of-type(2),
  .vc-tabbed [type="radio"]:nth-of-type(3):checked ~ .vc-tab-content:nth-of-type(3),
  .vc-tabbed [type="radio"]:nth-of-type(4):checked ~ .vc-tab-content:nth-of-type(4),
  .vc-tabbed [type="radio"]:nth-of-type(5):checked ~ .vc-tab-content:nth-of-type(5),
  .vc-tabbed [type="radio"]:nth-of-type(6):checked ~ .vc-tab-content:nth-of-type(6) {
    display: block;
  }
</style>
<script id="initialUserConfig" type="application/json">{
  "specStatus": "CR",
  "shortName": "cid-1.0",
  "publishDate": "2025-01-09",
  "edDraftURI": "https://w3c.github.io/cid/",
  "implementationReportURI": "https://w3c.github.io/cid/implementations/1.0/",
  "crEnd": "2025-02-09",
  "editors": [
    {
      "name": "Manu Sporny",
      "url": "https://www.linkedin.com/in/manusporny/",
      "company": "Digital Bazaar",
      "companyURL": "http://digitalbazaar.com/",
      "w3cid": 41758
    },
    {
      "name": "Michael B. Jones",
      "url": "https://self-issued.info/",
      "company": "Invited Expert",
      "w3cid": 38745
    }
  ],
  "authors": [
    {
      "name": "Dave Longley",
      "url": "http://digitalbazaar.com/",
      "company": "Digital Bazaar",
      "companyURL": "http://digitalbazaar.com/"
    },
    {
      "name": "Manu Sporny",
      "url": "http://digitalbazaar.com/",
      "company": "Digital Bazaar",
      "companyURL": "http://digitalbazaar.com/"
    },
    {
      "name": "Markus Sabadello",
      "url": "https://www.linkedin.com/in/markus-sabadello-353a0821",
      "company": "Danube Tech",
      "companyURL": "https://danubetech.com/",
      "w3cid": 46729
    },
    {
      "name": "Drummond Reed",
      "url": "https://www.linkedin.com/in/drummondreed/",
      "company": "Evernym/Avast",
      "companyURL": "https://www.evernym.com/",
      "w3cid": 3096
    },
    {
      "name": "Orie Steele",
      "url": "https://www.linkedin.com/in/or13b/",
      "company": "Transmute",
      "companyURL": "https://transmute.industries/"
    },
    {
      "name": "Christopher Allen",
      "url": "https://www.linkedin.com/in/christophera",
      "company": "Blockchain Commons",
      "companyURL": "https://www.BlockchainCommons.com",
      "w3cid": 85560
    }
  ],
  "group": "vc",
  "wgPublicList": "public-vc-wg",
  "github": "w3c/cid",
  "xref": [
    "URL",
    "I18N-GLOSSARY",
    "INFRA",
    "VC-DATA-MODEL-2.0"
  ],
  "maxTocLevel": 3,
  "localBiblio": {
    "DI-EDDSA": {
      "title": "The Edwards Digital Signature Algorithm Cryptosuites v1.0",
      "href": "https://www.w3.org/TR/vc-di-eddsa/",
      "authors": [
        "David Longley",
        "Manu Sporny",
        "Dmitri Zagidulin"
      ],
      "status": "WD",
      "publisher": "W3C Verifiable Credentials Working Group"
    },
    "DI-ECDSA": {
      "title": "The Elliptic Curve Digital Signature Algorithm Cryptosuites v1.0",
      "href": "https://www.w3.org/TR/vc-di-ecdsa/",
      "authors": [
        "David Longley",
        "Manu Sporny",
        "Marty Reed"
      ],
      "status": "WD",
      "publisher": "W3C Verifiable Credentials Working Group"
    },
    "DI-BBSDSA": {
      "title": "The BBS Digital Signature Algorithm Cryptosuites v1.0",
      "href": "https://www.w3.org/TR/vc-di-bbs/",
      "authors": [
        "Tobias Looker",
        "Orie Steele"
      ],
      "status": "WD",
      "publisher": "W3C Verifiable Credentials Working Group"
    },
    "JOSE-REGISTRIES": {
      "title": "The JSON Object Signing and Encryption (JOSE) Registries",
      "href": "https://www.iana.org/assignments/jose",
      "authors": [
        "The Internet Assigned Numbers Authority"
      ],
      "status": "REC",
      "publisher": "The Internet Assigned Numbers Authority",
      "id": "jose-registries"
    },
    "SECURITY-VOCABULARY": {
      "title": "The Security Vocabulary",
      "href": "https://w3id.org/security",
      "authors": [
        "Ivan Herman",
        "Manu Sporny",
        "David Longley"
      ],
      "status": "ED",
      "publisher": "Verifiable Credentials Working Group"
    },
    "ZCAP": {
      "title": "Authorization Capabilities for Linked Data",
      "href": "https://w3c-ccg.github.io/zcap-spec/",
      "status": "CGDRAFT",
      "publisher": "Credentials Community Group"
    },
    "MULTIBASE": {
      "title": "The Multibase Data Format",
      "date": "February 2023",
      "href": "https://datatracker.ietf.org/doc/draft-multiformats-multibase",
      "authors": [
        "Juan Benet",
        "Manu Sporny"
      ],
      "status": "Internet-Draft",
      "publisher": "IETF"
    },
    "MULTIHASH": {
      "title": "The Multihash Data Format",
      "date": "February 2023",
      "href": "https://datatracker.ietf.org/doc/draft-multiformats-multihash",
      "authors": [
        "Juan Benet",
        "Manu Sporny"
      ],
      "status": "Internet-Draft",
      "publisher": "IETF"
    },
    "MULTICODEC": {
      "title": "The Multi Codec Encoding Scheme",
      "date": "February 2022",
      "href": "https://github.com/multiformats/multicodec/blob/master/table.csv",
      "authors": [
        "The Multiformats Community"
      ],
      "status": "Internet-Draft",
      "publisher": "IETF"
    },
    "VC-EXTENSIONS": {
      "title": "Verifiable Credential Extensions",
      "href": "https://www.w3.org/TR/vc-extensions/",
      "authors": [
        "Manu Sporny"
      ],
      "status": "NOTE",
      "publisher": "W3C Verifiable Credentials Working Group",
      "id": "vc-extensions"
    },
    "SHA3": {
      "title": "SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions",
      "href": "https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf",
      "authors": [
        "National Institute of Standards and Technology"
      ],
      "status": "National Standard",
      "publisher": "U.S. Department of Commerce",
      "id": "sha3"
    },
    "SD-JWT": {
      "title": "Selective Disclosure for JWTs (SD-JWT)",
      "href": "https://datatracker.ietf.org/doc/draft-ietf-oauth-selective-disclosure-jwt/",
      "authors": [
        "Daniel Fett",
        "Kristina Yasuda",
        "Brian Campbell"
      ],
      "status": "I-D",
      "publisher": "The IETF OAuth Working Group"
    },
    "PRIVACY-BY-DESIGN": {
      "title": "Privacy by Design",
      "href": "https://iapp.org/media/pdf/resource_center/pbd_implement_7found_principles.pdf",
      "authors": [
        "Ann Cavoukian"
      ],
      "date": "2011",
      "publisher": "Information and Privacy Commissioner",
      "id": "privacy-by-design"
    }
  },
  "postProcess": [
    null
  ],
  "otherLinks": [
    {
      "key": "Related Specifications",
      "data": [
        {
          "value": "Decentralized Identifiers v1.0",
          "href": "https://www.w3.org/TR/did-core/"
        },
        {
          "value": "The Verifiable Credentials Data Model v2.0",
          "href": "https://www.w3.org/TR/vc-data-model-2.0/"
        },
        {
          "value": "Data Integrity v1.0",
          "href": "https://www.w3.org/TR/vc-data-integrity/"
        },
        {
          "value": "Securing Verifiable Credentials using JOSE and COSE",
          "href": "https://www.w3.org/TR/vc-jose-cose/"
        }
      ]
    }
  ],
  "publishISODate": "2025-01-09T00:00:00.000Z",
  "generatedSubtitle": "W3C Candidate Recommendation Snapshot 09 January 2025"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/W3C-CR"></head>
<body class="h-entry" data-cite="URL I18N-GLOSSARY INFRA VC-DATA-MODEL-2.0"><div class="head">
    <p class="logos"><a class="logo" href="https://www.w3.org/"><img crossorigin="" alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
  </a></p>
    <h1 id="title" class="title">Controlled Identifier Document 1.0</h1> 
    <p id="w3c-state"><a href="https://www.w3.org/standards/types#CR">W3C Candidate Recommendation Snapshot</a> <time class="dt-published" datetime="2025-01-09">09 January 2025</time></p>
    <details open="">
      <summary>More details about this document</summary>
      <dl>
        <dt>This version:</dt><dd>
                <a class="u-url" href="https://www.w3.org/TR/2025/CR-cid-1.0-20250109/">https://www.w3.org/TR/2025/CR-cid-1.0-20250109/</a>
              </dd>
        <dt>Latest published version:</dt><dd>
                <a href="https://www.w3.org/TR/cid-1.0/">https://www.w3.org/TR/cid-1.0/</a>
              </dd>
        <dt>Latest editor's draft:</dt><dd><a href="https://w3c.github.io/cid/">https://w3c.github.io/cid/</a></dd>
        <dt>History:</dt><dd>
                    <a href="https://github.com/w3c/cid/commits/">Commit history</a>
                  </dd>
        
        <dt>Implementation report:</dt><dd>
                <a href="https://w3c.github.io/cid/implementations/1.0/">https://w3c.github.io/cid/implementations/1.0/</a>
              </dd>
        
        
        
        <dt>Editors:</dt><dd class="editor p-author h-card vcard" data-editor-id="41758">
    <a class="u-url url p-name fn" href="https://www.linkedin.com/in/manusporny/">Manu Sporny</a> (<a class="p-org org h-org" href="http://digitalbazaar.com/">Digital Bazaar</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="38745">
    <a class="u-url url p-name fn" href="https://self-issued.info/">Michael B. Jones</a> (<span class="p-org org h-org">Invited Expert</span>)
  </dd>
        
        <dt>Authors:</dt><dd class="editor p-author h-card vcard">
    <a class="u-url url p-name fn" href="http://digitalbazaar.com/">Dave Longley</a> (<a class="p-org org h-org" href="http://digitalbazaar.com/">Digital Bazaar</a>)
  </dd><dd class="editor p-author h-card vcard">
    <a class="u-url url p-name fn" href="http://digitalbazaar.com/">Manu Sporny</a> (<a class="p-org org h-org" href="http://digitalbazaar.com/">Digital Bazaar</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="46729">
    <a class="u-url url p-name fn" href="https://www.linkedin.com/in/markus-sabadello-353a0821">Markus Sabadello</a> (<a class="p-org org h-org" href="https://danubetech.com/">Danube Tech</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="3096">
    <a class="u-url url p-name fn" href="https://www.linkedin.com/in/drummondreed/">Drummond Reed</a> (<a class="p-org org h-org" href="https://www.evernym.com/">Evernym/Avast</a>)
  </dd><dd class="editor p-author h-card vcard">
    <a class="u-url url p-name fn" href="https://www.linkedin.com/in/or13b/">Orie Steele</a> (<a class="p-org org h-org" href="https://transmute.industries/">Transmute</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="85560">
    <a class="u-url url p-name fn" href="https://www.linkedin.com/in/christophera">Christopher Allen</a> (<a class="p-org org h-org" href="https://www.BlockchainCommons.com">Blockchain Commons</a>)
  </dd>
        <dt>Feedback:</dt><dd>
        <a href="https://github.com/w3c/cid/">GitHub w3c/cid</a>
        (<a href="https://github.com/w3c/cid/pulls/">pull requests</a>,
        <a href="https://github.com/w3c/cid/issues/new/choose">new issue</a>,
        <a href="https://github.com/w3c/cid/issues/">open issues</a>)
      </dd><dd><a href="mailto:public-vc-wg@w3.org?subject=%5Bcid-1.0%5D%20YOUR%20TOPIC%20HERE">public-vc-wg@w3.org</a> with subject line <kbd>[cid-1.0] <em>… message topic …</em></kbd> (<a rel="discussion" href="https://lists.w3.org/Archives/Public/public-vc-wg">archives</a>)</dd>
        
        <dt>Related Specifications</dt><dd>
    <a href="https://www.w3.org/TR/did-core/">Decentralized Identifiers v1.0</a>
  </dd><dd>
    <a href="https://www.w3.org/TR/vc-data-model-2.0/">The Verifiable Credentials Data Model v2.0</a>
  </dd><dd>
    <a href="https://www.w3.org/TR/vc-data-integrity/">Data Integrity v1.0</a>
  </dd><dd>
    <a href="https://www.w3.org/TR/vc-jose-cose/">Securing Verifiable Credentials using JOSE and COSE</a>
  </dd>
      </dl>
    </details>
    
    
    <p class="copyright">
    <a href="https://www.w3.org/policies/#copyright">Copyright</a>
    ©
    2025
    
    <a href="https://www.w3.org/">World Wide Web Consortium</a>.
    <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup>
    <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>,
    <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and
    <a rel="license" href="https://www.w3.org/copyright/software-license-2023/" title="W3C Software and Document Notice and License">permissive document license</a> rules apply.
  </p>
    <hr title="Separator for header">
  </div>
    <section id="abstract" class="introductory"><h2>Abstract</h2>
      <p>
A controlled identifier document contains cryptographic material and lists service
endpoints for the purposes of verifying cryptographic proofs from, and
interacting with, the controller of an identifier.
      </p>
    </section>

    <section id="sotd" class="introductory"><h2>Status of This Document</h2><p><em>This section describes the status of this
      document at the time of its publication. A list of current <abbr title="World Wide Web Consortium">W3C</abbr>
      publications and the latest revision of this technical report can be found
      in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at
      https://www.w3.org/TR/.</em></p>
      <p>
The Working Group is actively seeking implementation feedback for this
specification. In order to exit the Candidate Recommendation phase, the
Working Group has set the requirement of at least two independent
implementations for each mandatory feature in the specification. Please see
the <a href="https://w3c.github.io/cid/implementations/1.0/">
implementation report</a> for more details.
      </p>

      <div class="issue atrisk" id="issue-container-number-1"><div role="heading" class="issue-title marker" id="h-issue" aria-level="3"><span>(Feature at Risk) Issue 1</span><span class="issue-label">: Features with less than two independent implementations</span></div><p class="atrisk">
Any feature with less than two independent implementations in the
<a href="https://w3c.github.io/cid/implementations/1.0/">
implementation report</a> is an "at risk" feature and might be
removed before the transition to <abbr title="World Wide Web Consortium">W3C</abbr> Proposed Recommendation.
      </p></div>
    <p>
    This document was published by the <a href="https://www.w3.org/groups/wg/vc">Verifiable Credentials Working Group</a> as
    a Candidate Recommendation Snapshot using the
        <a href="https://www.w3.org/policies/process/20231103/#recs-and-notes">Recommendation track</a>. 
  </p><p>Publication as a Candidate Recommendation does not
  imply endorsement by <abbr title="World Wide Web Consortium">W3C</abbr> and its Members. A Candidate Recommendation Snapshot has received
        <a href="https://www.w3.org/policies/process/20231103/#dfn-wide-review">wide review</a>, is intended to
        gather
        <a href="https://w3c.github.io/cid/implementations/1.0/">implementation experience</a>,
        and has commitments from Working Group members to
        <a href="https://www.w3.org/policies/patent-policy/#sec-Requirements">royalty-free licensing</a>
        for implementations.</p><p>
          This Candidate Recommendation is not expected to advance to Proposed
          Recommendation any earlier than 09 February 2025.
        </p><p>
    
        This document was produced by a group
        operating under the
        <a href="https://www.w3.org/policies/patent-policy/"><abbr title="World Wide Web Consortium">W3C</abbr> Patent
          Policy</a>.
      
    
                <abbr title="World Wide Web Consortium">W3C</abbr> maintains a
                <a rel="disclosure" href="https://www.w3.org/groups/wg/vc/ipr">public list of any patent disclosures</a>
          made in connection with the deliverables of
          the group; that page also includes
          instructions for disclosing a patent. An individual who has actual
          knowledge of a patent which the individual believes contains
          <a href="https://www.w3.org/policies/patent-policy/#def-essential">Essential Claim(s)</a>
          must disclose the information in accordance with
          <a href="https://www.w3.org/policies/patent-policy/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
        
  </p><p>
                      This document is governed by the
                      <a id="w3c_process_revision" href="https://www.w3.org/policies/process/20231103/">03 November 2023 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
                    </p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#use-cases"><bdi class="secno">1.1 </bdi>Use Cases</a></li><li class="tocline"><a class="tocxref" href="#requirements"><bdi class="secno">1.2 </bdi>Requirements</a></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">1.3 </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#terminology"><bdi class="secno">1.4 </bdi>Terminology</a></li></ol></li><li class="tocline"><a class="tocxref" href="#data-model"><bdi class="secno">2. </bdi>Data Model</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#controller-documents"><bdi class="secno">2.1 </bdi>Controller Documents</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#subjects"><bdi class="secno">2.1.1 </bdi>Subjects</a></li><li class="tocline"><a class="tocxref" href="#controllers"><bdi class="secno">2.1.2 </bdi>Controllers</a></li><li class="tocline"><a class="tocxref" href="#also-known-as"><bdi class="secno">2.1.3 </bdi>Also Known As</a></li><li class="tocline"><a class="tocxref" href="#services"><bdi class="secno">2.1.4 </bdi>Services</a></li></ol></li><li class="tocline"><a class="tocxref" href="#verification-methods"><bdi class="secno">2.2 </bdi>Verification Methods</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#verification-material"><bdi class="secno">2.2.1 </bdi>Verification Material</a></li><li class="tocline"><a class="tocxref" href="#Multikey"><bdi class="secno">2.2.2 </bdi>Multikey</a></li><li class="tocline"><a class="tocxref" href="#JsonWebKey"><bdi class="secno">2.2.3 </bdi>JsonWebKey</a></li><li class="tocline"><a class="tocxref" href="#referring-to-verification-methods"><bdi class="secno">2.2.4 </bdi>Referring to Verification Methods</a></li></ol></li><li class="tocline"><a class="tocxref" href="#verification-relationships"><bdi class="secno">2.3 </bdi>Verification Relationships</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#authentication"><bdi class="secno">2.3.1 </bdi>Authentication</a></li><li class="tocline"><a class="tocxref" href="#assertion"><bdi class="secno">2.3.2 </bdi>Assertion</a></li><li class="tocline"><a class="tocxref" href="#key-agreement"><bdi class="secno">2.3.3 </bdi>Key Agreement</a></li><li class="tocline"><a class="tocxref" href="#capability-invocation"><bdi class="secno">2.3.4 </bdi>Capability Invocation</a></li><li class="tocline"><a class="tocxref" href="#capability-delegation"><bdi class="secno">2.3.5 </bdi>Capability Delegation</a></li></ol></li><li class="tocline"><a class="tocxref" href="#multibase-0"><bdi class="secno">2.4 </bdi>Multibase</a></li><li class="tocline"><a class="tocxref" href="#multihash"><bdi class="secno">2.5 </bdi>Multihash</a></li></ol></li><li class="tocline"><a class="tocxref" href="#algorithms"><bdi class="secno">3. </bdi>Algorithms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#base-encode"><bdi class="secno">3.1 </bdi>Base Encode</a></li><li class="tocline"><a class="tocxref" href="#base-decode"><bdi class="secno">3.2 </bdi>Base Decode</a></li><li class="tocline"><a class="tocxref" href="#retrieve-verification-method"><bdi class="secno">3.3 </bdi>Retrieve Verification Method</a></li><li class="tocline"><a class="tocxref" href="#processing-errors"><bdi class="secno">3.4 </bdi>Processing Errors</a></li></ol></li><li class="tocline"><a class="tocxref" href="#contexts-and-vocabularies"><bdi class="secno">4. </bdi>Contexts and Vocabularies</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#vocabulary"><bdi class="secno">4.1 </bdi>Vocabulary</a></li><li class="tocline"><a class="tocxref" href="#json-ld-context"><bdi class="secno">4.2 </bdi>JSON-LD context</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#context-injection"><bdi class="secno">4.2.1 </bdi>Context Injection</a></li></ol></li><li class="tocline"><a class="tocxref" href="#datatypes"><bdi class="secno">4.3 </bdi>Datatypes</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#multibase"><bdi class="secno">4.3.1 </bdi>The <code>multibase</code> Datatype</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#security-considerations"><bdi class="secno">5. </bdi>Security Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#proving-control-and-binding"><bdi class="secno">5.1 </bdi>Proving Control and Binding</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#proving-control-of-an-identifier-and-or-controller-document"><bdi class="secno">5.1.1 </bdi>Proving Control of an Identifier and/or Controller Document</a></li><li class="tocline"><a class="tocxref" href="#binding-to-physical-identity"><bdi class="secno">5.1.2 </bdi>Binding to Physical Identity</a></li></ol></li><li class="tocline"><a class="tocxref" href="#identifier-ambiguity"><bdi class="secno">5.2 </bdi>Identifier Ambiguity</a></li><li class="tocline"><a class="tocxref" href="#key-and-signature-expiration"><bdi class="secno">5.3 </bdi>Key and Signature Expiration</a></li><li class="tocline"><a class="tocxref" href="#verification-method-rotation"><bdi class="secno">5.4 </bdi>Verification Method Rotation</a></li><li class="tocline"><a class="tocxref" href="#verification-method-revocation"><bdi class="secno">5.5 </bdi>Verification Method Revocation</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#revocation-semantics"><bdi class="secno">5.5.1 </bdi>Revocation Semantics</a></li></ol></li><li class="tocline"><a class="tocxref" href="#choosing-a-multiformat"><bdi class="secno">5.6 </bdi>Choosing a Multiformat</a></li><li class="tocline"><a class="tocxref" href="#encrypted-data-in-controller-documents"><bdi class="secno">5.7 </bdi>Encrypted Data in Controller Documents</a></li><li class="tocline"><a class="tocxref" href="#content-integrity-protection"><bdi class="secno">5.8 </bdi>Content Integrity Protection</a></li><li class="tocline"><a class="tocxref" href="#integrity-protection-of-controllers"><bdi class="secno">5.9 </bdi>Integrity Protection of Controllers</a></li><li class="tocline"><a class="tocxref" href="#level-of-assurance"><bdi class="secno">5.10 </bdi>Level of Assurance</a></li><li class="tocline"><a class="tocxref" href="#service-endpoints-for-authentication-and-authorization"><bdi class="secno">5.11 </bdi>Service Endpoints for Authentication and Authorization</a></li></ol></li><li class="tocline"><a class="tocxref" href="#privacy-considerations"><bdi class="secno">6. </bdi>Privacy Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#keep-personal-data-private"><bdi class="secno">6.1 </bdi>Keep Personal Data Private</a></li><li class="tocline"><a class="tocxref" href="#relationship-to-the-same-origin-policy"><bdi class="secno">6.2 </bdi>Relationship to the Same-Origin Policy</a></li><li class="tocline"><a class="tocxref" href="#identifier-correlation-risks"><bdi class="secno">6.3 </bdi>Identifier Correlation Risks</a></li><li class="tocline"><a class="tocxref" href="#controller-document-correlation-risks"><bdi class="secno">6.4 </bdi>Controller Document Correlation Risks</a></li><li class="tocline"><a class="tocxref" href="#subject-classification"><bdi class="secno">6.5 </bdi>Subject Classification</a></li><li class="tocline"><a class="tocxref" href="#service-privacy"><bdi class="secno">6.6 </bdi>Service Privacy</a></li></ol></li><li class="tocline"><a class="tocxref" href="#accessibility-considerations"><bdi class="secno">7. </bdi>Accessibility Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#presenting-time-values"><bdi class="secno">7.1 </bdi>Presenting Time Values</a></li></ol></li><li class="tocline"><a class="tocxref" href="#iana-considerations"><bdi class="secno">A. </bdi>IANA Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#controller-media-type"><bdi class="secno">A.1 </bdi>application/cid</a></li></ol></li><li class="tocline"><a class="tocxref" href="#examples"><bdi class="secno">B. </bdi>Examples</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#multikey-examples"><bdi class="secno">B.1 </bdi>Multikey Examples</a></li><li class="tocline"><a class="tocxref" href="#jsonwebkey-examples"><bdi class="secno">B.2 </bdi>JsonWebKey Examples</a></li></ol></li><li class="tocline"><a class="tocxref" href="#revision-history"><bdi class="secno">C. </bdi>Revision History</a></li><li class="tocline"><a class="tocxref" href="#acknowledgements"><bdi class="secno">D. </bdi>Acknowledgements</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">E. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">E.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">E.2 </bdi>Informative references</a></li></ol></li></ol></nav>

    <section class="informative" id="introduction"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div><p><em>This section is non-normative.</em></p>
      

      <p>
<a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-1">Controlled identifier documents</a> identify a <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-1">subject</a> and provide <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-1">verification methods</a> that express public cryptographic material, such as <a data-link-type="dfn|abstract-op" href="#dfn-public-key" class="internalDFN" id="ref-for-dfn-public-key-1">public keys</a>,
for verifying <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-1">proofs</a> created on behalf of the <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-2">subject</a> for specific
purposes, such as authentication, attestation, key agreement (for encryption),
and capability invocation and delegation. <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-2">Controlled identifier documents</a> also list
<a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-1">service</a> endpoints related to an <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-1">identifier</a>; for example, from which to
request additional information for verification.
      </p>

      <p>
In other words, the controlled identifier document contains the information necessary to
communicate with, and/or prove that specific actions were taken by, the
controller of an <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-2">identifier</a>, including material for <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-2">proofs</a> and
<a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-2">service</a> endpoints for additional communications.
      </p>
      <p>
A <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-3">controlled identifier document</a> specifies
<a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-1">verification relationships</a> and <a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-3">service</a> endpoints for a single
identifier, for which the current controlled identifier document is taken as authoritative.
      </p>
      <p>
It is expected that other specifications will profile
the features that are defined in this specification, requiring and/or
recommending the use of some and prohibiting and/or deprecating the use of
others.
      </p>

      <div class="issue" id="issue-container-number-2"><div role="heading" class="issue-title marker" id="h-issue-0" aria-level="3"><span>Issue 2</span><span class="issue-label">: Clarify that profiles of this document will happen</span></div><p class="">
The <abbr title="World Wide Web Consortium">W3C</abbr> TAG review noted that they would like to see language that clarifies
that this document would be useful to authors that would like to profile its
usage. The DID Core specification is one such document that does that, but
citing it directly received objections. This issue notes that the WG intends to
resolve the text below into something that we can achieve consensus on:<br><br>
<em>For example, the Decentralized Identifiers Specification is expected to
define DID documents as a profile of controlled identifier documents, where the DID is the
identifier, DID documents are controlled identifier documents, and resolution is the
process of retrieving the canonical DID document for a DID.</em>
      </p></div>

      <section id="use-cases"><div class="header-wrapper"><h3 id="x1-1-use-cases"><bdi class="secno">1.1 </bdi>Use Cases</h3><a class="self-link" href="#use-cases" aria-label="Permalink for Section 1.1"></a></div>
        
        <p>
The use cases below illustrate the need for this specification.
While many other related use cases exist, such as those in <cite><a data-matched-text="[[[DID-USE-CASES]]]" href="https://www.w3.org/TR/did-use-cases/">Use Cases and Requirements for Decentralized Identifiers</a></cite>
and <cite><a data-matched-text="[[[VC-USE-CASES]]]" href="https://www.w3.org/TR/vc-use-cases/">Verifiable Credentials Use Cases</a></cite>, those described below are the main scenarios that this
specification is designed to address.
        </p>

        <section class="notoc"><div class="header-wrapper"><h4 id="globally-unique-identifiers">Globally Unique Identifiers</h4><a class="self-link" href="#globally-unique-identifiers" aria-label="Permalink for this Section"></a></div>
          

          <p>
Lemmy runs multiple enterprise portals that manage large amounts of sensitive
data submitted by people working for a variety of organizations. He would like
to use identifiers for entities in the databases that are provided by
his customers and do not depend on easily phishable information such as
email addresses and passwords.
          </p>
        </section>

        <section class="notoc"><div class="header-wrapper"><h4 id="cryptographic-verification">Cryptographic Verification</h4><a class="self-link" href="#cryptographic-verification" aria-label="Permalink for this Section"></a></div>
          

          <p>
Lemmy would like to ensure that his customers prove control over their
identifiers — for example, by using public/private key cryptography
— in order to increase security related to who is allowed to access and
update each organization's data.
          </p>
        </section>

        <section class="notoc"><div class="header-wrapper"><h4 id="cryptographic-purpose">Cryptographic Purpose</h4><a class="self-link" href="#cryptographic-purpose" aria-label="Permalink for this Section"></a></div>
          

          <p>
Stef, who operates a high security service, would like to ensure that certain
cryptographic keys used by his customers can only be used for specific purposes
(such as encryption, authorization, and/or authentication) to enable different
levels of access and protection for each type of cryptographic key.
          </p>
        </section>

        <section class="notoc"><div class="header-wrapper"><h4 id="service-engagement">Service Engagement</h4><a class="self-link" href="#service-engagement" aria-label="Permalink for this Section"></a></div>
          

          <p>
Marge, a software developer, would like to publicly advertise ways in which
other people on the Web can reach her through various communication services she
uses based on her globally unique identifier(s).
          </p>
        </section>

        <section class="notoc"><div class="header-wrapper"><h4 id="extensibility">Extensibility</h4><a class="self-link" href="#extensibility" aria-label="Permalink for this Section"></a></div>
          

          <p>
Cory, a systems architect, would like to extend the use cases described in this
section in a way that provides new functionality without creating conflicts
with extensions being added by others.
          </p>
        </section>

        <section class="notoc"><div class="header-wrapper"><h4 id="issue-and-present-claims">Issue and Present Claims</h4><a class="self-link" href="#issue-and-present-claims" aria-label="Permalink for this Section"></a></div>
          

          <p>
Neru would like to issue digital credentials on behalf of her company that
contain claims about their employees. The claims that are made need to use
identifiers that are cryptographically attributable back to Neru's company and
need to allow for the holder's of those credentials to be able to
cryptographically authenticate themselves when they present the credential.
          </p>
        </section>

      </section>

      <section id="requirements"><div class="header-wrapper"><h3 id="x1-2-requirements"><bdi class="secno">1.2 </bdi>Requirements</h3><a class="self-link" href="#requirements" aria-label="Permalink for Section 1.2"></a></div>
        

        <p>
The following requirements are derived from the use cases described earlier in
this specification. Additional requirements which could lead to a more
decentralized solution can be found in <cite><a data-matched-text="[[[DID-USE-CASES]]]" href="https://www.w3.org/TR/did-use-cases/">Use Cases and Requirements for Decentralized Identifiers</a></cite>.
        </p>

        <dl>
          <dt>1. Guaranteed Unique Identifier</dt>
          <dd>
Identifiers are globally unique with no possibility of duplication.
          </dd>
          <dt>2. Proof of Control</dt>
          <dd>
It is possible to prove that the entity claiming control over the identifier is
indeed its controller.
          </dd>
          <dt>3. Associated cryptographic material</dt>
          <dd>
The identifier is tightly coupled with cryptographic material that an entity
can use to prove control over that identifier.
          </dd>
          <dt>4. Streamlined key rotation</dt>
          <dd>
Entities denoted by designated identifiers can update authentication materials
without direct intervention by requesting parties and with minimal individual
interaction.
          </dd>
          <dt>5. Service endpoint discovery</dt>
          <dd>
These identifiers allow requesting parties to look up available service
endpoints for interacting with the subject of the identifier.
          </dd>
          <dt>6. Delegation of control</dt>
          <dd>
The controller of the identifier is able to delegate that control, in full
and/or in part, to a third party.
          </dd>
          <dt>7. Cryptographically future-proof</dt>
          <dd>
These identifiers and associated information are capable of being updated
as technology evolves. Current cryptographic techniques are known to be
susceptible to quantum computational attacks. Future-proofed identifiers
provide a means by which to continue using the same identifier with updated,
advanced authentication and/or authorization technologies.
          </dd>
          <dt>8. Cryptographic authentication and communication</dt>
          <dd>
These identifiers enable the use of cryptographic techniques that can be employed
to authenticate individuals and/or to secure communications with the subject of
the identifier, typically using public-private key pairs.
          </dd>
          <dt>9. Legally recognizable identification</dt>
          <dd>
These identifiers can be used as a basis for credentials and transactions that
can be recognized as legally valid under one or more jurisdictions.
          </dd>
          <dt>10. Human-centered interoperability</dt>
          <dd>
Decentralized identifiers need to be easy to use by people with no technical
expertise or specialist knowledge.
          </dd>
        </dl>

      </section>

      <section id="conformance"><div class="header-wrapper"><h3 id="x1-3-conformance"><bdi class="secno">1.3 </bdi>Conformance</h3><a class="self-link" href="#conformance" aria-label="Permalink for Section 1.3"></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key words <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class="rfc2119">MUST NOT</em>, <em class="rfc2119">OPTIONAL</em>, <em class="rfc2119">RECOMMENDED</em>, <em class="rfc2119">REQUIRED</em>, and <em class="rfc2119">SHOULD</em> in this document
        are to be interpreted as described in
        <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all capitals, as shown here.
      </p>
        <p>
A <dfn id="dfn-conforming-controlled-identifier-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">conforming controlled identifier document</dfn> is any concrete expression of the
data model that follows the relevant normative requirements in Sections
<a href="#data-model" data-matched-text="[[[#data-model]]]" class="sec-ref"><bdi class="secno">2. </bdi>Data Model</a> and <a href="#contexts-and-vocabularies" data-matched-text="[[[#contexts-and-vocabularies]]]" class="sec-ref"><bdi class="secno">4. </bdi>Contexts and Vocabularies</a>.
        </p>

        <p>
A <dfn id="dfn-conforming-verification-method" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">conforming verification method</dfn> is any concrete expression of the
data model that follows the relevant normative requirements in Sections
<a href="#verification-methods" data-matched-text="[[[#verification-methods]]]" class="sec-ref"><bdi class="secno">2.2 </bdi>Verification Methods</a> and
<a href="#contexts-and-vocabularies" data-matched-text="[[[#contexts-and-vocabularies]]]" class="sec-ref"><bdi class="secno">4. </bdi>Contexts and Vocabularies</a>.
        </p>

        <p>
A <dfn class="lint-ignore" data-plurals="conforming documents" id="dfn-conforming-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">conforming document</dfn> is either a
<a data-link-type="dfn|abstract-op" href="#dfn-conforming-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-conforming-controlled-identifier-document-1">conforming controlled identifier document</a>, or a
<a data-link-type="dfn|abstract-op" href="#dfn-conforming-verification-method" class="internalDFN" id="ref-for-dfn-conforming-verification-method-1">conforming verification method</a>.
        </p>

        <p>
A <dfn class="lint-ignore" data-plurals="conforming processors" id="dfn-conforming-processor" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">conforming processor</dfn> is any algorithm realized
as software and/or hardware that generates and/or consumes a
<a data-link-type="dfn|abstract-op" href="#dfn-conforming-document" class="internalDFN" id="ref-for-dfn-conforming-document-1">conforming document</a> according to the relevant normative statements in
Section <a href="#algorithms" data-matched-text="[[[#algorithms]]]" class="sec-ref"><bdi class="secno">3. </bdi>Algorithms</a>. Conforming processors <em class="rfc2119">MUST</em> produce errors
when non-conforming documents are consumed.
        </p>

      </section>

      <section id="terminology"><div class="header-wrapper"><h3 id="x1-4-terminology"><bdi class="secno">1.4 </bdi>Terminology</h3><a class="self-link" href="#terminology" aria-label="Permalink for Section 1.4"></a></div>
        

        <p>
This section defines the terms used in this specification. A link to the relevant
definition is included whenever one of these terms appears in this specification.
        </p>

        <dl class="termlist definitions" data-sort="ascending"><dt><dfn data-lt="authenticated|authenticate|authentication" id="dfn-authenticated" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">authentication</dfn></dt>
          <dd data-defines="#dfn-authenticated">
A process by which an entity can prove to a verifier that it has a specific
attribute or controls a specific secret.
          </dd>

          <dt><dfn data-lt="authorized|authorize|authorization" id="dfn-authorized" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">authorization</dfn></dt>
          <dd data-defines="#dfn-authorized">
A process by which an entity can prove to a verifier that it is allowed to
perform a specific activity.
          </dd>

          <dt><dfn class="export" data-export="" id="dfn-controlled-identifier" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">controlled identifier</dfn></dt>
          <dd data-defines="#dfn-controlled-identifier">
            <p>
A type of identifier that can be proven to be under the control of an entity.
            </p>
          </dd>

          <dt><dfn class="export" data-export="" data-plurals="controlled identifier documents" id="dfn-controlled-identifier-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">controlled identifier document</dfn></dt>
          <dd data-defines="#dfn-controlled-identifier-document">
            <p>
A document that contains cryptographic material and lists service endpoints that
can be used for verifying <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-3">proofs</a> from, and interacting with, the
<a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-1">controller</a> of an identifier.
            </p>
          </dd>

          <dt><dfn class="export" data-lt="controller(s)|Controllers|controller" data-export="" data-plurals="controllers" id="dfn-controller-s" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">controller</dfn></dt>
          <dd data-defines="#dfn-controller-s">
            <p>
An entity that is capable of performing an action with a specific resource, such
as updating a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-4">controlled identifier document</a> or generating a <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-4">proof</a> using a
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-2">verification method</a>.
            </p>
          </dd>

          <dt><dfn class="export" data-lt="cryptosuite|cryptographic suite" data-export="" id="dfn-cryptosuite" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">cryptographic suite</dfn></dt>
          <dd data-defines="#dfn-cryptosuite">
A means of using specific cryptographic primitives
to achieve a particular security goal. These suites can
specify <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-3">verification methods</a>, digital signature types,
their identifiers, and other related properties.

          </dd>

          <dt><dfn id="dfn-private-key" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">private key</dfn></dt>
          <dd data-defines="#dfn-private-key">
Cryptographic material that can be used to generate <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-5">proofs</a>.
          </dd>

          <dt><dfn data-plurals="proofs" id="dfn-proof" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">proof</dfn></dt>
          <dd data-defines="#dfn-proof">
A mathematical demonstration that confirms the validity of an assertion. The
demonstration consists of a set of properties and values that enable a verifier
to cryptographically validate the assertion. A
<a href="https://en.wikipedia.org/wiki/Digital_signature">digital signature</a>
is a type of proof.
          </dd>

          <dt><dfn data-plurals="public keys" id="dfn-public-key" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">public key</dfn></dt>
          <dd data-defines="#dfn-public-key">
Cryptographic material that can be used to verify <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-6">proofs</a> created with a
corresponding <a data-link-type="dfn|abstract-op" href="#dfn-private-key" class="internalDFN" id="ref-for-dfn-private-key-1">private key</a>.
          </dd>

          <dt><dfn data-lt="subjects|subject" id="dfn-subjects" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">subject</dfn></dt>
          <dd data-defines="#dfn-subjects">
            <p>
An entity, such as a person, group, organization, physical thing, digital thing,
or logical thing that is referred to by the value of an <code>id</code> property in a
<a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-5">controlled identifier document</a>. Subjects identified in a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-6">controlled identifier document</a>
are also used as a subjects in other contexts, such as during
<a data-link-type="dfn|abstract-op" href="#dfn-authenticated" class="internalDFN" id="ref-for-dfn-authenticated-1">authentication</a> or in <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credentials</a>.
            </p>
          </dd>

          <dt><dfn class="export" data-export="" data-plurals="verification methods" id="dfn-verification-method" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verification method</dfn></dt>
          <dd data-defines="#dfn-verification-method">
            <p>
A method and its parameters, used to independently verify a <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-7">proof</a>. For
example, a cryptographic public key can be used as a verification method with
respect to a digital signature; in such use, it verifies that the signer
used the associated cryptographic private key.
            </p>
          </dd>

          <dt><dfn class="export" data-export="" data-plurals="verification relationships" id="dfn-verification-relationship" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verification relationship</dfn></dt>
          <dd data-defines="#dfn-verification-relationship">
            <p>
An expression that one or more <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-4">verification methods</a> are authorized to verify
proofs made on behalf of the <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-3">subject</a>. One example of a verification
relationship is <a href="#authentication" data-matched-text="[[[#authentication]]]" class="sec-ref"><bdi class="secno">2.3.1 </bdi>Authentication</a>.
            </p>
          </dd></dl>

      </section>
    </section>

      <section id="data-model"><div class="header-wrapper"><h2 id="x2-data-model"><bdi class="secno">2. </bdi>Data Model</h2><a class="self-link" href="#data-model" aria-label="Permalink for Section 2."></a></div>
        

        <p>
A <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-7">controlled identifier document</a> specifies one or more relationships between
an <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-3">identifier</a> and a set of <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-5">verification methods</a> and/or service
endpoints. The <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-8">controlled identifier document</a> <em class="rfc2119">SHOULD</em>
contain <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-2">verification relationships</a> that explicitly permit the use of
certain <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-6">verification methods</a> for specific purposes.
        </p>

        <div class="example" id="example-controller-document-using-publickeyjwk">
        <div class="marker">
    <a class="self-link" href="#example-controller-document-using-publickeyjwk">Example<bdi> 1</bdi></a><span class="example-title">: Controller Document using publicKeyJwk</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://controller.example/101"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"verificationMethod"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://controller.example/101#key-20240828"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"JsonWebKey"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"controller"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://controller.example/101"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"publicKeyJwk"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"kid"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"key-20240828"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"kty"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"EC"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"crv"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"P-256"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"alg"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ES256"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"x"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"f83OJ3D2xF1Bg8vub9tLe1gHMzV76e8Tus9uPHvRVEU"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"y"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"x_FEzRu9m36HLN_tue659LNpXW6pCyStikYjKIWI5a0"</span>
    <span class="hljs-punctuation">}</span>

  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"authentication"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"#key-20240828"</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

        <div class="example" id="example-controller-document-using-publickeymultibase-and-json-ld">
        <div class="marker">
    <a class="self-link" href="#example-controller-document-using-publickeymultibase-and-json-ld">Example<bdi> 2</bdi></a><span class="example-title">: Controller Document using publicKeyMultibase and JSON-LD</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"@context"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://www.w3.org/ns/cid/v1"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://controller.example"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"authentication"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://controller.example#authn-key-123"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Multikey"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"controller"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://controller.example"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"publicKeyMultibase"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

        <div class="note" role="note" id="issue-container-generatedID"><div role="heading" class="note-title marker" id="h-note" aria-level="3"><span>Note</span><span class="issue-label">: Property names used in map of different types</span></div><p class="">
The property names <code>id</code>, <code>type</code>, and <code>controller</code> can be present in map of
different types with possible differences in constraints.
        </p></div>

        <section id="controller-documents"><div class="header-wrapper"><h3 id="x2-1-controller-documents"><bdi class="secno">2.1 </bdi>Controller Documents</h3><a class="self-link" href="#controller-documents" aria-label="Permalink for Section 2.1"></a></div>
          

          <p>
The following sections define the properties in a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-9">controlled identifier document</a>,
including whether these properties are required or optional. These properties
describe relationships between the <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-4">subject</a> and the value of the
property.
          </p>

          <p>
The following tables contain informative references for the core properties
defined by this specification, with expected values, and whether or not they are
required. The property names in the tables are linked to the normative
definitions and more detailed descriptions of each property.
          </p>

          <table class="simple">
            <thead>
              <tr>
                <th>Property</th>
                <th>Required?</th>
                <th>Value constraints</th>
                <th style="white-space: nowrap;">Definition</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>id</code></td>
                <td>yes</td>
                <td>
A <a href="https://infra.spec.whatwg.org/#string">string</a> that conforms to the URL syntax.
                </td>
                <td style="white-space: nowrap;"><a href="#subjects" data-matched-text="[[[#subjects]]]" class="sec-ref"><bdi class="secno">2.1.1 </bdi>Subjects</a></td>
              </tr>
              <tr>
                <td><code>controller</code></td>
                <td>no</td>
                <td>
A <a href="https://infra.spec.whatwg.org/#string">string</a> or a
<a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of
<a href="https://infra.spec.whatwg.org/#string">strings</a>, each of which conforms to the URL
syntax.
                </td>
                <td style="white-space: nowrap;"><a href="#controllers" data-matched-text="[[[#controllers]]]" class="sec-ref"><bdi class="secno">2.1.2 </bdi>Controllers</a></td>
              </tr>
              <tr>
                <td><code>alsoKnownAs</code></td>
                <td>no</td>
                <td>
A <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of
<a href="https://infra.spec.whatwg.org/#string">strings</a>, each of which conforms to the URL
syntax.
                </td>
                <td style="white-space: nowrap;"><a href="#also-known-as" data-matched-text="[[[#also-known-as]]]" class="sec-ref"><bdi class="secno">2.1.3 </bdi>Also Known As</a></td>
              </tr>
              <tr>
                <td><code>service</code></td>
                <td>no</td>
                <td>
A <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of <a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-4">service</a>
<a href="https://infra.spec.whatwg.org/#ordered-map">maps</a>.
                </td>
                <td style="white-space: nowrap;"><a href="#services" data-matched-text="[[[#services]]]" class="sec-ref"><bdi class="secno">2.1.4 </bdi>Services</a></td>
              </tr>
              <tr>
                <td><code>verificationMethod</code></td>
                <td>no</td>
                <td>
A <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-7">verification method</a> <a href="https://infra.spec.whatwg.org/#ordered-map">maps</a>.
                </td>
                <td style="white-space: nowrap;"><a href="#verification-methods" data-matched-text="[[[#verification-methods]]]" class="sec-ref"><bdi class="secno">2.2 </bdi>Verification Methods</a></td>
              </tr>
              <tr>
                <td><code>authentication</code></td>
                <td>no</td>
                <td>
A <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of <a href="https://infra.spec.whatwg.org/#string">strings</a>, each of which conforms to
the URL syntax, or a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-8">verification method</a> <a href="https://infra.spec.whatwg.org/#ordered-map">maps</a>.
                </td>
                <td style="white-space: nowrap;"><a href="#authentication" data-matched-text="[[[#authentication]]]" class="sec-ref"><bdi class="secno">2.3.1 </bdi>Authentication</a></td>
              </tr>
              <tr>
                <td><code>assertionMethod</code></td>
                <td>no</td>
                <td>
A <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of <a href="https://infra.spec.whatwg.org/#string">strings</a>, each of which conforms to
the URL syntax, or a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-9">verification method</a> <a href="https://infra.spec.whatwg.org/#ordered-map">maps</a>.
                </td>
                <td style="white-space: nowrap;"><a href="#assertion" data-matched-text="[[[#assertion]]]" class="sec-ref"><bdi class="secno">2.3.2 </bdi>Assertion</a></td>
              </tr>
              <tr>
                <td><code>keyAgreement</code></td>
                <td>no</td>
                <td>
A <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of <a href="https://infra.spec.whatwg.org/#string">strings</a>, each of which conforms to
the URL syntax, or a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-10">verification method</a> <a href="https://infra.spec.whatwg.org/#ordered-map">maps</a>.
                </td>
                <td style="white-space: nowrap;"><a href="#key-agreement" data-matched-text="[[[#key-agreement]]]" class="sec-ref"><bdi class="secno">2.3.3 </bdi>Key Agreement</a></td>
              </tr>
              <tr>
                <td><code>capabilityInvocation</code></td>
                <td>no</td>
                <td>
A <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of <a href="https://infra.spec.whatwg.org/#string">strings</a>, each of which conforms to
the URL syntax, or a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-11">verification method</a> <a href="https://infra.spec.whatwg.org/#ordered-map">maps</a>.
                </td>
                <td style="white-space: nowrap;"><a href="#capability-invocation" data-matched-text="[[[#capability-invocation]]]" class="sec-ref"><bdi class="secno">2.3.4 </bdi>Capability Invocation</a></td>
              </tr>
              <tr>
                <td><code>capabilityDelegation</code></td>
                <td>no</td>
                <td>
A <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of <a href="https://infra.spec.whatwg.org/#string">strings</a>, each of which conforms to
the URL syntax, or a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-12">verification method</a> <a href="https://infra.spec.whatwg.org/#ordered-map">maps</a>.
                </td>
                <td style="white-space: nowrap;"><a href="#capability-delegation" data-matched-text="[[[#capability-delegation]]]" class="sec-ref"><bdi class="secno">2.3.5 </bdi>Capability Delegation</a></td>
              </tr>
            </tbody>
          </table>

          <section id="subjects"><div class="header-wrapper"><h4 id="x2-1-1-subjects"><bdi class="secno">2.1.1 </bdi>Subjects</h4><a class="self-link" href="#subjects" aria-label="Permalink for Section 2.1.1"></a></div>
            
            <p>
A <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-5">subject</a> is expressed using the <code>id</code> property in a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-10">controlled identifier document</a>.
The value of an <code>id</code> property is referred to as an <dfn data-plurals="identifiers" id="dfn-identifier" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">identifier</dfn>.
            </p>

            <dl>
              <dt>id</dt>
              <dd>
The value of <code>id</code> property <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#string">string</a> that
conforms to the rules in the <cite><a data-matched-text="[[[URL]]]" href="https://url.spec.whatwg.org/">URL Standard</a></cite>.
              </dd>
            </dl>

            <p>
A <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-11">controlled identifier document</a> <em class="rfc2119">MUST</em> contain an <code>id</code> value in the <em>topmost</em>
<a href="https://infra.spec.whatwg.org/#ordered-map">map</a>.
            </p>

            <div class="example" id="example-3">
        <div class="marker">
    <a class="self-link" href="#example-3">Example<bdi> 3</bdi></a>
  </div> <pre class="nohighlight">{
  "id": "https://controller.example/123"
}</pre>
      </div>

            <p>
The value of the <code>id</code> property in the <em>topmost</em>
<a href="https://infra.spec.whatwg.org/#ordered-map">map</a> of the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-12">controlled identifier document</a> is
called the <dfn id="dfn-base-identifier" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">base identifier</dfn> for the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-13">controlled identifier document</a>. The URL
for retrieving the current, authoritative <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-14">controlled identifier document</a> for a given
<a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-4">identifier</a> is called the <dfn id="dfn-canonical-url" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">canonical URL</dfn> for the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-15">controlled identifier document</a>. Dereferencing the <a data-link-type="dfn|abstract-op" href="#dfn-canonical-url" class="internalDFN" id="ref-for-dfn-canonical-url-1">canonical URL</a> <em class="rfc2119">MUST</em> return the current
authoritative <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-16">controlled identifier document</a>. The returned document's <a data-link-type="dfn|abstract-op" href="#dfn-base-identifier" class="internalDFN" id="ref-for-dfn-base-identifier-1">base identifier</a> <em class="rfc2119">MUST</em> be the same as the <a data-link-type="dfn|abstract-op" href="#dfn-canonical-url" class="internalDFN" id="ref-for-dfn-canonical-url-2">canonical URL</a>; if it is anything else,
then the returned document is not an authoritative <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-17">controlled identifier document</a> and
the <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-5">identifier</a> <em class="rfc2119">SHOULD</em> be treated as invalid. Every controlled identifier document is
stored and retrieved according to the <a data-link-type="dfn|abstract-op" href="#dfn-canonical-url" class="internalDFN" id="ref-for-dfn-canonical-url-3">canonical URL</a> of the document, which
<em class="rfc2119">MUST</em> also be the <a data-link-type="dfn|abstract-op" href="#dfn-base-identifier" class="internalDFN" id="ref-for-dfn-base-identifier-2">base identifier</a> of the document.
            </p>

            <div class="note" role="note" id="issue-container-generatedID-0"><div role="heading" class="note-title marker" id="h-note-0" aria-level="5"><span>Note</span><span class="issue-label">: Identifiers are context-dependent</span></div><div class="">
              <p>
It is expected that the <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-6">subject</a> referred to by an <code>id</code> in a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-18">controlled identifier document</a> will be consistent over time, such that any <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credentials</a> that use them can be interpreted as referring to the same entity.
For example, it is preferred that an <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> of a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>
require that a <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-7">subject</a> demonstrate <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-8">proof</a> of control over their
<a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-6">identifier</a> before issuing a credential with that <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-7">identifier</a> as
<a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-8">subject</a>, creating assurance that the same entity was involved in the
issuance of each credential with that <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-8">identifier</a> as <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-9">subject</a>.
              </p>
              <p>
However, there are valid cases where that practice is either impossible or
unreasonable; for example, when a parent requests a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>
for their child. There are also cases where an <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> simply makes a mistake
or intentionally issues a false statement. All of these possibilities are
considered when evaluating the security impacts of reliance on a given
<a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-9">identifier</a> for any given purpose. See Section <a href="#identifier-ambiguity" data-matched-text="[[[#identifier-ambiguity]]]" class="sec-ref"><bdi class="secno">5.2 </bdi>Identifier Ambiguity</a>.
              </p>
            </div></div>

          </section>

          <section id="controllers"><div class="header-wrapper"><h4 id="x2-1-2-controllers"><bdi class="secno">2.1.2 </bdi>Controllers</h4><a class="self-link" href="#controllers" aria-label="Permalink for Section 2.1.2"></a></div>
            

            <p>
A <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-2">controller</a> of a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-19">controlled identifier document</a> is any entity capable of making changes to that
<a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-20">controlled identifier document</a>. Whoever can update
the content of the resource returned from dereferencing the controller
document's canonical URL is, by definition, a controller of the
document and its canonical identifier. Proofs that satisfy a
<a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-21">controlled identifier document</a>'s <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-13">verification methods</a> are taken as cryptographic
assurance that the <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-3">controller</a> of the <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-10">identifier</a> created those <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-9">proofs</a>.
            </p>
            <div class="note" role="note" id="issue-container-generatedID-1"><div role="heading" class="note-title marker" id="h-note-1" aria-level="5"><span>Note</span><span class="issue-label">: Identifier Controller versus Document Controller</span></div><p class="">
The <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-4">controller</a> of the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-22">controlled identifier document</a> is taken to be the
<a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-5">controller</a> of the document's canonical <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-11">identifier</a>, also known as its
URL. That is, whoever can update the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-23">controlled identifier document</a> is both
the document <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-6">controller</a> and the <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-12">identifier</a> <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-7">controller</a>. Updating the
document is how you control the <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-13">identifier</a>. These terms can be used
interchangeably. Controlling the canonical <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-24">controlled identifier document</a> for
an <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-14">identifier</a> is the same as controlling the <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-15">identifier</a>.
            </p></div>
            <dl>
              <dt>controller</dt>
              <dd>
The <code>controller</code> property is <em class="rfc2119">OPTIONAL</em>. If it is possible to represent
the legitimate controllers of the document as URLs, the document <em class="rfc2119">SHOULD</em>
list URLs identifying those controllers.

  <div class="note" role="note" id="issue-container-generatedID-2"><div role="heading" class="note-title marker" id="h-note-2" aria-level="5"><span>Note</span><span class="issue-label">: Presumed Control</span></div><p class="">
It is possible to list a verification method which is
functionally under the control of someone other than the <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-8">controller</a>
of the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-25">controlled identifier document</a>. For example, a document <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-9">controller</a> could
set a public key under another party's control as an authentication
verification method. This would enable the other party to authenticate
on behalf of this <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-16">identifier</a> (because their public key is listed in
an authentication verification method) <em>without</em> enabling that party
to update the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-26">controlled identifier document</a>. However, since the document
<a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-10">controller</a> explicitly listed that key for authentication, the
proof in question is taken as created by the document <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-11">controller</a>, as
it was created by their explicit assignee. This is especially useful
when the "other party" is a device under the control of the document
controller, but with a distinct cryptographic authority, i.e., it
has its own keystore and can generate <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-10">proofs</a>. That pattern enables
different devices, each using their own cryptographic material, to
generate verifiable <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-11">proofs</a> that are taken as <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-12">proofs</a> created by
controller of the identifier.
  </p></div>
If present, its value <em class="rfc2119">MUST</em> be a
<a href="https://infra.spec.whatwg.org/#string">string</a> or a
<a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of
<a href="https://infra.spec.whatwg.org/#string">strings</a>,
each of which conforms to the rules in the <cite><a data-matched-text="[[[URL]]]" href="https://url.spec.whatwg.org/">URL Standard</a></cite>.
            <p></p>
            <p>
Each entry in the <code>controller</code> property <em class="rfc2119">MUST</em> identify
an entity capable of updating the canonical version
of the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-27">controlled identifier document</a>.
Subsequent requests for this <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-28">controlled identifier document</a> through its
canonical location will always receive the latest version.
            </p>
            <p>
If the <code>controller</code> property is not present, then control of the document
is determined entirely by its storage location.
              </p></dd>
            </dl>

            <div class="example" id="example-controlled-identifier-document-with-a-controller-property">
        <div class="marker">
    <a class="self-link" href="#example-controlled-identifier-document-with-a-controller-property">Example<bdi> 4</bdi></a><span class="example-title">: Controlled identifier document with a controller property</span>
  </div> <pre class="nohighlight">{
  "@context": "https://www.w3.org/ns/cid/v1",
  "id": "https://controller1.example/123",
  "controller": "https://controllerB.example/abc",
}</pre>
      </div>

            <p>
While the <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-17">identifier</a> used for a <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-12">controller</a> is unambiguous, this does not
imply that a single entity is always the <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-13">controller</a>, nor that a <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-14">controller</a>
only has a single identifier. A <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-15">controller</a> might be a single entity, or a
collection of entities, such as a partnership. A <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-16">controller</a> might also use
multiple identifiers to refer to itself, for purposes such as privacy or
delineating operational boundaries within an organization. Similarly, a
<a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-17">controller</a> might control many <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-14">verification methods</a>. For these reasons,
no assumptions are to be made about a <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-18">controller</a> being a single entity nor
controlling only a single <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-15">verification method</a>.
            </p>

            <div class="note" role="note" id="issue-container-generatedID-3"><div role="heading" class="note-title marker" id="h-note-3" aria-level="5"><span>Note</span><span class="issue-label">: Authentication versus Authorization</span></div><p class="">
Note that the definition of <a data-link-type="dfn|abstract-op" href="#dfn-authenticated" class="internalDFN" id="ref-for-dfn-authenticated-2">authentication</a> is different from the definition
of <a data-link-type="dfn|abstract-op" href="#dfn-authorized" class="internalDFN" id="ref-for-dfn-authorized-1">authorization</a>. Generally speaking, <a data-link-type="dfn|abstract-op" href="#dfn-authenticated" class="internalDFN" id="ref-for-dfn-authenticated-3">authentication</a> answers the
question of "Do we know who this is?" while <a data-link-type="dfn|abstract-op" href="#dfn-authorized" class="internalDFN" id="ref-for-dfn-authorized-2">authorization</a> answers the question of "Are
they allowed to perform this action?". The <code>authentication</code> property in this
specification is used to, unsurprisingly, perform <a data-link-type="dfn|abstract-op" href="#dfn-authenticated" class="internalDFN" id="ref-for-dfn-authenticated-4">authentication</a> while the
other <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-3">verification relationships</a> such as <code>capabilityDelegation</code> and
<code>capabilityInvocation</code> are used to perform <a data-link-type="dfn|abstract-op" href="#dfn-authorized" class="internalDFN" id="ref-for-dfn-authorized-3">authorization</a>. Since successfully
performing <a data-link-type="dfn|abstract-op" href="#dfn-authorized" class="internalDFN" id="ref-for-dfn-authorized-4">authorization</a> might have more serious effects on a system,
<a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-19">controllers</a> are urged to use different <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-16">verification methods</a> when
performing <a data-link-type="dfn|abstract-op" href="#dfn-authenticated" class="internalDFN" id="ref-for-dfn-authenticated-5">authentication</a> versus <a data-link-type="dfn|abstract-op" href="#dfn-authorized" class="internalDFN" id="ref-for-dfn-authorized-5">authorization</a> and provide stronger
access protection for <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-17">verification methods</a> used for <a data-link-type="dfn|abstract-op" href="#dfn-authorized" class="internalDFN" id="ref-for-dfn-authorized-6">authorization</a> versus
<a data-link-type="dfn|abstract-op" href="#dfn-authenticated" class="internalDFN" id="ref-for-dfn-authenticated-6">authentication</a>. See <a href="#security-considerations" data-matched-text="[[[#security-considerations]]]" class="sec-ref"><bdi class="secno">5. </bdi>Security Considerations</a> for information related
to threat models and attack vectors.
            </p></div>
          </section>

          <section id="also-known-as"><div class="header-wrapper"><h4 id="x2-1-3-also-known-as"><bdi class="secno">2.1.3 </bdi>Also Known As</h4><a class="self-link" href="#also-known-as" aria-label="Permalink for Section 2.1.3"></a></div>
            

            <p>
A <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-10">subject</a> can have multiple identifiers that are used for different purposes
or at different times. The assertion that two or more identifiers (or other types
of URI) refer to the same <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-11">subject</a> can be made using the
<code>alsoKnownAs</code> property.
            </p>

            <dl>
              <dt>alsoKnownAs</dt>
              <dd>
The <code>alsoKnownAs</code> property is <em class="rfc2119">OPTIONAL</em>. If present, its value <em class="rfc2119">MUST</em>
be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> where each item in the
set is a URI conforming to [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3986" title="Uniform Resource Identifier (URI): Generic Syntax">RFC3986</a></cite>].
              </dd>
              <dd>
This relationship is a statement that the subject of this identifier is
also identified by one or more other identifiers.
              </dd>
            </dl>

            <div class="note" role="note" id="issue-container-generatedID-4"><div role="heading" class="note-title marker" id="h-note-4" aria-level="5"><span>Note</span><span class="issue-label">: Equivalence and alsoKnownAs</span></div><div class="">
              <p>
Applications might choose to consider two identifiers related by <code>alsoKnownAs</code>
to be equivalent <em>if</em> the <code>alsoKnownAs</code> relationship expressed in the
controlled identifier document of one <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-12">subject</a> is also expressed in the reverse direction
(i.e., reciprocated) in the controlled identifier document of the other <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-13">subject</a>. It is
best practice <em>not</em> to consider them
equivalent in the absence of this reciprocating relationship. In other words,
the presence of an <code>alsoKnownAs</code> assertion does not prove that this assertion
is true. Therefore, it is strongly advised that a requesting party obtain
independent verification of an <code>alsoKnownAs</code> assertion.
              </p>
              <p>
Given that the <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-14">subject</a> might use different identifiers for different
purposes, such as enhanced privacy protection, an expectation of strong
equivalence between the two identifiers, or taking action to
merge the information from the two corresponding <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-29">controlled identifier documents</a>, is
not necessarily appropriate, <em>even with</em> a reciprocal relationship.
              </p>
            </div></div>

          </section>

          <section id="services"><div class="header-wrapper"><h4 id="x2-1-4-services"><bdi class="secno">2.1.4 </bdi>Services</h4><a class="self-link" href="#services" aria-label="Permalink for Section 2.1.4"></a></div>
            

            <p>
<a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-5">Services</a> are used in <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-30">controlled identifier documents</a> to express ways of
communicating with the <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-20">controller</a>, or associated entities, in relation to
the controlled <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-18">identifier</a>. A <a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-6">service</a> can be
any type of service the <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-21">controller</a> wants to advertise for further discovery,
authentication, authorization, or interaction.
            </p>

            <p>
Due to privacy concerns, revealing public information through <a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-7">services</a>, such
as social media accounts, personal websites, and email addresses, is
discouraged. Further exploration of privacy concerns can be found in sections
<a href="#keep-personal-data-private" data-matched-text="[[[#keep-personal-data-private]]]" class="sec-ref"><bdi class="secno">6.1 </bdi>Keep Personal Data Private</a> and <a href="#service-privacy" data-matched-text="[[[#service-privacy]]]" class="sec-ref"><bdi class="secno">6.6 </bdi>Service Privacy</a>. The information
associated with <a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-8">services</a> is often service specific. For example, the
information associated with an encrypted messaging service can express how to
initiate the encrypted link before messaging begins.
            </p>

            <p>
<a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-9">Services</a> are expressed using the <code>service</code> property, which is described
below:
            </p>

            <dl>
              <dt><dfn data-plurals="services" id="dfn-service" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">service</dfn></dt>
              <dd>
                <p>
The <code>service</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the associated value <em class="rfc2119">MUST</em> be a
<a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of <a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-10">services</a>, where each service is
described by a <a href="https://infra.spec.whatwg.org/#ordered-map">map</a>. Each <a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-11">service</a> <a href="https://infra.spec.whatwg.org/#ordered-map">map</a> <em class="rfc2119">MUST</em> contain <code>id</code>, <code>type</code>, and
<code>serviceEndpoint</code> properties. Each service extension <em class="rfc2119">MAY</em> include additional
properties and <em class="rfc2119">MAY</em> further restrict the properties associated with the
extension.
                </p>
                <dl>
                  <dt id="prop-service-id">id</dt>
                  <dd>
The <code>id</code> property is <em class="rfc2119">OPTIONAL</em>. If present, its value <em class="rfc2119">MUST</em> be a URL
conforming to <cite><a data-matched-text="[[[URL]]]" href="https://url.spec.whatwg.org/">URL Standard</a></cite>. A <a data-link-type="dfn|abstract-op" href="#dfn-conforming-document" class="internalDFN" id="ref-for-dfn-conforming-document-2">conforming document</a> <em class="rfc2119">MUST NOT</em> include multiple
<code>service</code> entries with the same <code>id</code>.
                  </dd>
                <dt id="prop-service-type">type</dt>
                <dd>
The <code>type</code> property is <em class="rfc2119">REQUIRED</em>. Its value <em class="rfc2119">MUST</em> be a
<a href="https://infra.spec.whatwg.org/#string">string</a> or a
<a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of
<a href="https://infra.spec.whatwg.org/#string">strings</a>. To maximize interoperability,
the <a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-12">service</a> type and its associated properties <em class="rfc2119">SHOULD</em> be registered in the
<cite><a data-matched-text="[[[?VC-EXTENSIONS]]]" href="https://www.w3.org/TR/vc-extensions/">Verifiable Credential Extensions</a></cite>.
                </dd>
                <dt id="prop-service-endpoint">serviceEndpoint</dt>
                <dd>
The <code>serviceEndpoint</code> property is <em class="rfc2119">REQUIRED</em>. The value of the <code>serviceEndpoint</code>
property <em class="rfc2119">MUST</em> be a single <a href="https://infra.spec.whatwg.org/#string">string</a>, a single
<a href="https://infra.spec.whatwg.org/#maps">map</a>, or a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a>
composed of one or more
<a href="https://infra.spec.whatwg.org/#string">strings</a> and/or
<a href="https://infra.spec.whatwg.org/#maps">maps</a>. Each <a href="https://infra.spec.whatwg.org/#string">string</a>
value <em class="rfc2119">MUST</em> be a valid URL conforming to <cite><a data-matched-text="[[[URL]]]" href="https://url.spec.whatwg.org/">URL Standard</a></cite>.
                </dd>
              </dl>
            </dd></dl>

            <p>
For more information regarding privacy and security considerations related to
<a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-13">services</a> see <a href="#service-privacy" data-matched-text="[[[#service-privacy]]]" class="sec-ref"><bdi class="secno">6.6 </bdi>Service Privacy</a>, <a href="#keep-personal-data-private" data-matched-text="[[[#keep-personal-data-private]]]" class="sec-ref"><bdi class="secno">6.1 </bdi>Keep Personal Data Private</a>,
<a href="#controller-document-correlation-risks" data-matched-text="[[[#controller-document-correlation-risks]]]" class="sec-ref"><bdi class="secno">6.4 </bdi>Controller Document Correlation Risks</a>, and
<a href="#service-endpoints-for-authentication-and-authorization" data-matched-text="[[[#service-endpoints-for-authentication-and-authorization]]]" class="sec-ref"><bdi class="secno">5.11 </bdi>Service Endpoints for Authentication and Authorization</a>.
      </p>

      <div class="example" id="example-usage-of-the-service-property">
        <div class="marker">
    <a class="self-link" href="#example-usage-of-the-service-property">Example<bdi> 5</bdi></a><span class="example-title">: Usage of the service property</span>
  </div> <pre class="nohighlight">{
  "service": [{
    "type": "ExampleSocialMediaService",
    "serviceEndpoint": "https://warbler.example/sal674"
  }]
}</pre>
      </div>

          </section>

        </section>

        <section id="verification-methods"><div class="header-wrapper"><h3 id="x2-2-verification-methods"><bdi class="secno">2.2 </bdi>Verification Methods</h3><a class="self-link" href="#verification-methods" aria-label="Permalink for Section 2.2"></a></div>
          
          <p>
A <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-31">controlled identifier document</a> can express <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-18">verification methods</a>, such as
cryptographic <a data-link-type="dfn|abstract-op" href="#dfn-public-key" class="internalDFN" id="ref-for-dfn-public-key-2">public keys</a>, which can be used to verify <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-13">proofs</a>,
such as those used to <a data-link-type="dfn|abstract-op" href="#dfn-authenticated" class="internalDFN" id="ref-for-dfn-authenticated-7">authenticate</a> or authorize interactions with the
<a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-22">controller</a> or associated parties. For example, a cryptographic <a data-link-type="dfn|abstract-op" href="#dfn-public-key" class="internalDFN" id="ref-for-dfn-public-key-3">public key</a> can be used as a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-19">verification method</a> with respect to a digital
signature; in such use, it verifies that the signer could use the associated
cryptographic private key. <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-20">Verification methods</a> might take many
parameters. An example of this is a set of five cryptographic keys from which
any three are required to contribute to a cryptographic threshold signature.
          </p>

          <p>
"Verification" and "proof" are intended to apply broadly. For example, a
cryptographic public key might be used during Diffie-Hellman key exchange to
negotiate a shared symmetric key for encryption. This guarantees the integrity
of the key agreement process. It is thus another type of verification method,
even though descriptions of the process might not use the words "verification"
or "proof."
          </p>

          <p>
A <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-21">verification method</a> is defined in a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-32">controlled identifier document</a> using the
<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> below and is referred to as the
<dfn id="dfn-verification-method-definition" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verification method definition</dfn>:
          </p>

          <dl>
            <dt><dfn class="lint-ignore" id="dfn-verificationmethod" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verificationMethod</dfn></dt>
            <dd>
              <p>
The <code>verificationMethod</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the value
<em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-22">verification
methods</a>, where each <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-23">verification method</a> is expressed using a <a href="https://infra.spec.whatwg.org/#ordered-map">map</a>. The <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-24">verification method</a> <a href="https://infra.spec.whatwg.org/#ordered-map">map</a> <em class="rfc2119">MUST</em> include the <code>id</code>,
<code>type</code>, <code>controller</code>, and specific verification material
properties that are determined by the value of <code>type</code> and are defined
in <a href="#verification-material" data-matched-text="[[[#verification-material]]]" class="sec-ref"><bdi class="secno">2.2.1 </bdi>Verification Material</a>. A <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-25">verification method</a> <em class="rfc2119">MAY</em>
include additional properties.

              </p>

              <dl>
                <dt>id</dt>
                <dd>
                  <p>
The value of the <code>id</code> property for a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-26">verification method</a> <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#string">string</a> that conforms to the [<cite><a class="bibref" data-link-type="biblio" href="#bib-url" title="URL Standard">URL</a></cite>] syntax. This
value is called the <dfn data-plurals="verification method identifiers" id="dfn-verification-method-identifier" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verification method identifier</dfn> and can also be
used in a <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-14">proof</a> to refer to a specific instance of a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-27">verification method</a>, which is called the <a data-link-type="dfn|abstract-op" href="#dfn-verification-method-definition" class="internalDFN" id="ref-for-dfn-verification-method-definition-1">verification method definition</a>.
                  </p>
                </dd>
                <dt>type</dt>
                <dd>
The value of the <code>type</code> property <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#string">string</a> that references exactly one <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-28">verification
method</a> type. This specification defines the types <code>JsonWebKey</code> (see Section
<a href="#JsonWebKey" data-matched-text="[[[#JsonWebKey]]]" class="sec-ref"><bdi class="secno">2.2.3 </bdi>JsonWebKey</a>) and <code>Multikey</code> (see Section <a href="#Multikey" data-matched-text="[[[#Multikey]]]" class="sec-ref"><bdi class="secno">2.2.2 </bdi>Multikey</a>).
                </dd>
                <dt><span id="defn-controller">controller</span></dt>
                <dd>
The value of the <code>controller</code> property <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#string">string</a> that conforms to the [<cite><a class="bibref" data-link-type="biblio" href="#bib-url" title="URL Standard">URL</a></cite>] syntax.
                </dd>

                <dt id="defn-vm-expires">expires</dt>
                <dd>
The <code>expires</code> property is <em class="rfc2119">OPTIONAL</em>.

If provided, it <em class="rfc2119">MUST</em> be an
[<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlschema11-2" title="W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes">XMLSCHEMA11-2</a></cite>] <code>dateTimeStamp</code> string specifying when the
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-29">verification method</a> <em class="rfc2119">SHOULD</em> cease to be used. Once the value is set, it is
not expected to be updated, and systems depending on the value are expected to
not verify any <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-15">proofs</a> associated with the <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-30">verification method</a> at or after
the time of expiration.
                </dd>
                <dt><dfn class="lint-ignore" id="dfn-revoked" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">revoked</dfn></dt>
                <dd>
The <code>revoked</code> property is <em class="rfc2119">OPTIONAL</em>.

If present, it <em class="rfc2119">MUST</em> be an [<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlschema11-2" title="W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes">XMLSCHEMA11-2</a></cite>]
<code>dateTimeStamp</code> string specifying when the <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-31">verification method</a>
<em class="rfc2119">MUST NOT</em> be used. Once the value is set, it is not expected to be
updated, and systems depending on the value are expected to not verify any
proofs associated with the <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-32">verification method</a> at or after the time of
revocation.
                </dd>
              </dl>
            </dd>
          </dl>

          <div class="example" id="example-example-verification-method-structure">
        <div class="marker">
    <a class="self-link" href="#example-example-verification-method-structure">Example<bdi> 6</bdi></a><span class="example-title">: Example verification method structure</span>
  </div> <pre class="nohighlight">{
  "@context": "https://www.w3.org/ns/cid/v1",
  "id": "https://controller.example/123456789abcdefghi",
  <span class="comment">...</span>
  "verificationMethod": [{
    "id": <span class="comment">...</span>,
    "type": <span class="comment">...</span>,
    "controller": <span class="comment">...</span>,
    "publicKeyJwk": <span class="comment">...</span>
  }, {
    "id": <span class="comment">...</span>,
    "type": <span class="comment">...</span>,
    "controller": <span class="comment">...</span>,
    "publicKeyMultibase": <span class="comment">...</span>
  }]
}</pre>
      </div>

          <div class="note" role="note" id="issue-container-generatedID-5"><div role="heading" class="note-title marker" id="h-note-5" aria-level="4"><span>Note</span><span class="issue-label">: The `controller` property is used by multiple objects</span></div><p class="">
The <code>controller</code> property is used by <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-33">controlled identifier documents</a>, as described in
Section <a href="#controller-documents" data-matched-text="[[[#controller-documents]]]" class="sec-ref"><bdi class="secno">2.1 </bdi>Controller Documents</a>, and by <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-33">verification methods</a>, as
described in Section <a href="#verification-methods" data-matched-text="[[[#verification-methods]]]" class="sec-ref"><bdi class="secno">2.2 </bdi>Verification Methods</a>. When it is used in either
place, its purpose is essentially the same; that is, it expresses one or more
entities that are authorized to perform certain actions associated with the
resource with which it is associated.
            </p></div>
            <p>
In the case of the <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-23">controller</a> of a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-34">controlled identifier document</a>, the
<a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-24">controller</a> can update the content of the document. In the case of the
<a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-25">controller</a> of a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-34">verification method</a>, the <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-26">controller</a> can generate
proofs that satisfy the method.
            </p>
            <p>
To ensure explicit security guarantees, the
<a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-27">controller</a> of a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-35">verification method</a> cannot be inferred from the
<a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-35">controlled identifier document</a>. It is necessary to explicitly express the identifier of
the controller of the key because the value of <code>controller</code> for a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-36">verification method</a> is <em>not</em> necessarily the value of the <code>controller</code> for a
<a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-36">controlled identifier document</a>.
          </p>

          <section id="verification-material"><div class="header-wrapper"><h4 id="x2-2-1-verification-material"><bdi class="secno">2.2.1 </bdi>Verification Material</h4><a class="self-link" href="#verification-material" aria-label="Permalink for Section 2.2.1"></a></div>
            

            <p>
Verification material is any information that is used by a process that applies
a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-37">verification method</a>. The <code>type</code> of a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-38">verification method</a> is
expected to be used to determine its compatibility with such processes. Examples
of verification methods include <code>JsonWebKey</code> and <code>Multikey</code>.
A <a data-link-type="dfn|abstract-op" href="#dfn-cryptosuite" class="internalDFN" id="ref-for-dfn-cryptosuite-1">cryptographic suite</a> specification is responsible for specifying the
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-39">verification method</a> <code>type</code> and its associated verification material
format. For examples using verification material, see
<a href="https://www.w3.org/TR/vc-jose-cose/">Securing Verifiable Credentials using JOSE and COSE</a>,
<a href="https://www.w3.org/TR/vc-di-ecdsa/">the Data Integrity ECDSA
Cryptosuites</a> and <a href="https://w3c-ccg.github.io/lds-ed25519-2020/">
the Data Integrity EdDSA Cryptosuites</a>.
            </p>

            <p>
To increase the likelihood of interoperable implementations, this specification
limits the number of formats for expressing verification material in a
<a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-37">controlled identifier document</a>. The fewer formats that implementers have to
choose from, the more likely that interoperability will be achieved. This
approach attempts to strike a delicate balance between easing implementation
and providing support for formats that have historically had broad deployment.
            </p>

            <p>
A <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-40">verification method</a> <em class="rfc2119">MUST NOT</em> contain multiple verification material
properties for the same material. For example, expressing key material in a
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-41">verification method</a> using both <code>publicKeyJwk</code> and
<code>publicKeyMultibase</code> at the same time is prohibited.
            </p>

            <p>
Implementations <em class="rfc2119">MAY</em> convert keys between formats as desired for operational purposes or
to interface with cryptographic libraries. As an internal implementation detail, such
conversion <em class="rfc2119">MUST NOT</em> affect the external representation of key material.
            </p>

            <p>
An example of a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-38">controlled identifier document</a> containing <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-42">verification
methods</a> using both properties above is shown below.
            </p>

            <div class="example" id="example-various-verification-method-types">
        <div class="marker">
    <a class="self-link" href="#example-various-verification-method-types">Example<bdi> 7</bdi></a><span class="example-title">: Verification methods using publicKeyJwk and publicKeyMultibase</span>
  </div> <pre class="nohighlight">{
  "@context": "https://www.w3.org/ns/cid/v1",
  "id": "https://controller.example/123456789abcdefghi",
  <span class="comment">...</span>
  "verificationMethod": [{
    "id": "https://controller.example/123#_Qq0UL2Fq651Q0Fjd6TvnYE-faHiOpRlPVQcY_-tA4A",
    "type": "JsonWebKey", <span class="comment">// external (property value)</span>
    "controller": "https://controller.example/123456789abcdefghi",
    "publicKeyJwk": {
      "crv": "Ed25519", <span class="comment">// external (property name)</span>
      "x": "VCpo2LMLhn6iWku8MKvSLg2ZAoC-nlOyPVQaO3FxVeQ", <span class="comment">// external (property name)</span>
      "kty": "OKP", <span class="comment">// external (property name)</span>
      "kid": "_Qq0UL2Fq651Q0Fjd6TvnYE-faHiOpRlPVQcY_-tA4A" <span class="comment">// external (property name)</span>
    }
  }, {
    "id": "https://controller.example/123456789abcdefghi#keys-1",
    "type": "Multikey", <span class="comment">// external (property value)</span>
    "controller": "https://controller.example/123456789abcdefghi",
    "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
  }],
  <span class="comment">...</span>
}</pre>
      </div>
          </section>

          <section id="Multikey"><div class="header-wrapper"><h4 id="x2-2-2-multikey"><bdi class="secno">2.2.2 </bdi>Multikey</h4><a class="self-link" href="#Multikey" aria-label="Permalink for Section 2.2.2"></a></div>
            
            <p>
The Multikey data model is a specific type of <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-43">verification method</a> that
encodes key types into a single binary stream that is then encoded as a
Multibase value as described in Section <a href="#multibase-0" data-matched-text="[[[#multibase-0]]]" class="sec-ref"><bdi class="secno">2.4 </bdi>Multibase</a>.
            </p>

            <p>
When specifying a <code>Multikey</code>, the object takes the following form:
            </p>

            <dl>
              <dt>type</dt>
              <dd>
The value of the <code>type</code> property <em class="rfc2119">MUST</em> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string">string</a> that is set to
<code>Multikey</code>.
              </dd>
              <dt><dfn class="lint-ignore" id="dfn-publickeymultibase" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">publicKeyMultibase</dfn></dt>
              <dd>
The <code>publicKeyMultibase</code> property is <em class="rfc2119">OPTIONAL</em>. If present, its value <em class="rfc2119">MUST</em> be a
Multibase encoded value as described in Section <a href="#multibase-0" data-matched-text="[[[#multibase-0]]]" class="sec-ref"><bdi class="secno">2.4 </bdi>Multibase</a>.
              </dd>
              <dt><dfn class="lint-ignore" id="dfn-secretkeymultibase" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">secretKeyMultibase</dfn></dt>
              <dd>
The <code>secretKeyMultibase</code> property is <em class="rfc2119">OPTIONAL</em>. If present, its value <em class="rfc2119">MUST</em> be a
Multibase encoded value as described in Section <a href="#multibase-0" data-matched-text="[[[#multibase-0]]]" class="sec-ref"><bdi class="secno">2.4 </bdi>Multibase</a>.
              </dd>
            </dl>

            <p>
The example below expresses an Ed25519 public key using the format defined
above:
            </p>

            <div class="example" id="example-multikey-encoding-of-a-ed25519-public-key">
        <div class="marker">
    <a class="self-link" href="#example-multikey-encoding-of-a-ed25519-public-key">Example<bdi> 8</bdi></a><span class="example-title">: Multikey encoding of a Ed25519 public key</span>
  </div> <pre class="nohighlight">{
  "@context": "https://www.w3.org/ns/cid/v1",
  "id": "https://controller.example/123456789abcdefghi#keys-1",
  "type": "Multikey",
  "controller": "https://controller.example/123456789abcdefghi",
  "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
}</pre>
      </div>

            <p>
The public key values are expressed using the rules in the table below:
            </p>

            <table class="simple">
              <thead>
                <tr><th>Key type</th>
                <th>Description</th>
              </tr></thead>
              <tbody>
                <tr>
                  <td>ECDSA 256-bit public key</td>
                  <td>
The Multikey encoding of a P-256 public key <em class="rfc2119">MUST</em> start with the two-byte prefix
<code>0x8024</code> (the varint expression of <code>0x1200</code>) followed by the 33-byte compressed
public key data. The resulting 35-byte value <em class="rfc2119">MUST</em> then be encoded using the
base-58-btc alphabet, according to Section <a href="#multibase-0" data-matched-text="[[[#multibase-0]]]" class="sec-ref"><bdi class="secno">2.4 </bdi>Multibase</a>, and then
prepended with the base-58-btc Multibase header (<code>z</code>).
                  </td>
                </tr>
                <tr>
                  <td>ECDSA 384-bit public key</td>
                  <td>
The encoding of a P-384 public key <em class="rfc2119">MUST</em> start with the two-byte prefix <code>0x8124</code>
(the varint expression of <code>0x1201</code>) followed by the 49-byte compressed public
key data. The resulting 51-byte value is then encoded using the base-58-btc
alphabet, according to Section <a href="#multibase-0" data-matched-text="[[[#multibase-0]]]" class="sec-ref"><bdi class="secno">2.4 </bdi>Multibase</a>, and then prepended with the
base-58-btc Multibase header (<code>z</code>).
                  </td>
                </tr>
                <tr>
                  <td>Ed25519 256-bit public key</td>
                  <td>
The encoding of an Ed25519 public key <em class="rfc2119">MUST</em> start with the two-byte prefix
<code>0xed01</code> (the varint expression of <code>0xed</code>), followed by the 32-byte public key
data. The resulting 34-byte value <em class="rfc2119">MUST</em> then be encoded using the base-58-btc
alphabet, according to Section <a href="#multibase-0" data-matched-text="[[[#multibase-0]]]" class="sec-ref"><bdi class="secno">2.4 </bdi>Multibase</a>, and then prepended with the
base-58-btc Multibase header (<code>z</code>).
                  </td>
                </tr>
                <tr>
                  <td>BLS12-381 381-bit public key</td>
                  <td>
The encoding of an BLS12-381 public key in the G2 group <em class="rfc2119">MUST</em> start with
the two-byte prefix <code>0xeb01</code> (the varint expression of <code>0xeb</code>), followed
by the 96-byte compressed public key data. The resulting 98-byte value <em class="rfc2119">MUST</em>
then be encoded using the base-58-btc alphabet, according to Section
<a href="#multibase-0" data-matched-text="[[[#multibase-0]]]" class="sec-ref"><bdi class="secno">2.4 </bdi>Multibase</a>, and then prepended with the base-58-btc Multibase header
(<code>z</code>).
                  </td>
                </tr>
              </tbody>
            </table>

            <p>
The secret key values are expressed using the rules in the table below:
            </p>

            <table class="simple">
              <thead>
                <tr><th>Key type</th>
                <th>Description</th>
              </tr></thead>
              <tbody>
                <tr>
                  <td>ECDSA 256-bit secret key</td>
                  <td>
The Multikey encoding of a P-256 secret key <em class="rfc2119">MUST</em> start with the two-byte prefix
<code>0x8626</code> (the varint expression of <code>0x1306</code>) followed by the 32-byte
secret key data. The resulting 34-byte value <em class="rfc2119">MUST</em> then be encoded using the
base-58-btc alphabet, according to Section <a href="#multibase-0" data-matched-text="[[[#multibase-0]]]" class="sec-ref"><bdi class="secno">2.4 </bdi>Multibase</a>, and then
prepended with the base-58-btc Multibase header (<code>z</code>).
                  </td>
                </tr>
                <tr>
                  <td>ECDSA 384-bit secret key</td>
                  <td>
The encoding of a P-384 secret key <em class="rfc2119">MUST</em> start with the two-byte prefix <code>0x8726</code>
(the varint expression of <code>0x1307</code>) followed by the 48-byte secret
key data. The resulting 50-byte value is then encoded using the base-58-btc
alphabet, according to Section <a href="#multibase-0" data-matched-text="[[[#multibase-0]]]" class="sec-ref"><bdi class="secno">2.4 </bdi>Multibase</a>, and then prepended with the
base-58-btc Multibase header (<code>z</code>).
                  </td>
                </tr>
                <tr>
                  <td>Ed25519 256-bit secret key</td>
                  <td>
The encoding of an Ed25519 secret key <em class="rfc2119">MUST</em> start with the two-byte prefix
<code>0x8026</code> (the varint expression of <code>0x1300</code>), followed by the 32-byte secret key
data. The resulting 34-byte value <em class="rfc2119">MUST</em> then be encoded using the base-58-btc
alphabet, according to Section <a href="#multibase-0" data-matched-text="[[[#multibase-0]]]" class="sec-ref"><bdi class="secno">2.4 </bdi>Multibase</a>, and then prepended with the
base-58-btc Multibase header (<code>z</code>).
                  </td>
                </tr>
                <tr>
                  <td>BLS12-381 381-bit secret key</td>
                  <td>
The encoding of an BLS12-381 secret key in the G2 group <em class="rfc2119">MUST</em> start with
the two-byte prefix <code>0x8030</code> (the varint expression of <code>0x130a</code>), followed
by the 96-byte compressed public key data. The resulting 98-byte value <em class="rfc2119">MUST</em>
then be encoded using the base-58-btc alphabet, according to Section
<a href="#multibase-0" data-matched-text="[[[#multibase-0]]]" class="sec-ref"><bdi class="secno">2.4 </bdi>Multibase</a>, and then prepended with the base-58-btc Multibase header
(<code>z</code>).
                  </td>
                </tr>
              </tbody>

            </table>

            <p class="advisement">
Developers are advised to not accidentally publish a representation of a secret
key. Implementations that adhere to this specification will raise errors in the
event of a Multikey header value that is not in the public key header table
above, or when reading a Multikey value that is expected to be a public key,
such as one published in a controlled identifier document, that does not start with a known
public key header.
            </p>

            <p>
When defining values for use with <code>publicKeyMultibase</code> and <code>secretKeyMultibase</code>,
specification authors <em class="rfc2119">MAY</em> define additional header values for other key types in
other specifications and <em class="rfc2119">MUST NOT</em> define alternate encodings for key types
already defined by this specification.
            </p>

          </section>

          <section id="JsonWebKey"><div class="header-wrapper"><h4 id="x2-2-3-jsonwebkey"><bdi class="secno">2.2.3 </bdi>JsonWebKey</h4><a class="self-link" href="#JsonWebKey" aria-label="Permalink for Section 2.2.3"></a></div>
            
            <p>
The JSON Web Key (JWK) data model is a specific type of <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-44">verification method</a>
that uses the JWK specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7517" title="JSON Web Key (JWK)">RFC7517</a></cite>] to encode key types into a
set of parameters.
            </p>

            <p>
When specifing a <code>JsonWebKey</code>, the object takes the following form:
            </p>

            <dl>
              <dt>type</dt>
              <dd>
The value of the <code>type</code> property <em class="rfc2119">MUST</em> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string">string</a> that is set to
<code>JsonWebKey</code>.
              </dd>
              <dt><dfn class="lint-ignore" id="dfn-publickeyjwk" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">publicKeyJwk</dfn></dt>
              <dd>
                <p>
The <code>publicKeyJwk</code> property is <em class="rfc2119">OPTIONAL</em>. If present, its value <em class="rfc2119">MUST</em>
be a <a href="https://infra.spec.whatwg.org/#ordered-map">map</a> representing a JSON Web Key that
conforms to [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7517" title="JSON Web Key (JWK)">RFC7517</a></cite>]. The <a href="https://infra.spec.whatwg.org/#ordered-map">map</a> <em class="rfc2119">MUST NOT</em>
include any members of the private information class, such as <code>d</code>, as described
in the <a href="https://datatracker.ietf.org/doc/html/rfc7517#section-8.1.1">JWK
Registration Template</a>. It is <em class="rfc2119">RECOMMENDED</em> that verification methods that use
JWKs [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7517" title="JSON Web Key (JWK)">RFC7517</a></cite>] to represent their <a data-link-type="dfn|abstract-op" href="#dfn-public-key" class="internalDFN" id="ref-for-dfn-public-key-4">public keys</a> use the value of <code>kid</code> as
their fragment identifier. It is <em class="rfc2119">RECOMMENDED</em> that JWK <code>kid</code> values are set to
the JWK Thumbprint [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7638" title="JSON Web Key (JWK) Thumbprint">RFC7638</a></cite>] using the SHA-256 (SHA2-256) hash function of the <a data-link-type="dfn|abstract-op" href="#dfn-public-key" class="internalDFN" id="ref-for-dfn-public-key-5">public key</a>.
See the first key in
<a href="#example-various-verification-method-types" data-matched-text="[[[#example-various-verification-method-types]]]" class="box-ref">Example<bdi> 7</bdi></a> for an example of a
public key with a compound key identifier.
                </p>
                <p>
As specified in <a href="https://www.rfc-editor.org/rfc/rfc7517#section-4.4">Section 4.4 of the JWK specification</a>,
the <em class="rfc2119">OPTIONAL</em> <code>alg</code> property identifies the algorithm intended for use with the public key,
and <em class="rfc2119">SHOULD</em> be included to prevent security issues that can arise when using the same
key with multiple algorithms. As specified in <a href="https://www.rfc-editor.org/rfc/rfc7518#section-6.2.1.1">
Section 6.2.1.1 of the JWA specification</a>, describing a key using an elliptic curve,
the <em class="rfc2119">REQUIRED</em> <code>crv</code> property is used to identify the particular curve type of the public key.
As specified in <a href="https://www.rfc-editor.org/rfc/rfc7515#section-4.1.4">Section 4.1.4 of the JWS specification</a>,
the <em class="rfc2119">OPTIONAL</em> <code>kid</code> property is a hint used to help discover the key; if present, the <code>kid</code> value <em class="rfc2119">SHOULD</em>
match, or be included in, the <code>id</code> property of the encapsulating <code>JsonWebKey</code> object,
as part of the path, query, or fragment of the URL.
                </p>

              </dd>
              <dt><dfn class="lint-ignore" id="dfn-secretkeyjwk" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">secretKeyJwk</dfn></dt>
              <dd>
The <code>secretKeyJwk</code> property is <em class="rfc2119">OPTIONAL</em>. If present, its value <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-map">map</a> representing a JSON Web Key that conforms
to [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7517" title="JSON Web Key (JWK)">RFC7517</a></cite>].
It <em class="rfc2119">MUST NOT</em> be used if the data structure containing it is public or may be revealed to parties other than the legitimate holders of the secret key.
              </dd>
            </dl>

            <p>
An example of an object that conforms to <code>JsonWebKey</code> is provided below:
            </p>

            <div class="example" id="example-json-web-key-encoding-of-a-secp384r1-p-384-public-key">
        <div class="marker">
    <a class="self-link" href="#example-json-web-key-encoding-of-a-secp384r1-p-384-public-key">Example<bdi> 9</bdi></a><span class="example-title">: JSON Web Key encoding of a secp384r1 (P-384) public key</span>
  </div> <pre class="nohighlight">{
  "id": "https://controller.example/123456789abcdefghi#key-1",
  "type": "JsonWebKey",
  "controller": "https://controller.example/123456789abcdefghi",
  "publicKeyJwk": {
      "kid": "key-1",
      "kty": "EC",
      "crv": "P-384",
      "alg": "ES384",
      "x": "1F14JSzKbwxO-Heqew5HzEt-0NZXAjCu8w-RiuV8_9tMiXrSZdjsWqi4y86OFb5d",
      "y": "dnd8yoq-NOJcBuEYgdVVMmSxonXg-DU90d7C4uPWb_Lkd4WIQQEH0DyeC2KUDMIU"
    }
}</pre>
      </div>

            <p>
In the example above, the <code>publicKeyJwk</code> value contains the JSON Web Key.
The <code>kty</code> property encodes the key type of "EC", which means
"Elliptic Curve". The <code>alg</code> property identifies the algorithm intended
for use with the public key, which in this case is <code>ES384</code>. The <code>crv</code> property identifies
the particular curve type of the public key, <code>P-384</code>. The <code>x</code> and <code>y</code> properties specify
the point on the <code>P-384</code> curve that is associated with the public key.
            </p>

            <p>
The <code>publicKeyJwk</code> property <em class="rfc2119">MUST NOT</em> contain any property marked as
"Private" or "Secret" in any registry contained in the JOSE Registries [<cite><a class="bibref" data-link-type="biblio" href="#bib-jose-registries" title="The JSON Object Signing and Encryption (JOSE) Registries">JOSE-REGISTRIES</a></cite>], including "d".
            </p>

            <p>
The JSON Web Key data model is also capable of encoding <em>secret keys</em>, sometimes
referred to as <em>private keys</em>.
            </p>

            <div class="example" id="example-json-web-key-encoding-of-a-secp384r1-p-384-secret-key">
        <div class="marker">
    <a class="self-link" href="#example-json-web-key-encoding-of-a-secp384r1-p-384-secret-key">Example<bdi> 10</bdi></a><span class="example-title">: JSON Web Key encoding of a secp384r1 (P-384) secret key</span>
  </div> <pre class="nohighlight">{
  "id": "https://controller.example/123456789abcdefghi#key-1",
  "type": "JsonWebKey",
  "controller": "https://controller.example/123456789abcdefghi",
  "secretKeyJwk": {
      "kty": "EC",
      "crv": "P-384",
      "alg": "ES384",
      "d": "fGwges0SX1mj4eZamUCL4qtZijy9uT15fI4gKTuRvre4Kkoju2SHM4rlFOeKVraH",
      "x": "1F14JSzKbwxO-Heqew5HzEt-0NZXAjCu8w-RiuV8_9tMiXrSZdjsWqi4y86OFb5d",
      "y": "dnd8yoq-NOJcBuEYgdVVMmSxonXg-DU90d7C4uPWb_Lkd4WIQQEH0DyeC2KUDMIU"
    }
}</pre>
      </div>

            <p>
The private key example above is almost identical to the previous example of the
public key, except that the information is stored in the <code>secretKeyJwk</code> property
(rather than the <code>publicKeyJwk</code>), and the private key value is encoded in the <code>d</code>
property thereof (alongside the <code>x</code> and <code>y</code> properties, which still specify
the point on the <code>P-384</code> curve that is associated with the public key).
            </p>

          </section>

          <section id="referring-to-verification-methods"><div class="header-wrapper"><h4 id="x2-2-4-referring-to-verification-methods"><bdi class="secno">2.2.4 </bdi>Referring to Verification Methods</h4><a class="self-link" href="#referring-to-verification-methods" aria-label="Permalink for Section 2.2.4"></a></div>
            
            <p>
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-45">Verification methods</a> can be embedded in or referenced from properties
associated with various <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-4">verification relationships</a> as described in
<a href="#verification-relationships" data-matched-text="[[[#verification-relationships]]]" class="sec-ref"><bdi class="secno">2.3 </bdi>Verification Relationships</a>. Referencing <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-46">verification methods</a>
allows them to be used by more than one <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-5">verification relationship</a>.
            </p>

            <p>
If the value of a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-47">verification method</a> property is a <a href="https://infra.spec.whatwg.org/#ordered-map">map</a>, the <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-48">verification method</a> has been
embedded and its properties can be accessed directly. However, if the value is a
URL <a href="https://infra.spec.whatwg.org/#string">string</a>, the <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-49">verification method</a> has
been included by reference and its properties will need to be retrieved from
elsewhere in the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-39">controlled identifier document</a> or from another <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-40">controlled identifier document</a>. This
is done by dereferencing the URL and searching the resulting resource for a
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-50">verification method</a> <a href="https://infra.spec.whatwg.org/#ordered-map">map</a> with an
<code>id</code> property whose value matches the URL.
            </p>

            <div class="example" id="example-embedding-and-referencing-verification-methods">
        <div class="marker">
    <a class="self-link" href="#example-embedding-and-referencing-verification-methods">Example<bdi> 11</bdi></a><span class="example-title">: Embedding and referencing verification methods</span>
  </div> <pre class="nohighlight">    {
<span class="comment">...</span>

      "authentication": [
        <span class="comment">// this key is referenced and might be used by</span>
        <span class="comment">// more than one verification relationship</span>
        "https://controller.example/123456789abcdefghi#keys-1",
        <span class="comment">// this key is embedded and may *only* be used for authentication</span>
        {
          "id": "https://controller.example/123456789abcdefghi#keys-2",
          "type": "Multikey", <span class="comment">// external (property value)</span>
          "controller": "https://controller.example/123456789abcdefghi",
          "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
        }
      ],

<span class="comment">...</span>
    }</pre>
      </div>
          </section>
        </section>

        <section id="verification-relationships"><div class="header-wrapper"><h3 id="x2-3-verification-relationships"><bdi class="secno">2.3 </bdi>Verification Relationships</h3><a class="self-link" href="#verification-relationships" aria-label="Permalink for Section 2.3"></a></div>
          

          <p>
A <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-6">verification relationship</a> is an expression that one or more
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-51">verification methods</a> are authorized to verify <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-16">proofs</a> made on behalf of
the subject.
          </p>

          <p>
Different <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-7">verification relationships</a> enable the associated <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-52">verification methods</a> to be used for different purposes. It is up to a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a>
to ascertain the validity of a verification attempt by checking that the
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-53">verification method</a> used is referred to by the appropriate <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-8">verification relationship</a> property in the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-41">controlled identifier document</a>.
          </p>

          <p>
The <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-9">verification relationship</a> between the <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-15">subject</a> and the <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-54">verification method</a> is explicit in the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-42">controlled identifier document</a>. <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-55">Verification methods</a>
that are not associated with a particular <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-10">verification relationship</a> cannot
be used for that <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-11">verification relationship</a>. For example, a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-56">verification method</a> associated with the <a data-link-type="dfn|abstract-op" href="#dfn-authenticated" class="internalDFN" id="ref-for-dfn-authenticated-8">authentication</a> property cannot be used to
engage in key agreement protocols — the value of the
<a href="#defn-keyAgreement" id="ref-for-defn-keyAgreement-1">keyAgreement</a> property needs to be used for
that.
          </p>

          <p>
If a referenced <a data-link-type="dfn|abstract-op" href="#dfn-verification-method-definition" class="internalDFN" id="ref-for-dfn-verification-method-definition-2">verification method definition</a> is not in the latest
<a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-43">controlled identifier document</a> used to dereference it, then that <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-57">verification method</a> is considered invalid or revoked.
          </p>

          <p>
The following sections define several useful <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-12">verification relationships</a>. A
<a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-44">controlled identifier document</a> <em class="rfc2119">MAY</em> include any of these, or other properties, to
express a specific <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-13">verification relationship</a>. To maximize interoperability,
any such properties used <em class="rfc2119">SHOULD</em> be registered in the list of
<cite><a data-matched-text="[[[DID-EXTENSIONS-PROPERTIES]]]" href="https://www.w3.org/TR/did-extensions-properties/">DID Document Property Extensions</a></cite>.
          </p>

          <section id="authentication"><div class="header-wrapper"><h4 id="x2-3-1-authentication"><bdi class="secno">2.3.1 </bdi>Authentication</h4><a class="self-link" href="#authentication" aria-label="Permalink for Section 2.3.1"></a></div>
            

            <p>
The <code>authentication</code> <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-14">verification relationship</a> is used to specify how the
<a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-16">subject</a> is expected to be <a data-link-type="dfn|abstract-op" href="#dfn-authenticated" class="internalDFN" id="ref-for-dfn-authenticated-9">authenticated</a>, for purposes such as logging
into a website or engaging in any sort of challenge-response protocol. The
processing performed following authentication is application-specific.
            </p>

            <dl>
              <dt id="defn-authentication">authentication</dt>
              <dd>
The <code>authentication</code> property is <em class="rfc2119">OPTIONAL</em>. If present, its
value <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of one or more
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-58">verification methods</a>. Each <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-59">verification method</a> <em class="rfc2119">MAY</em> be embedded or
referenced.
              </dd>
            </dl>

            <div class="example" id="example-authentication-property-containing-three-verification-methods">
        <div class="marker">
    <a class="self-link" href="#example-authentication-property-containing-three-verification-methods">Example<bdi> 12</bdi></a><span class="example-title">: Authentication property
                          containing three verification methods</span>
  </div> <pre class="nohighlight">{
  "@context": "https://www.w3.org/ns/cid/v1",
  "id": "https://controller.example/123456789abcdefghi",
  <span class="comment">...</span>
  "authentication": [
    <span class="comment">// this method can be used to authenticate</span>
    "https://controller.example/123456789abcdefghi#keys-1",
    <span class="comment">// this method is *only* approved for authentication, so its</span>
    <span class="comment">// full description is embedded here rather than using only a reference</span>
    {
      "id": "https://controller.example/123456789abcdefghi#keys-2",
      "type": "JsonWebKey",
      "controller": "https://controller.example/123456789abcdefghi",
      "publicKeyJwk": {
        "crv": "Ed25519",
        "x": "VCpo2LMLhn6iWku8MKvSLg2ZAoC-nlOyPVQaO3FxVeQ",
        "kty": "OKP",
        "kid": "_Qq0UL2Fq651Q0Fjd6TvnYE-faHiOpRlPVQcY_-tA4A"
      }
    },
    {
      "id": "https://controller.example/123456789abcdefghi#keys-3",
      "type": "Multikey",
      "controller": "https://controller.example/123456789abcdefghi",
      "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
    }
  ],
  <span class="comment">...</span>
}</pre>
      </div>

            <p>
This is useful to any entity verifying authentication that needs to check
whether an entity that is attempting to <a data-link-type="dfn|abstract-op" href="#dfn-authenticated" class="internalDFN" id="ref-for-dfn-authenticated-10">authenticate</a> is presenting a valid
proof of authentication. When such an authentication-verifying entity receives
some data (in some protocol-specific format) that contains a <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-17">proof</a> that was made
for the purpose of "authentication", and that says that an entity is identified
by the <code>id</code>, then that <em>verifier</em> checks to ensure that the <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-18">proof</a> can be
verified using a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-60">verification method</a> (for example, <a data-link-type="dfn|abstract-op" href="#dfn-public-key" class="internalDFN" id="ref-for-dfn-public-key-6">public key</a>) listed
under <code>authentication</code> in the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-45">controlled identifier document</a>.
            </p>
            <p>
Note that the <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-61">verification method</a> indicated by the
<code>authentication</code> property of a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-46">controlled identifier document</a> can
only be used to <a data-link-type="dfn|abstract-op" href="#dfn-authenticated" class="internalDFN" id="ref-for-dfn-authenticated-11">authenticate</a> on behalf
of the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-47">controlled identifier document</a>'s <a data-link-type="dfn|abstract-op" href="#dfn-base-identifier" class="internalDFN" id="ref-for-dfn-base-identifier-3">base identifier</a>.
            </p>
          </section>

          <section id="assertion"><div class="header-wrapper"><h4 id="x2-3-2-assertion"><bdi class="secno">2.3.2 </bdi>Assertion</h4><a class="self-link" href="#assertion" aria-label="Permalink for Section 2.3.2"></a></div>
            

            <p>
The <code>assertionMethod</code> <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-15">verification relationship</a> is used to
specify <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-62">verification methods</a> that a <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-28">controller</a> authorizes for use
when expressing assertions or claims, such as in verifiable credentials.
            </p>

            <dl>
              <dt id="defn-assertionMethod">assertionMethod</dt>
              <dd>
The <code>assertionMethod</code> property is <em class="rfc2119">OPTIONAL</em>. If present, its associated
value <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of one or
more <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-63">verification methods</a>. Each <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-64">verification method</a> <em class="rfc2119">MAY</em>
be embedded or referenced.
              </dd>
            </dl>

            <p>
This property is useful, for example, during the processing of a
verifiable credential by a verifier.

            </p>

            <div class="example" id="example-assertion-method-property-containing-two-verification-methods">
        <div class="marker">
    <a class="self-link" href="#example-assertion-method-property-containing-two-verification-methods">Example<bdi> 13</bdi></a><span class="example-title">: Assertion method property
                        containing two verification methods</span>
  </div> <pre class="nohighlight">{
  "@context": "https://www.w3.org/ns/cid/v1",
  "id": "https://controller.example/123456789abcdefghi",
  <span class="comment">...</span>
  "assertionMethod": [
    <span class="comment">// this method can be used to assert statements</span>
    "https://controller.example/123456789abcdefghi#keys-1",
    <span class="comment">// this method is *only* approved for assertion of statements, it is not</span>
    <span class="comment">// used for any other verification relationship, so its full description is</span>
    <span class="comment">// embedded here rather than using a reference</span>
    {
      "id": "https://controller.example/123456789abcdefghi#keys-2",
      "type": "Multikey", <span class="comment">// external (property value)</span>
      "controller": "https://controller.example/123456789abcdefghi",
      "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
    }
  ],
  <span class="comment">...</span>
}</pre>
      </div>
          </section>

          <section id="key-agreement"><div class="header-wrapper"><h4 id="x2-3-3-key-agreement"><bdi class="secno">2.3.3 </bdi>Key Agreement</h4><a class="self-link" href="#key-agreement" aria-label="Permalink for Section 2.3.3"></a></div>
            

            <p>
The <code>keyAgreement</code> <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-16">verification relationship</a> is used to
specify how an entity can perform encryption in order to transmit
confidential information intended for the <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-29">controller</a>, such as for
the purposes of establishing a secure communication channel with the recipient.
            </p>

            <dl>
              <dt><dfn id="defn-keyAgreement" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">keyAgreement</dfn></dt>
              <dd>
The <code>keyAgreement</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the associated
value <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of one or more
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-65">verification methods</a>. Each <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-66">verification method</a> <em class="rfc2119">MAY</em> be embedded or
referenced.
              </dd>
            </dl>

            <p>
An example of when this property is useful is when encrypting a message intended
for the <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-30">controller</a>. In this case, the counterparty uses the
cryptographic <a data-link-type="dfn|abstract-op" href="#dfn-public-key" class="internalDFN" id="ref-for-dfn-public-key-7">public key</a> information in the <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-67">verification method</a> to
wrap a decryption key for the recipient.
            </p>

            <div class="example" id="example-key-agreement-property-containing-two-verification-methods">
        <div class="marker">
    <a class="self-link" href="#example-key-agreement-property-containing-two-verification-methods">Example<bdi> 14</bdi></a><span class="example-title">: Key agreement property
                          containing two verification methods</span>
  </div> <pre class="nohighlight">{
  "@context": "https://www.w3.org/ns/cid/v1",
  "id": "https://controller.example/123456789abcdefghi",
  <span class="comment">...</span>
  "keyAgreement": [
    "https://controller.example/123456789abcdefghi#keys-1",
    <span class="comment">// the rest of the methods below are *only* approved for key agreement usage</span>
    <span class="comment">// they will not be used for any other verification relationship</span>
    <span class="comment">// the full value is embedded here rather than using only a reference</span>
    {
      "id": "https://controller.example/123#keys-2",
      "type": "Multikey",
      "controller": "https://controller.example/123",
      "publicKeyMultibase": "zDnaerx9CtbPJ1q36T5Ln5wYt3MQYeGRG5ehnPAmxcf5mDZpv"
    },
    {
      "id": "https://controller.example/123#keys-3",
      "type": "JsonWebKey",
      "controller": "https://controller.example/123",
      "publicKeyJwk": {
        "kty": "OKP",
        "crv": "X25519",
        "x": "W_Vcc7guviK-gPNDBmevVw-uJVamQV5rMNQGUwCqlH0"
      }
    }
  ],
  <span class="comment">...</span>
}</pre>
      </div>
          </section>

          <section id="capability-invocation"><div class="header-wrapper"><h4 id="x2-3-4-capability-invocation"><bdi class="secno">2.3.4 </bdi>Capability Invocation</h4><a class="self-link" href="#capability-invocation" aria-label="Permalink for Section 2.3.4"></a></div>
            

            <p>
The <code>capabilityInvocation</code> <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-17">verification relationship</a> is used
to specify a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-68">verification method</a> that might be used by the
<a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-31">controller</a> to invoke a cryptographic capability, such as the
authorization to update the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-48">controlled identifier document</a>.
            </p>

            <dl>
              <dt id="defn-capabilityInvocation">capabilityInvocation</dt>
              <dd>
The <code>capabilityInvocation</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the
associated value <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of
one or more <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-69">verification methods</a>. Each <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-70">verification method</a> <em class="rfc2119">MAY</em> be
embedded or referenced.
              </dd>
            </dl>

            <p>
An example of when this property is useful is when a <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-32">controller</a> needs to
access a protected HTTP API that requires authorization in order to use it. In
order to authorize when using the HTTP API, the <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-33">controller</a>
uses a capability that is associated with a particular URL that is
exposed via the HTTP API. The invocation of the capability could be
expressed in a number of ways, for example, as a digitally signed
message that is placed into the HTTP Headers.
            </p>
            <p>
The server providing the HTTP API is the <em>verifier</em> of the capability and
it would need to verify that the <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-71">verification method</a> referred to by the
invoked capability exists in the <code>capabilityInvocation</code>
property of the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-49">controlled identifier document</a>. The verifier would also check to make sure
that the action being performed is valid and the capability is appropriate for
the resource being accessed. If the verification is successful, the server has
cryptographically determined that the invoker is authorized to access the
protected resource.
            </p>

            <div class="example" id="example-capability-invocation-property-containing-two-verification-methods">
        <div class="marker">
    <a class="self-link" href="#example-capability-invocation-property-containing-two-verification-methods">Example<bdi> 15</bdi></a><span class="example-title">: Capability invocation property
                          containing two verification methods</span>
  </div> <pre class="nohighlight">{
  "@context": "https://www.w3.org/ns/cid/v1",
  "id": "https://controller.example/123456789abcdefghi",
  <span class="comment">...</span>
  "capabilityInvocation": [
    <span class="comment">// this method can be used to invoke capabilities as https:...fghi</span>
    "https://controller.example/123456789abcdefghi#keys-1",
    <span class="comment">// this method is *only* approved for use in capability invocation; it will not</span>
    <span class="comment">// be used for any other verification relationship, so its full description is</span>
    <span class="comment">// embedded here rather than using only a reference</span>
    {
    "id": "https://controller.example/123456789abcdefghi#keys-2",
    "type": "Multikey", <span class="comment">// external (property value)</span>
    "controller": "https://controller.example/123456789abcdefghi",
    "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
    }
  ],
  <span class="comment">...</span>
}</pre>
      </div>
          </section>

          <section id="capability-delegation"><div class="header-wrapper"><h4 id="x2-3-5-capability-delegation"><bdi class="secno">2.3.5 </bdi>Capability Delegation</h4><a class="self-link" href="#capability-delegation" aria-label="Permalink for Section 2.3.5"></a></div>
            

            <p>
The <code>capabilityDelegation</code> <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-18">verification relationship</a> is used to specify a
mechanism that might be used to delegate a cryptographic
capability to another party. The mechanism, such as an
<a href="https://w3c-ccg.github.io/zcap-spec/">Authorization Capability</a>
or a <a href="https://github.com/ucan-wg/spec/blob/main/README.md">UCAN</a>, and
the processing performed following delegation, such as accessing a specific HTTP
API, is application-specific.
            </p>

            <dl>
              <dt id="defn-capabilityDelegation">capabilityDelegation</dt>
              <dd>
The <code>capabilityDelegation</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the
associated value <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of
one or more <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-72">verification methods</a>. Each <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-73">verification method</a> <em class="rfc2119">MAY</em> be
embedded or referenced.
              </dd>
            </dl>

            <p>
An example of when this property is useful is when a <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-34">controller</a> chooses
to delegate their capability to access a protected HTTP API to a party other
than themselves. In order to delegate the capability, the <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-35">controller</a>
would use a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-74">verification method</a> associated with the
<code>capabilityDelegation</code> <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-19">verification relationship</a> to
cryptographically sign the capability over to another <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-36">controller</a>. The
delegate would then use the capability in a manner that is similar to the
example described in <a href="#capability-invocation" data-matched-text="[[[#capability-invocation]]]" class="sec-ref"><bdi class="secno">2.3.4 </bdi>Capability Invocation</a>.
            </p>

            <div class="example" id="example-capability-delegation-property-containing-two-verification-methods">
        <div class="marker">
    <a class="self-link" href="#example-capability-delegation-property-containing-two-verification-methods">Example<bdi> 16</bdi></a><span class="example-title">: Capability Delegation property
                          containing two verification methods</span>
  </div> <pre class="nohighlight">{
  "@context": "https://www.w3.org/ns/cid/v1",
  "id": "https://controller.example/123456789abcdefghi",
  <span class="comment">...</span>
  "capabilityDelegation": [
    <span class="comment">// this method can be used to perform capability delegation</span>
    "https://controller.example/123456789abcdefghi#keys-1",
    <span class="comment">// this method is *only* approved for granting capabilities; it will not</span>
    <span class="comment">// be used for any other verification relationship, so its full description is</span>
    <span class="comment">// embedded here rather than using only a reference</span>
    {
      "id": "https://controller.example/123456789abcdefghi#keys-2",
      "type": "JsonWebKey", <span class="comment">// external (property value)</span>
      "controller": "https://controller.example/123456789abcdefghi",
      "publicKeyJwk": {
        "kty": "OKP",
        "crv": "Ed25519",
        "x": "O2onvM62pC1io6jQKm8Nc2UyFXcd4kOmOsBIoYtZ2ik"
      }
    },
    {
      "id": "https://controller.example/123456789abcdefghi#keys-3",
      "type": "Multikey", <span class="comment">// external (property value)</span>
      "controller": "https://controller.example/123456789abcdefghi",
      "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
    }
  ],
  <span class="comment">...</span>
}</pre>
      </div>
          </section>
        </section>

        <section id="multibase-0"><div class="header-wrapper"><h3 id="x2-4-multibase"><bdi class="secno">2.4 </bdi>Multibase</h3><a class="self-link" href="#multibase-0" aria-label="Permalink for Section 2.4"></a></div>
          

          <p>
A Multibase value encodes a binary value as a
<a href="https://en.wikipedia.org/wiki/Binary-to-text_encoding">base-encoded
string</a>. The value starts with a single character header, which identifies
the base and encoding alphabet used to encode a binary value, followed by the
encoded binary value (using that base and alphabet). The common
<dfn class="export" data-export="" id="dfn-multibase-header" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Multibase header</dfn> values and their associated base
encoding alphabets, as provided below, are normative:
          </p>

          <table class="simple">
            <thead>
              <tr>
                <th>Multibase&nbsp;Header</th>
                <th>Description</th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td><code>u</code></td>
                <td>
The base-64-url-no-pad alphabet is used to encode the bytes. The base-alphabet
consists of the following characters, in order:
<code>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_</code>
                </td>
              </tr>
              <tr>
                <td><code>z</code></td>
                <td>
The base-58-btc alphabet is used to encode the bytes. The base-alphabet consists
of the following characters, in order:
<code>123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz</code>
                </td>
              </tr>
            </tbody>
          </table>

          <p>
Other Multibase encoding values <em class="rfc2119">MAY</em> be used, but interoperability is not
guaranteed between implementations using such values.
          </p>

          <p>
To base-encode a binary value into a Multibase string, an implementation <em class="rfc2119">MUST</em>
apply the algorithm in Section <a href="#base-encode" data-matched-text="[[[#base-encode]]]" class="sec-ref"><bdi class="secno">3.1 </bdi>Base Encode</a> to the binary value,
with the desired base encoding and alphabet from the table above, ensuring to
prepend the associated Multibase header from the table above to the result.
Any algorithm with equivalent output <em class="rfc2119">MAY</em> be used.
          </p>

          <p>
To base-decode a Multibase string, an implementation <em class="rfc2119">MUST</em> apply the algorithm
in Section <a href="#base-decode" data-matched-text="[[[#base-decode]]]" class="sec-ref"><bdi class="secno">3.2 </bdi>Base Decode</a> to the string following the first
character (Multibase header), with the alphabet associated with the
Multibase header. Any algorithm with equivalent output <em class="rfc2119">MAY</em> be used.
          </p>

        </section>

        <section id="multihash"><div class="header-wrapper"><h3 id="x2-5-multihash"><bdi class="secno">2.5 </bdi>Multihash</h3><a class="self-link" href="#multihash" aria-label="Permalink for Section 2.5"></a></div>
          

          <p>
A Multihash value starts with a binary header, which includes 1) an identifier
for the specific cryptographic hashing algorithm, 2) a cryptographic digest
length in bytes, and 3) the value of the cryptographic digest. The normative
Multihash header values defined by this specification, and their associated
output sizes and associated specifications, are provided below:
          </p>

          <table class="simple">
            <thead>
              <tr>
                <th>Multihash&nbsp;Identifier</th>
                <th>Multihash&nbsp;Header</th>
                <th>Description</th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td><code>sha2-256</code></td>
                <td><code>0x12</code></td>
                <td>
SHA-2 with 256 bits (32 bytes) of output, as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6234" title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">RFC6234</a></cite>].
                </td>
              </tr>
              <tr>
                <td><code>sha2-384</code></td>
                <td><code>0x20</code></td>
                <td>
SHA-2 with 384 bits (48 bytes) of output, as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6234" title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">RFC6234</a></cite>].
                </td>
              </tr>
              <tr>
                <td><code>sha3-256</code></td>
                <td><code>0x16</code></td>
                <td>
SHA-3 with 256 bits (32 bytes) of output, as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-sha3" title="SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions">SHA3</a></cite>].
                </td>
              </tr>
              <tr>
                <td><code>sha3-384</code></td>
                <td><code>0x15</code></td>
                <td>
SHA-3 with 384 bits (48 bytes) of output, as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-sha3" title="SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions">SHA3</a></cite>].
                </td>
              </tr>
            </tbody>
          </table>

          <p>
Other Multihash encoding values <em class="rfc2119">MAY</em> be used, but interoperability is not
guaranteed between implementations.
          </p>

          <p>
To encode to a Multihash value, an implementation <em class="rfc2119">MUST</em> concatenate the
associated Multihash header (encoded as a varint), the cryptographic digest
length in bytes (encoded as a varint), and the cryptographic digest value, in
that order.
          </p>

          <p>
To decode a Multihash value, an implementation <em class="rfc2119">MUST</em> 1) remove the prepended
Multihash header value, which identifies the type of cryptographic hashing
algorithm, 2) remove the cryptographic digest length in bytes, and 3) extract
the raw cryptographic digest value which <em class="rfc2119">MUST</em> match the expected output length
associated with the Multihash header as well as the output length provided in
the Multihash value itself.
          </p>

        </section>

      </section>

    <section id="algorithms"><div class="header-wrapper"><h2 id="x3-algorithms"><bdi class="secno">3. </bdi>Algorithms</h2><a class="self-link" href="#algorithms" aria-label="Permalink for Section 3."></a></div>
      

      <p>
This section defines algorithms used by this specification including
instructions on how to base-encode and base-decode values, safely retrieve
verification methods, and produce processing errors over HTTP channels.
      </p>

      <section class="normative" id="base-encode"><div class="header-wrapper"><h3 id="x3-1-base-encode"><bdi class="secno">3.1 </bdi>Base Encode</h3><a class="self-link" href="#base-encode" aria-label="Permalink for Section 3.1"></a></div>
        

        <p>
The following algorithm specifies how to encode an array of bytes, where each
byte represents a base-256 value, to a different base representation that uses a
particular base alphabet, such as base-64-url-no-pad or base-58-btc. The
required inputs are the <var>bytes</var>, <var>targetBase</var>, and
<var>baseAlphabet</var>. The output is a string that contains the base-encoded
value. All mathematical operations <em class="rfc2119">MUST</em> be performed using integer arithmetic.
Alternatives to the algorithm provided below <em class="rfc2119">MAY</em> be used as long as the
outputs of the alternative algorithm remain the same.
        </p>

        <ol class="algorithm">
          <li>
Initialize the following variables; <var>zeroes</var> to <code>0</code>, <var>length</var> to
<code>0</code>, <var>begin</var> to <code>0</code>, and <var>end</var> to the length of
<var>bytes</var>.
          </li>
          <li>
Set <var>begin</var> and <var>zeroes</var> to the number of leading <code>0</code> byte
values in <var>bytes</var>.
          </li>
          <li>
Set <var>baseValue</var> to an empty byte array that is the size of the final
base-expanded value. Calculate the final <var>size</var> of <var>baseValue</var>
by dividing log(256) by log(<var>targetBase</var>) and then multiplying the
length of <var>bytes</var> minus the leading <var>zeroes</var>. Add <code>1</code> to the
value of <var>size</var>.
          </li>
          <li>
Process each byte in <var>bytes</var> as <var>byte</var> starting at offset
<var>begin</var>:
            <ol class="algorithm">
              <li>
Set the <var>carry</var> value to <var>byte</var>.
              </li>
              <li>
Perform base-expansion by starting at the end of the <var>baseValue</var> array.
Initialize an iterator <var>i</var> to <code>0</code>. Set <var>basePosition</var> to
<var>size</var> minus <code>1</code>. Perform the following loop as long as <var>carry</var>
does not equal <code>0</code> or <var>i</var> is less than <var>length</var>, and
<var>basePosition</var> does not equal <code>-1</code>.
                <ol class="algorithm">
                  <li>
Multiply the value in <var>baseValue[basePosition]</var> by <code>256</code> and add
it to <var>carry</var>.
                  </li>
                  <li>
Set the value at <var>baseValue[basePosition]</var> to the remainder after
dividing <var>carry</var> by <var>targetBase</var>.
                  </li>
                  <li>
Set the value of <var>carry</var> to <var>carry</var> divided by
<var>targetBase</var> ensuring that integer division is used to perform the
division.
                  </li>
                  <li>
Decrement <var>basePosition</var> by <code>1</code> and increment <var>i</var> by <code>1</code>.
                  </li>
                </ol>
              </li>
              <li>
Set <var>length</var> to <var>i</var> and increment <var>begin</var> by <code>1</code>.
              </li>
            </ol>
          </li>
          <li>
Set the <var>baseEncodingPosition</var> to <var>size</var> minus <var>length</var>.
While the <var>baseEncodingPosition</var> does not equal <var>size</var> and the
<var>baseValue[baseEncodingPosition]</var> does not equal <code>0</code>, increment
<var>baseEncodingPosition</var>. This step skips the leading zeros in the
base-encoded result.
          </li>
          <li>
Initialize the <var>baseEncoding</var> by repeating the first entry in the
<var>baseAlphabet</var> by the value of <var>zeroes</var> (the number of leading
zeroes in <var>bytes</var>).
          </li>
          <li>
Convert the rest of the <var>baseValue</var> to the base-encoding. While the
<var>baseEncodingPosition</var> is less than <var>size</var>, increment the
<var>baseEncodingPosition</var>: Set <var>baseEncodedValue</var> to
<var>baseValue</var>[<var>baseEncodingPosition</var>]. Append
<var>baseAlphabet</var>[<var>baseEncodedValue</var>] to <var>baseEncoding</var>.
          </li>
          <li>
Return <var>baseEncoding</var> as the base-encoded value.
          </li>
        </ol>

        <div class="example" id="example-an-implementation-of-the-general-base-encoding-algorithm-above-in-javascript">
        <div class="marker">
    <a class="self-link" href="#example-an-implementation-of-the-general-base-encoding-algorithm-above-in-javascript">Example<bdi> 17</bdi></a><span class="example-title">: An implementation of the general base-encoding algorithm above in Javascript</span>
  </div> <pre aria-busy="false"><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">baseEncode</span>(<span class="hljs-params">bytes, targetBase, baseAlphabet</span>) {
  <span class="hljs-keyword">let</span> zeroes = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">let</span> length = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">let</span> begin = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">let</span> end = bytes.<span class="hljs-property">length</span>;

  <span class="hljs-comment">// count the number of leading bytes that are zero</span>
  <span class="hljs-keyword">while</span>(begin !== end &amp;&amp; bytes[begin] === <span class="hljs-number">0</span>) {
    begin++;
    zeroes++;
  }

  <span class="hljs-comment">// allocate enough space to store the target base value</span>
  <span class="hljs-keyword">const</span> baseExpansionFactor = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">256</span>) / <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">log</span>(targetBase);
  <span class="hljs-keyword">let</span> size = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((end - begin) * baseExpansionFactor + <span class="hljs-number">1</span>);
  <span class="hljs-keyword">let</span> baseValue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(size);

  <span class="hljs-comment">// process the entire input byte array</span>
  <span class="hljs-keyword">while</span>(begin !== end) {
    <span class="hljs-keyword">let</span> carry = bytes[begin];

    <span class="hljs-comment">// for each byte in the array, perform base-expansion</span>
    <span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> basePosition = size - <span class="hljs-number">1</span>;
        (carry !== <span class="hljs-number">0</span> || i &lt; length) &amp;&amp; (basePosition !== -<span class="hljs-number">1</span>);
        basePosition--, i++) {
      carry += <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-number">256</span> * baseValue[basePosition]);
      baseValue[basePosition] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(carry % targetBase);
      carry = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(carry / targetBase);
    }

    length = i;
    begin++;
  }

  <span class="hljs-comment">// skip leading zeroes in base-encoded result</span>
  <span class="hljs-keyword">let</span> baseEncodingPosition = size - length;
  <span class="hljs-keyword">while</span>(baseEncodingPosition !== size &amp;&amp;
        baseValue[baseEncodingPosition] === <span class="hljs-number">0</span>) {
    baseEncodingPosition++;
  }

  <span class="hljs-comment">// convert the base value to the base encoding</span>
  <span class="hljs-keyword">let</span> baseEncoding = baseAlphabet.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">repeat</span>(zeroes)
  <span class="hljs-keyword">for</span>(; baseEncodingPosition &lt; size; ++baseEncodingPosition) {
    baseEncoding += baseAlphabet.<span class="hljs-title function_">charAt</span>(baseValue[baseEncodingPosition])
  }

  <span class="hljs-keyword">return</span> baseEncoding;
}</code></pre>
      </div>
      </section>

      <section class="normative" id="base-decode"><div class="header-wrapper"><h3 id="x3-2-base-decode"><bdi class="secno">3.2 </bdi>Base Decode</h3><a class="self-link" href="#base-decode" aria-label="Permalink for Section 3.2"></a></div>
        

        <p>
The following algorithm specifies how to decode an array of bytes, where each
byte represents a base-encoded value, to a different base representation that
uses a particular base alphabet, such as base-64-url-no-pad or base-58-btc. The
required inputs are the <var>sourceEncoding</var>, <var>sourceBase</var>, and
<var>baseAlphabet</var>. The output is an array of bytes that contains the
base-decoded value. All mathematical operations <em class="rfc2119">MUST</em> be performed using integer
arithmetic. Alternatives to the algorithm provided below <em class="rfc2119">MAY</em> be used as long as
the outputs of the alternative algorithm remain the same.
        </p>

        <ol class="algorithm">
          <li>
Initialize a <var>baseMap</var> mapping by associating each character
in <var>baseAlphabet</var> to its integer position in the
<var>baseAlphabet</var> string.
          </li>
          <li>
Initialize the following variables; <var>sourceOffset</var> to <code>0</code>,
<var>zeroes</var> to <code>0</code>, and <var>decodedLength</var> to <code>0</code>.
          </li>
          <li>
Set <var>zeroes</var> and <var>sourceOffset</var> to the number of leading
<var>baseAlphabet[0]</var> values in <var>sourceEncoding</var>.
          </li>
          <li>
Set <var>decodedBytes</var> to an empty byte array that is the size of the final
base-converted value. Calculate the size of <var>decodedBytes</var>
by dividing log(<var>sourceBase</var>) by log(<code>256</code>) and then multiplying by the
length of <var>sourceEncoding</var> minus the leading zeroes. Add 1 to the value
of size.
          </li>
          <li>
Process each character in <var>sourceEncoding</var> as <var>character</var>
starting at offset <var>sourceOffset</var>:
            <ol class="algorithm">
              <li>
Set the <var>carry</var> value to the integer value in the <var>baseMap</var>
that is associated with <var>character</var>.
              </li>
              <li>
Perform base-decoding by starting at the end of the <var>decodedBytes</var>
array. Initialize an iterator <var>i</var> to <code>0</code>. Set <var>byteOffset</var>
to <var>decodedSize</var> minus <code>1</code>. Perform the following loop as long as,
<var>carry</var> does not equal <code>0</code> or <var>i</var> is less than
<var>decodedLength</var>, and <var>byteOffset</var> does not equal <code>-1</code>:
                <ol class="algorithm">
                  <li>
Add the result of multiplying <var>sourceBase</var> by
<var>decodedBytes</var>[<var>byteOffset</var>] to <var>carry</var>.
                  </li>
                  <li>
Set <var>decodedBytes</var>[<var>byteOffset</var>] to the remainder of
dividing <var>carry</var> by <code>256</code>.
                  </li>
                  <li>
Set <var>carry</var> to <var>carry</var> divided by <code>256</code>, ensuring that integer
division is used to perform the division.
                  </li>
                  <li>
Decrement <var>byteOffset</var> by <code>1</code> and increment <var>i</var> by <code>1</code>.
                  </li>
                </ol>
                </li><li>
Set <var>decodedLength</var> to <var>i</var> and increment
<var>sourceOffset</var> by <code>1</code>.
                </li>
              
            </ol>
          </li>
          <li>
Set the <var>decodedOffset</var> to <var>decodedSize</var> minus
<var>decodedLength</var>. While the <var>decodedOffset</var> does not equal
the <var>decodedSize</var> and
<var>decodedBytes</var>[<var>decodedOffset</var>] equals <code>0</code>, increment
<var>decodedOffset</var> by <code>1</code>. This step skips the leading zeros in the
final base-decoded byte array.
          </li>
          <li>
Set the size of the <var>finalBytes</var> array to <var>zeroes</var> plus,
<var>decodedSize</var> minus <var>decodedOffset</var>. Initialize the first
<var>zeroes</var> bytes in <var>finalBytes</var> to <code>0</code>.
          </li>
          <li>
Starting at an offset equal to the number of <var>zeroes</var> in
<var>finalBytes</var> plus <code>1</code>, copy all bytes in <var>decodedBytes</var>, up
to <var>decodedSize</var>, starting at offset <var>decodedOffset</var> to
<var>finalBytes</var>.
          </li>
        </ol>

        <div class="example" id="example-an-implementation-of-the-general-base-decoding-algorithm-above-in-javascript">
        <div class="marker">
    <a class="self-link" href="#example-an-implementation-of-the-general-base-decoding-algorithm-above-in-javascript">Example<bdi> 18</bdi></a><span class="example-title">: An implementation of the general base-decoding algorithm above in Javascript</span>
  </div> <pre aria-busy="false"><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">baseDecode</span>(<span class="hljs-params">sourceEncoding, sourceBase, baseAlphabet</span>) {
  <span class="hljs-comment">// build the base-alphabet to integer value map</span>
  baseMap = {};
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; baseAlphabet.<span class="hljs-property">length</span>; i++) {
    baseMap[baseAlphabet[i]] = i;
  }

  <span class="hljs-comment">// skip and count zero-byte values in the sourceEncoding</span>
  <span class="hljs-keyword">let</span> sourceOffset = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">let</span> zeroes = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">let</span> decodedLength = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span>(sourceEncoding[sourceOffset] === baseAlphabet[<span class="hljs-number">0</span>]) {
    zeroes++;
    sourceOffset++;
  }

  <span class="hljs-comment">// allocate the decoded byte array</span>
  <span class="hljs-keyword">const</span> baseContractionFactor = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">log</span>(sourceBase) / <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">256</span>);
  <span class="hljs-keyword">let</span> decodedSize = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((
    (sourceEncoding.<span class="hljs-property">length</span> - sourceOffset) * baseContractionFactor) + <span class="hljs-number">1</span>);
  <span class="hljs-keyword">let</span> decodedBytes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(decodedSize);

  <span class="hljs-comment">// perform base-conversion on the source encoding</span>
  <span class="hljs-keyword">while</span>(sourceEncoding[sourceOffset]) {
    <span class="hljs-comment">// process each base-encoded number</span>
    <span class="hljs-keyword">let</span> carry = baseMap[sourceEncoding[sourceOffset]];

    <span class="hljs-comment">// convert the base-encoded number by performing base-expansion</span>
    <span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> byteOffset = decodedSize - <span class="hljs-number">1</span>;
      (carry !== <span class="hljs-number">0</span> || i &lt; decodedLength) &amp;&amp; (byteOffset !== -<span class="hljs-number">1</span>);
      byteOffset--, i++) {
      carry += <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(sourceBase * decodedBytes[byteOffset]);
      decodedBytes[byteOffset] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(carry % <span class="hljs-number">256</span>);
      carry = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(carry / <span class="hljs-number">256</span>);
    }

    decodedLength = i;
    sourceOffset++;
  }

  <span class="hljs-comment">// skip leading zeros in the decoded byte array</span>
  <span class="hljs-keyword">let</span> decodedOffset = decodedSize - decodedLength;
  <span class="hljs-keyword">while</span>(decodedOffset !== decodedSize &amp;&amp; decodedBytes[decodedOffset] === <span class="hljs-number">0</span>) {
    decodedOffset++;
  }

  <span class="hljs-comment">// create the final byte array that has been base-decoded</span>
  <span class="hljs-keyword">let</span> finalBytes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(zeroes + (decodedSize - decodedOffset));
  <span class="hljs-keyword">let</span> j = zeroes;
  <span class="hljs-keyword">while</span>(decodedOffset !== decodedSize) {
    finalBytes[j++] = decodedBytes[decodedOffset++];
  }

  <span class="hljs-keyword">return</span> finalBytes;
}</code></pre>
      </div>

      </section>

      <section class="normative" id="retrieve-verification-method"><div class="header-wrapper"><h3 id="x3-3-retrieve-verification-method"><bdi class="secno">3.3 </bdi>Retrieve Verification Method</h3><a class="self-link" href="#retrieve-verification-method" aria-label="Permalink for Section 3.3"></a></div>
        

        <p>
The following algorithm specifies how to safely retrieve a verification method,
such as a cryptographic <a data-link-type="dfn|abstract-op" href="#dfn-public-key" class="internalDFN" id="ref-for-dfn-public-key-8">public key</a>, by using a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method-identifier" class="internalDFN" id="ref-for-dfn-verification-method-identifier-1">verification method identifier</a>. Required inputs are a <strong><a data-link-type="dfn|abstract-op" href="#dfn-verification-method-identifier" class="internalDFN" id="ref-for-dfn-verification-method-identifier-2">verification method identifier</a></strong> (<var>vmIdentifier</var>), a
<strong><a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-20">verification relationship</a></strong>
(<var>verificationRelationship</var>), and a set of <strong>dereferencing
options</strong> (<var>options</var>). A
<strong><a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-75">verification method</a></strong> is produced as output.
        </p>

        <ol class="algorithm">
          <li>
If <var>vmIdentifier</var> is not a valid URL, an error <em class="rfc2119">MUST</em> be raised and
<em class="rfc2119">SHOULD</em> convey an error type of
<a href="#INVALID_VERIFICATION_METHOD_URL">INVALID_VERIFICATION_METHOD_URL</a>.
          </li>
          <li>
Let <var>controllerDocumentUrl</var> be the result of parsing
<var>vmIdentifier</var> according to the rules of the URL scheme and extracting
the primary resource identifier (without the fragment identifier).
          </li>
          <li>
Let <var>vmFragment</var> be the result of parsing <var>vmIdentifier</var>
according to the rules of the URL scheme and extracting the secondary
resource identifier (the fragment identifier).
          </li>
          <li>
Let <var>controllerDocument</var> be the result of dereferencing
<var>controllerDocumentUrl</var>, according to the rules
of the URL scheme and using the supplied <var>options</var>.
          </li>
          <li>
If <var>controllerDocument</var> is not a <a data-link-type="dfn|abstract-op" href="#dfn-conforming-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-conforming-controlled-identifier-document-2">conforming controlled identifier document</a>,
an error <em class="rfc2119">MUST</em> be raised and <em class="rfc2119">SHOULD</em>
convey an error type of
<a href="#INVALID_CONTROLLER_DOCUMENT">INVALID_CONTROLLER_DOCUMENT</a>.
          </li>
          <li>
If <var>controllerDocument</var>.<var>id</var> does not match the
<var>controllerDocumentUrl</var>, an error <em class="rfc2119">MUST</em> be raised and <em class="rfc2119">SHOULD</em>
convey an error type of
<a href="#INVALID_CONTROLLER_DOCUMENT_ID">INVALID_CONTROLLER_DOCUMENT_ID</a>.
          </li>
          <li>
Let <var>verificationMethod</var> be the result of dereferencing the
<var>vmFragment</var> from the <var>controllerDocument</var> according to the
rules of the media type of the <var>controllerDocument</var>.
          </li>
          <li>
If <var>verificationMethod</var> is not a <a data-link-type="dfn|abstract-op" href="#dfn-conforming-verification-method" class="internalDFN" id="ref-for-dfn-conforming-verification-method-2">conforming verification method</a>,
an error <em class="rfc2119">MUST</em> be raised and <em class="rfc2119">SHOULD</em> convey an error type of
<a href="#INVALID_VERIFICATION_METHOD">INVALID_VERIFICATION_METHOD</a>.
          </li>
          <li>
If the absolute URL value of <var>verificationMethod</var>.<var>id</var>
does not equal <var>vmIdentifier</var>, an error <em class="rfc2119">MUST</em> be raised and <em class="rfc2119">SHOULD</em>
convey an error type of
<a href="#INVALID_VERIFICATION_METHOD">INVALID_VERIFICATION_METHOD</a>.
          </li>
          <li>
If the absolute URL value of <var>verificationMethod</var>.<var>controller</var>
does not equal <var>controllerDocumentUrl</var>, an error <em class="rfc2119">MUST</em> be raised and
<em class="rfc2119">SHOULD</em> convey an error type of
<a href="#INVALID_VERIFICATION_METHOD">INVALID_VERIFICATION_METHOD</a>.
          </li>
          <li>
If <var>verificationMethod</var> is not associated, either by reference
(URL) or by value (object), with the <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-21">verification relationship</a> array in the
<var>controllerDocument</var> identified by <var>verificationRelationship</var>,
an error <em class="rfc2119">MUST</em> be raised and <em class="rfc2119">SHOULD</em> convey an error type of
<a href="#INVALID_RELATIONSHIP_FOR_VERIFICATION_METHOD">
INVALID_RELATIONSHIP_FOR_VERIFICATION_METHOD</a>.
          </li>
          <li>
Return <var>verificationMethod</var> as the
<strong><a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-76">verification method</a></strong>.
          </li>
        </ol>

        <p>
The following example provides a minimum conformant
<a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-50">controlled identifier document</a> containing a minimum conformant
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-77">verification method</a> as required by the algorithm in this section:
        </p>

        <div class="example" id="example-minimum-conformant-controlled-identifier-document">
        <div class="marker">
    <a class="self-link" href="#example-minimum-conformant-controlled-identifier-document">Example<bdi> 19</bdi></a><span class="example-title">: Minimum conformant controlled identifier document</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://controller.example/123"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"verificationMethod"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://controller.example/123#key-456"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ExampleVerificationMethodType"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"controller"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://controller.example/123"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-comment">// public cryptographic material goes here</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"authentication"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"#key-456"</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

        <div class="note" role="note" id="issue-container-generatedID-6"><div role="heading" class="note-title marker" id="h-note-6" aria-level="4"><span>Note</span><span class="issue-label">: Controlled identifier documents can contain references to external verification methods</span></div><p class="">
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method-identifier" class="internalDFN" id="ref-for-dfn-verification-method-identifier-3">Verification method identifiers</a> are expressed as strings that are URLs, or
via the <code>id</code> property, whose value is a URL. It is possible for a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-51">controlled identifier document</a> to express a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-78">verification method</a>, through a <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-22">verification relationship</a>, that exists in a place that is external to the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-52">controlled identifier document</a>. As described in Section <a href="#integrity-protection-of-controllers" data-matched-text="[[[#integrity-protection-of-controllers]]]" class="sec-ref"><bdi class="secno">5.9 </bdi>Integrity Protection of Controllers</a>,
specifying a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-79">verification method</a> that is external to a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-53">controlled identifier document</a> is a valid use of this specification. It is vital that this
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-80">verification method</a> is retrieved from the external <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-54">controlled identifier document</a>.
        </p></div>

        <p>
When retrieving any <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-81">verification method</a> the algorithm above is used to
ensure that the <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-82">verification method</a> is retrieved from the correct
<a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-55">controlled identifier document</a>. The algorithm also ensures that this <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-56">controlled identifier document</a> refers to the <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-83">verification method</a> (via a <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-23">verification relationship</a>) and that the <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-84">verification method</a> refers to the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-57">controlled identifier document</a> (via the <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-85">verification method</a>'s <code>controller</code> property). Failure to
use this algorithm, or an equivalent one that performs these checks, can lead to
security compromises where an attacker poisons a cache by claiming control of a
victim's <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-86">verification method</a>.
        </p>

        <div class="example" id="example-referencing-an-external-verification-method-for-capabilityinvocation">
        <div class="marker">
    <a class="self-link" href="#example-referencing-an-external-verification-method-for-capabilityinvocation">Example<bdi> 20</bdi></a><span class="example-title">: Referencing an external verification method for `capabilityInvocation`</span>
  </div> <pre class="nohighlight">{
  "id": "https://controller.example/123",
  "capabilityInvocation": [<span class="highlight">"https://external.example/xyz#key-789"</span>]
}</pre>
      </div>

        <p>
In the example above, the algorithm described in this section will use the
<code>https://external.example/xyz#key-789</code> URL value as the <a data-link-type="dfn|abstract-op" href="#dfn-verification-method-identifier" class="internalDFN" id="ref-for-dfn-verification-method-identifier-4">verification method identifier</a>. The algorithm will then confirm that the <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-87">verification method</a>
exists in the external <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-58">controlled identifier document</a> and that the appropriate
relationships exist as described earlier in this section.
        </p>

      </section>

      <section class="normative" id="processing-errors"><div class="header-wrapper"><h3 id="x3-4-processing-errors"><bdi class="secno">3.4 </bdi>Processing Errors</h3><a class="self-link" href="#processing-errors" aria-label="Permalink for Section 3.4"></a></div>
        

        <p>
The algorithms described in this specification throw specific types of errors.
Implementers might find it useful to convey these errors to other libraries or
software systems. This section provides specific URLs, descriptions, and error
codes for the errors, such that an ecosystem implementing technologies described
by this specification might interoperate more effectively when errors occur.
        </p>

        <p>
When exposing these errors through an HTTP interface, implementers <em class="rfc2119">SHOULD</em> use
[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9457" title="Problem Details for HTTP APIs">RFC9457</a></cite>] to encode the error data structure. If [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9457" title="Problem Details for HTTP APIs">RFC9457</a></cite>] is used:
        </p>

        <ul>
          <li>
The <code>type</code> value of the error object <em class="rfc2119">MUST</em> be a URL that starts with the value
<code>https://w3id.org/security#</code> and ends with the value in the section listed
below.
          </li>
          <li>
The <code>code</code> value <em class="rfc2119">MUST</em> be the integer code described in the table below
(in parentheses, beside the type name).
          </li>
          <li>
The <code>title</code> value <em class="rfc2119">SHOULD</em> provide a short but specific human-readable string for
the error.
          </li>
          <li>
The <code>detail</code> value <em class="rfc2119">SHOULD</em> provide a longer human-readable string for the error.
          </li>
        </ul>

        <dl>
          <dt id="INVALID_VERIFICATION_METHOD_URL">INVALID_VERIFICATION_METHOD_URL (-21)</dt>
          <dd>
The <code>verificationMethod</code> value in a <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-19">proof</a> was malformed. See Section
<a href="#retrieve-verification-method" data-matched-text="[[[#retrieve-verification-method]]]" class="sec-ref"><bdi class="secno">3.3 </bdi>Retrieve Verification Method</a>.
          </dd>
          <dt id="INVALID_CONTROLLER_DOCUMENT_ID">INVALID_CONTROLLER_DOCUMENT_ID (-22)</dt>
          <dd>
The <code>id</code> value in a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-59">controlled identifier document</a> was malformed. See Section
<a href="#retrieve-verification-method" data-matched-text="[[[#retrieve-verification-method]]]" class="sec-ref"><bdi class="secno">3.3 </bdi>Retrieve Verification Method</a>.
          </dd>
          <dt id="INVALID_CONTROLLER_DOCUMENT">INVALID_CONTROLLER_DOCUMENT (-23)</dt>
          <dd>
The <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-60">controlled identifier document</a> was malformed. See Section
<a href="#retrieve-verification-method" data-matched-text="[[[#retrieve-verification-method]]]" class="sec-ref"><bdi class="secno">3.3 </bdi>Retrieve Verification Method</a>.
          </dd>
          <dt id="INVALID_VERIFICATION_METHOD">INVALID_VERIFICATION_METHOD (-24)</dt>
          <dd>
The <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-88">verification method</a> in a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-61">controlled identifier document</a> was malformed. See Section
<a href="#retrieve-verification-method" data-matched-text="[[[#retrieve-verification-method]]]" class="sec-ref"><bdi class="secno">3.3 </bdi>Retrieve Verification Method</a>.
          </dd>
          <dt id="INVALID_RELATIONSHIP_FOR_VERIFICATION_METHOD">INVALID_RELATIONSHIP_FOR_VERIFICATION_METHOD (-25)</dt>
          <dd>
The <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-89">verification method</a> in a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-62">controlled identifier document</a> was not
associated using the expected <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-24">verification relationship</a> as expressed in
the <code>proofPurpose</code> property in the <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-20">proof</a>. See Section
<a href="#retrieve-verification-method" data-matched-text="[[[#retrieve-verification-method]]]" class="sec-ref"><bdi class="secno">3.3 </bdi>Retrieve Verification Method</a>.
          </dd>
        </dl>
      </section>
    </section>

    <section id="contexts-and-vocabularies"><div class="header-wrapper"><h2 id="x4-contexts-and-vocabularies"><bdi class="secno">4. </bdi>Contexts and Vocabularies</h2><a class="self-link" href="#contexts-and-vocabularies" aria-label="Permalink for Section 4."></a></div>
      

      <div class="issue" id="issue-container-number-3"><div role="heading" class="issue-title marker" id="h-issue-1" aria-level="3"><span>Issue 3</span><span class="issue-label">: (AT RISK) Hash values might change during Candidate Recommendation</span></div><p class="">
        This section lists cryptographic hash values that might change during the
        Candidate Recommendation phase based on implementer feedback that requires
        the referenced files to be modified.
      </p></div>

      <section id="vocabulary"><div class="header-wrapper"><h3 id="x4-1-vocabulary"><bdi class="secno">4.1 </bdi>Vocabulary</h3><a class="self-link" href="#vocabulary" aria-label="Permalink for Section 4.1"></a></div>
        
        <p>
          The terms defined in this specification are also part of the
          RDF <a href="https://www.w3.org/TR/rdf-concepts/#vocabularies">vocabulary namespace</a>&nbsp;[<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-concepts" title="Resource Description Framework (RDF): Concepts and Abstract Syntax">RDF-CONCEPTS</a></cite>]
          <a href="https://w3id.org/security">https://w3id.org/security#</a>.
          For any <code>TERM</code>, the relevant URL is of the form
          <code>https://w3id.org/security#TERM</code> or <code>https://w3id.org/security#TERMmethod</code>.
          Implementations that use RDF processing and rely on this specification <em class="rfc2119">MUST</em> use these URLs.
        </p>

        <p>
          When dereferencing the
          <a href="https://w3id.org/security">https://w3id.org/security#</a> URL,
          the media type of the data that is returned depends on HTTP content negotiation. These are as follows:
        </p>

        <table class="simple">
          <thead>
            <tr>
              <th>Media Type</th>
              <th>Description and Hash</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                application/ld+json
              </td>
              <td>
                The vocabulary in JSON-LD format [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>].<br>

                <strong>SHA2-256 Digest:</strong> <code><span class="vc-hash" data-hash-url="https://w3c.github.io/vc-data-integrity/vocab/security/vocabulary.jsonld" data-hash-format="openssl dgst -sha256">0825e3f71462e105e85ea144e2eb1521c2755e6679bd2eb459a9a796c56b18e8</span></code>
              </td>
            </tr>
            <tr>
              <td>
                text/turtle
              </td>
              <td>
                The vocabulary in Turtle format [<cite><a class="bibref" data-link-type="biblio" href="#bib-turtle" title="RDF 1.1 Turtle">TURTLE</a></cite>].<br>

                <strong>SHA2-256 Digest:</strong> <code><span class="vc-hash" data-hash-url="https://w3c.github.io/vc-data-integrity/vocab/security/vocabulary.ttl" data-hash-format="openssl dgst -sha256">2fefc7e645fdfa34491c772d0e9c2eed9f95cde3b205e4667abe876580be7f7d</span></code>
              </td>
            </tr>
            <tr>
              <td>
                text/html
              </td>
              <td>
                The vocabulary in HTML+RDFa Format [<cite><a class="bibref" data-link-type="biblio" href="#bib-html-rdfa" title="HTML+RDFa 1.1 - Second Edition">HTML-RDFA</a></cite>].<br>


                <strong>SHA2-256 Digest:</strong> <code><span class="vc-hash" data-hash-url="https://w3c.github.io/vc-data-integrity/vocab/security/vocabulary.html" data-hash-format="openssl dgst -sha256">0f989a247fb87f514640f1080ad40713b6c950edeb1d29e8c5b45f647699b3d4</span></code>
              </td>
            </tr>
          </tbody>
        </table>

        <p>
          It is possible to confirm the cryptographic digests above by running
          a command like the following (replacing <code>&lt;MEDIA_TYPE&gt;</code> and <code>&lt;DOCUMENT_URL&gt;</code>
          with the appropriate values) through a modern UNIX-like OS command line interface:
          <code>curl -sL -H "Accept: &lt;MEDIA_TYPE&gt;" &lt;DOCUMENT_URL&gt; | openssl dgst -sha256</code>
        </p>
      </section>

      <section id="json-ld-context"><div class="header-wrapper"><h3 id="x4-2-json-ld-context"><bdi class="secno">4.2 </bdi>JSON-LD context</h3><a class="self-link" href="#json-ld-context" aria-label="Permalink for Section 4.2"></a></div>
        
        <p>
          Implementations that perform JSON-LD processing <em class="rfc2119">MUST</em> treat the following
          JSON-LD context URL as already resolved, where the resolved document matches
          the corresponding hash value below:
        </p>

        <table class="simple">
          <thead>
            <tr><th>Context URL and Hash</th>
          </tr></thead>
          <tbody>
            <tr>
              <td style="white-space: nowrap;">
                <strong>URL:</strong> https://www.w3.org/ns/cid/v1<br>
                <strong>SHA2-256 Digest:</strong><br> <code><span class="vc-hash" data-hash-url="https://w3c.github.io/cid/context/v1.jsonld" data-hash-format="openssl dgst -sha256">ea216ecc1cb02cd39b693dba2250141e270ba0bf95890be107dd9a9e8e43de85</span></code>
              </td>
            </tr>
          </tbody>
        </table>

        <p>
          It is possible to confirm the cryptographic digests listed above by running a
          command like the following through a modern UNIX-like OS command line interface: <code>curl -sL -H
          "Accept: application/ld+json" https://www.w3.org/ns/cid/v1 | openssl dgst -sha256</code>
        </p>

        <p>
          The security vocabulary terms that the JSON-LD contexts listed above resolve
          to are in the <a href="https://w3id.org/security">https://w3id.org/security#</a>
          namespace. See also <a href="#vocabulary" data-matched-text="[[[#vocabulary]]]" class="sec-ref"><bdi class="secno">4.1 </bdi>Vocabulary</a> for further details.
        </p>

        <div class="note" role="note" id="issue-container-generatedID-7"><div role="heading" class="note-title marker" id="h-note-7" aria-level="4"><span>Note</span></div><p class="">
          Applications or specifications may define mappings to the
          vocabulary URLs using their own JSON-LD contexts. For example, these mappings are part
          of the <code>https://w3id.org/security/data-integrity/v2</code> context,
          defined by the <cite><a data-matched-text="[[[?VC-DATA-INTEGRITY]]]" href="https://www.w3.org/TR/vc-data-integrity/">Verifiable Credential Data Integrity 1.0</a></cite> specification, or the <code>https://www.w3.org/ns/did/v1</code> context,
          defined by the <cite><a data-matched-text="[[[?DID-CORE]]]" href="https://www.w3.org/TR/did-core/">Decentralized Identifiers (DIDs) v1.0</a></cite> specification.
        </p></div>

        <section id="context-injection"><div class="header-wrapper"><h4 id="x4-2-1-context-injection"><bdi class="secno">4.2.1 </bdi>Context Injection</h4><a class="self-link" href="#context-injection" aria-label="Permalink for Section 4.2.1"></a></div>
          
          <p>
The <code>@context</code> property is used to ensure that implementations are using the
same semantics when terms in this specification are processed. For example, this
can be important when properties like <code>authentication</code> are processed and its
value, such as <code>Multikey</code> or <code>JsonWebKey</code>, are used.
          </p>

          <p>
When an application is processing a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-63">controlled identifier document</a>, if an <code>@context</code>
property is not provided in the document or the terms used in the document are
not mapped by existing values in the <code>@context</code> property, implementations <em class="rfc2119">MUST</em>
inject or append an <code>@context</code> property with a value of
<code>https://www.w3.org/ns/cid/v1</code> or one or more contexts with at least the
same declarations, such as the Decentralized Identifier v1.1 context
(<code>https://www.w3.org/ns/did/v1</code>).
          </p>

          <div class="example" id="example-a-controlled-identifier-document-without-an-context-property">
        <div class="marker">
    <a class="self-link" href="#example-a-controlled-identifier-document-without-an-context-property">Example<bdi> 21</bdi></a><span class="example-title">: A controlled identifier document without an @context property</span>
  </div> <pre class="nohighlight">{
  "id": "https://controller.example/101",
  "verificationMethod": [{
    "id": "https://controller.example/101#key-203947",
    "type": "JsonWebKey",
    "controller": "https://controller.example/101",
    "publicKeyJwk": {
      "kid": "key-203947",
      "kty": "EC",
      "crv": "P-256",
      "alg": "ES256",
      "x": "f83OJ3D2xF1Bg8vub9tLe1gHMzV76e8Tus9uPHvRVEU",
      "y": "x_FEzRu9m36HLN_tue659LNpXW6pCyStikYjKIWI5a0"
    }
  }],
  "authentication": ["#key-203947"]
}</pre>
      </div>

          <p>
Implementations that do not intend to use JSON-LD <em class="rfc2119">MAY</em> choose to not include an
<code>@context</code> declaration at the top-level of the document. Whether or not the
<code>@context</code> value or JSON-LD processors are used, the semantics for all properties
and values expressed in <a data-link-type="dfn|abstract-op" href="#dfn-conforming-document" class="internalDFN" id="ref-for-dfn-conforming-document-3">conforming documents</a> interpreted by <a data-link-type="dfn|abstract-op" href="#dfn-conforming-processor" class="internalDFN" id="ref-for-dfn-conforming-processor-1">conforming processors</a> are the same. Any differences in semantics between documents
processed in either mode are either implementation or specification bugs.
          </p>

        </section>
      </section>

      <section id="datatypes"><div class="header-wrapper"><h3 id="x4-3-datatypes"><bdi class="secno">4.3 </bdi>Datatypes</h3><a class="self-link" href="#datatypes" aria-label="Permalink for Section 4.3"></a></div>
        

        <p>
This section defines datatypes that are used by this specification.
        </p>

      <section id="the-multibase-datatype"><div class="header-wrapper"><h4 id="multibase"><bdi class="secno">4.3.1 </bdi>The <code>multibase</code> Datatype</h4><a class="self-link" href="#multibase" aria-label="Permalink for Section 4.3.1"></a></div>
        

        <p>
<a href="#multibase-0">Multibase</a>-encoded strings are used to encode binary
data into printable formats, such as ASCII, which are useful in environments
that cannot directly represent binary values. This specification makes use of
this encoding. In environments that support data types for string values, such
as RDF [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-concepts" title="Resource Description Framework (RDF): Concepts and Abstract Syntax">RDF-CONCEPTS</a></cite>], <a href="#multibase-0">Multibase</a>-encoded content
is indicated using a literal value whose datatype is set to
<code>https://w3id.org/security#multibase</code>.
        </p>

        <p>
The <code>multibase</code> datatype is defined as follows:
        </p>

        <dl>
          <dt>The URL denoting this datatype</dt>
          <dd>
<code>https://w3id.org/security#multibase</code>
          </dd>
          <dt>The lexical space</dt>
          <dd>
Any string that starts with a <a data-link-type="dfn|abstract-op" href="#dfn-multibase-header" class="internalDFN" id="ref-for-dfn-multibase-header-1">Multibase header</a> and the rest of the
characters consist of allowable characters in the respective base-encoding
alphabet.
          </dd>
          <dt>The value space</dt>
          <dd>
The standard mathematical concept of all integer numbers.
          </dd>
          <dt>The lexical-to-value mapping</dt>
          <dd>
Any element of the lexical space is mapped to the value space by base-decoding
the value based on the base-decoding alphabet associated with the first
<a data-link-type="dfn|abstract-op" href="#dfn-multibase-header" class="internalDFN" id="ref-for-dfn-multibase-header-2">Multibase header</a> in the lexical string.
          </dd>
          <dt>The canonical mapping</dt>
          <dd>
The canonical mapping consists of using the lexical-to-value mapping.
          </dd>
        </dl>
      </section>

    </section>

  </section>

  <section class="informative" id="security-considerations"><div class="header-wrapper"><h2 id="x5-security-considerations"><bdi class="secno">5. </bdi>Security Considerations</h2><a class="self-link" href="#security-considerations" aria-label="Permalink for Section 5."></a></div><p><em>This section is non-normative.</em></p>
    

    <p>
This section contains a variety of security considerations that people using
this specification are advised to consider before deploying this
technology in a production setting. This technologies described in this
document are designed to operate under the threat model used by many IETF
standards and documented in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3552" title="Guidelines for Writing RFC Text on Security Considerations">RFC3552</a></cite>]. This section elaborates upon a number
of the considerations in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3552" title="Guidelines for Writing RFC Text on Security Considerations">RFC3552</a></cite>], as well as other considerations that are
unique to this specification.
    </p>

    <section id="proving-control-and-binding"><div class="header-wrapper"><h3 id="x5-1-proving-control-and-binding"><bdi class="secno">5.1 </bdi>Proving Control and Binding</h3><a class="self-link" href="#proving-control-and-binding" aria-label="Permalink for Section 5.1"></a></div>
      

      <p>
Binding an entity in the digital world or the physical world to an identifier, to
a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-64">controlled identifier document</a>, or to cryptographic material requires the use of
security protocols contemplated by this specification. The following sections
describe some possible scenarios and how an entity therein might prove control
over an identifier or a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-65">controlled identifier document</a> for the purposes of authentication or
authorization.
      </p>

      <section id="proving-control-of-an-identifier-and-or-controller-document"><div class="header-wrapper"><h4 id="x5-1-1-proving-control-of-an-identifier-and-or-controller-document"><bdi class="secno">5.1.1 </bdi>Proving Control of an Identifier and/or Controller Document</h4><a class="self-link" href="#proving-control-of-an-identifier-and-or-controller-document" aria-label="Permalink for Section 5.1.1"></a></div>
        

        <p>
Proving control over an identifier and/or a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-66">controlled identifier document</a> is useful
when accessing remote systems. Cryptographic digital signatures enable certain
security protocols related to <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-67">controlled identifier documents</a>
to be cryptographically verifiable. For these purposes, this specification
defines useful <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-25">verification relationships</a> in <a href="#authentication" class="sec-ref"><bdi class="secno">2.3.1 </bdi>Authentication</a> and <a href="#capability-invocation" data-matched-text="[[[#capability-invocation]]]" class="sec-ref"><bdi class="secno">2.3.4 </bdi>Capability Invocation</a>. The
secret cryptographic material associated with the <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-90">verification methods</a>
can be used to generate a cryptographic digital signature as a part of an
authentication or authorization security protocol.
        </p>
      </section>

      <section id="binding-to-physical-identity"><div class="header-wrapper"><h4 id="x5-1-2-binding-to-physical-identity"><bdi class="secno">5.1.2 </bdi>Binding to Physical Identity</h4><a class="self-link" href="#binding-to-physical-identity" aria-label="Permalink for Section 5.1.2"></a></div>
        

        <p>
An identifier or <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-68">controlled identifier document</a> do not inherently carry any
<a href="https://en.wikipedia.org/wiki/Personal_data">personal data</a> and
it is strongly advised that non-public entities do not publish personal data in
<a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-69">controlled identifier documents</a>.
        </p>

        <p>
It can be useful to express a binding of an identifier to a person's or
organization's physical identity in a way that is provably asserted by a
trusted authority, such as a government. This specification provides
the <a href="#assertion" data-matched-text="[[[#assertion]]]" class="sec-ref"><bdi class="secno">2.3.2 </bdi>Assertion</a> <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-26">verification relationship</a> for these
purposes. This feature can enable interactions that are private and can be
considered legally enforceable under one or more jurisdictions; establishing
such bindings has to be carefully balanced against privacy considerations (see
<a href="#privacy-considerations" data-matched-text="[[[#privacy-considerations]]]" class="sec-ref"><bdi class="secno">6. </bdi>Privacy Considerations</a>).
        </p>

        <p>
The process of binding an identifier to something in the physical world, such as
a person or an organization — for example, by using <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable
credentials</a> with the same subject as that identifier — is contemplated
by this specification and further defined in <cite><a data-matched-text="[[[?VC-DATA-MODEL-2.0]]]" href="https://www.w3.org/TR/vc-data-model-2.0/">Verifiable Credentials Data Model v2.0</a></cite>.
        </p>
      </section>
    </section>
    <section id="identifier-ambiguity"><div class="header-wrapper"><h3 id="x5-2-identifier-ambiguity"><bdi class="secno">5.2 </bdi>Identifier Ambiguity</h3><a class="self-link" href="#identifier-ambiguity" aria-label="Permalink for Section 5.2"></a></div>
      
        <p>
Even in cases where the <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-17">subject</a> referred to by an <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-19">identifier</a> proves
control, the interpretation of the <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-18">subject</a> remains contextual and
potentially ambiguous.
        </p>

        <p>
For example, a school might issue a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> about the teacher
of <strong>Intro to Computer Science</strong>, using
<code>https://controller.example/abc</code> as a <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-19">subject</a> <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-20">identifier</a>, saying
"<code>https://controller.example/abc</code> is the teacher of
<strong>Intro to Computer Science</strong>" and
"<code>https://controller.example/abc</code> controls access to the school's computer lab.
See them to request access".
        </p>

        <p>
In this usage, it is ambiguous whether <code>https://controller.example/abc</code> refers
to a specific teacher or to whomever is the current teacher. Only with further
statements might we be able to discern the difference. But it's still tricky.
For example the subject in the following statement remains ambiguous:
        </p>

        <div class="example" id="example-statement-about-the-name-of-https-controller-example-abc-as-rdf-triples">
        <div class="marker">
    <a class="self-link" href="#example-statement-about-the-name-of-https-controller-example-abc-as-rdf-triples">Example<bdi> 22</bdi></a><span class="example-title">: Statement about the name of https://controller.example/abc as RDF Triples</span>
  </div> <pre class="nohighlight">&lt;https://controller.example/abc&gt;
  &lt;https://schema.org/name&gt;
    "Bob Smith" .</pre>
      </div>

        <p>
If <code>https://controller.example/abc</code> refers to a specific human being, then the
statement is taken as an attestation about the particular human identified by
that name. However, if <code>https://controller.example/abc</code> is used to refer to the
_current_ teacher, it is also valid <em>if the current teacher does have that
name</em>. In this case, the ambiguity is immaterial.
        </p>

        <p>
However, in a statement like the following, the difference becomes vital.
        </p>

        <div class="example" id="example-legal-statements-the-convicted-status-of-https-controller-example-abc-as-rdf-triples">
        <div class="marker">
    <a class="self-link" href="#example-legal-statements-the-convicted-status-of-https-controller-example-abc-as-rdf-triples">Example<bdi> 23</bdi></a><span class="example-title">: Legal statements the convicted status of https://controller.example/abc as RDF Triples</span>
  </div> <pre class="nohighlight">&lt;https://controller.example/abc&gt;
  &lt;http://law.example/convicted&gt;
    &lt;http://calaw.example/PenalCode647b&gt; .</pre>
      </div>

        <p>
The statement in English could be "The person referred to by
<code>https://controller.example/abc</code> has been convicted of California Penal Code
647b." But which person(s) did we mean? Did we mean to say one, some, or all of
the teachers of computer science at the school have been convicted of violating
<code>PenalCode647b</code>? Or is it meant to say that a particular individual teacher,
perhaps the one named "Bob Smith", has been convicted of said crime?
        </p>

        <p>
The challenge is particularly difficult in situations where the <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-20">subject</a> is
fundamentally uninvolved in the issuance of the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>.
For example, an <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-21">identifier</a> might be used by a school to refer to a teacher,
and students and or parents might use that <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-22">identifier</a> to make statements
about the teacher, with neither the teacher nor the school involved. In these
cases, it is easy to imagine that the subtle nuance of the school's intended
meaning, for example, "any current teacher of the computer science class", gets
lost and the <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-23">identifier</a> gets misused by parents and students to refer to a
specific teacher, quite likely in contexts where neither the school nor the
teacher is aware of the conversation.
        </p>
        <p>
In natural language, these ambiguities are often easily ignored or corrected. In
digital media, it is vital that context be evaluated to establish the intended
referent, especially when <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-24">identifiers</a> are used in different contexts by
different <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuers</a>, for example, on an official school website by the school,
but in an unofficial social networking app by parents and students.
        </p>
        <p>
In short, the context in which <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-25">identifiers</a> are created and used has to be
considered when relying on any particular interpretation of the <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-21">subject</a> of
any particular <a data-link-type="dfn|abstract-op" href="#dfn-identifier" class="internalDFN" id="ref-for-dfn-identifier-26">identifier</a>.
        </p>
    </section>

    <section id="key-and-signature-expiration"><div class="header-wrapper"><h3 id="x5-3-key-and-signature-expiration"><bdi class="secno">5.3 </bdi>Key and Signature Expiration</h3><a class="self-link" href="#key-and-signature-expiration" aria-label="Permalink for Section 5.3"></a></div>
      

      <p>
In a decentralized architecture, there might not be centralized authorities to
enforce cryptographic material or cryptographic digital signature expiration
policies. Therefore, it is with supporting software such as verification
libraries that requesting parties validate that cryptographic materials were not
expired at the time they were used. Requesting parties might employ their own
expiration policies in addition to inputs into their verification processes. For
example, some requesting parties might accept authentications from five minutes
in the past, while others with access to high precision time sources might
require authentications to be time stamped within the last 500 milliseconds.
      </p>
      <p>
There are some requesting parties that have legitimate needs to extend the use
of already-expired cryptographic material, such as verifying legacy
cryptographic digital signatures. In these scenarios, a requesting party might
instruct their verification software to ignore cryptographic key material
expiration or determine if the cryptographic key material was expired at the
time it was used.
      </p>
    </section>

    <section id="verification-method-rotation"><div class="header-wrapper"><h3 id="x5-4-verification-method-rotation"><bdi class="secno">5.4 </bdi>Verification Method Rotation</h3><a class="self-link" href="#verification-method-rotation" aria-label="Permalink for Section 5.4"></a></div>
      

      <p>
Rotation is a management process that enables the secret cryptographic material
associated with an existing <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-91">verification method</a> to be deactivated or
destroyed once a new <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-92">verification method</a> has been added to the
<a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-70">controlled identifier document</a>. Going forward, any new <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-21">proofs</a> that a
<a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-37">controller</a> would have generated using the old secret cryptographic
material can now instead be generated using the new  cryptographic material and
can be verified using the new <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-93">verification method</a>.
      </p>

      <p>
Rotation is a useful mechanism for protecting against verification method
compromise, since frequent rotation of a verification method by the controller
reduces the value of a single compromised verification method to an attacker.
Performing revocation immediately after rotation is useful for verification
methods that a controller designates for short-lived verifications, such as
those involved in encrypting messages and authentication.
      </p>

      <p>
The following considerations might be of use when contemplating the use of
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-94">verification method</a> rotation:
      </p>

      <ul>
        <li>
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-95">Verification method</a> rotation is a proactive security measure.
        </li>
        <li>
It is generally considered a best practice to perform <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-96">verification method</a>
rotation on a regular basis.
        </li>
        <li>
Higher security environments tend to employ more frequent verification method
rotation.
        </li>
        <li>
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-97">Verification method</a> rotation manifests only as changes to the current or
latest version of a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-71">controlled identifier document</a>.
        </li>
        <li>
When a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-98">verification method</a> has been active for a long time, or used for
many operations, a controller might wish to perform a rotation.
        </li>
        <li>
Frequent rotation of a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-99">verification method</a> might be frustrating for
parties that are forced to continuously renew or refresh associated credentials.
        </li>
        <li>
Proofs or signatures that rely on <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-100">verification methods</a> that are not
present in the latest version of a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-72">controlled identifier document</a> are not impacted by
rotation. In these cases, verification software might require additional
information, such as when a particular <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-101">verification method</a> was
expected to be valid as well as access to a verifiable data registry
containing a historical record, to determine the validity of the <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-22">proof</a> or
signature. This option might not be available in all systems.
        </li>
        <li>
A <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-38">controller</a> performs a rotation when it adds a new <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-102">verification
method</a> that is meant to replace an existing <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-103">verification method</a> after
some time.
        </li>
      </ul>
    </section>

    <section id="verification-method-revocation"><div class="header-wrapper"><h3 id="x5-5-verification-method-revocation"><bdi class="secno">5.5 </bdi>Verification Method Revocation</h3><a class="self-link" href="#verification-method-revocation" aria-label="Permalink for Section 5.5"></a></div>
      

      <p>
Revocation is a management process that enables the secret cryptographic
material associated with an existing <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-104">verification method</a> to be
deactivated such that it ceases to be a valid form of creating new
proofs.
      </p>
      <p>
Revocation is a useful mechanism for reacting to a verification method
compromise. Performing revocation immediately after rotation is useful for
verification methods that a controller designates for short-lived verifications,
such as those involved in encrypting messages and authentication.
      </p>

      <p>
Compromise of the secrets associated with a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-105">verification method</a> allows
the attacker to use them according to the <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-27">verification relationship</a>
expressed by <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-39">controller</a> in the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-73">controlled identifier document</a>, for example, for
authentication. The attacker's use of the secrets might be indistinguishable
from the legitimate <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-40">controller</a>'s use starting from
the time the <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-106">verification method</a> was registered, to the time it was
revoked.
      </p>


      <p>
The following considerations might be of use when contemplating the use of
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-107">verification method</a> revocation:
      </p>

      <ul>
        <li>
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-108">Verification method</a> revocation is a reactive security measure.
        </li>

        <li>
It is considered a best practice to support key revocation.
        </li>

        <li>
A <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-41">controller</a> is expected to immediately revoke any <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-109">verification
method</a> that is known to be compromised.
        </li>

        <li>
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-110">Verification method</a> revocation can only be embodied in changes to
the latest version of a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-74">controlled identifier document</a>; it cannot retroactively adjust
previous versions.
        </li>

        <li>
If a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-111">verification method</a> is no longer exclusively accessible to the
<a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-42">controller</a> or parties trusted to act on behalf of the <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-43">controller</a>,
it is expected to be revoked immediately to reduce the risk of
compromises such as masquerading, theft, and fraud.
        </li>

        <li>
Revocation is expected to be understood as a <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-44">controller</a> expressing that
proofs or signatures associated with a revoked <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-112">verification method</a>
created after its revocation should be treated as invalid. It could also imply a
concern that existing <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-23">proofs</a> or signatures might have been created by an
attacker, but this is not necessarily the case. Verifiers, however, might still
choose to accept or reject any such <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-24">proofs</a> or signatures at their own
discretion.
        </li>

        <li>
Even if a <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-113">verification method</a> is present in a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-75">controlled identifier document</a>,
additional information, such as a public key revocation certificate, or an
external allow or deny list, could be used to determine whether a
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-114">verification method</a> has been revoked.
        </li>

        <li>
The day-to-day operation of any software relying on a compromised
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-115">verification method</a>, such as an individual's operating system, antivirus,
or endpoint protection software, could be impacted when the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-116">verification
method</a> is publicly revoked.
        </li>
      </ul>

      <section id="revocation-semantics"><div class="header-wrapper"><h4 id="x5-5-1-revocation-semantics"><bdi class="secno">5.5.1 </bdi>Revocation Semantics</h4><a class="self-link" href="#revocation-semantics" aria-label="Permalink for Section 5.5.1"></a></div>
        

        <p>
Although verifiers might choose not to accept <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-25">proofs</a> or signatures from a
revoked verification method, knowing whether a verification was made with a
revoked <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-117">verification method</a> is trickier than it might seem. Some auditing
systems provide the ability to look back at the state of an identifier at a
point in time, or at a particular version of the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-76">controlled identifier document</a>.
When such a feature is combined with a reliable way to determine the time or
identifier version that existed when a cryptographically verifiable statement
was made, then revocation does not undo that statement. This can be the basis
for using digital signatures to make binding commitments; for example, to sign
a mortgage.
        </p>
        <p>
If these conditions are met, revocation is not retroactive; it only nullifies
future use of the method.
        </p>
        <p>
However, in order for such semantics to be safe, the second condition — an
ability to know what the state of the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-77">controlled identifier document</a> was at the time
the assertion was made — is expected to apply. Without that guarantee,
someone could discover a revoked key and use it to make cryptographically
verifiable statements with a simulated date in the past.
        </p>
        <p>
Some auditing systems only allow the retrieval of the current state of a
identifier. When this is true, or when the state of an identifier at the time of
a cryptographically verifiable statement cannot be reliably determined, then the
only safe course is to disallow any consideration of state with respect to time,
except the present moment. Identifier ecosystems that take this approach
essentially provide cryptographically verifiable statements as ephemeral tokens
that can be invalidated at any time by the <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-45">controller</a>.
        </p>
      </section>
    </section>

    <section id="choosing-a-multiformat"><div class="header-wrapper"><h3 id="x5-6-choosing-a-multiformat"><bdi class="secno">5.6 </bdi>Choosing a Multiformat</h3><a class="self-link" href="#choosing-a-multiformat" aria-label="Permalink for Section 5.6"></a></div>
      

      <p>
<dfn class="external lint-ignore" id="dfn-multiformats" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Multiformats</dfn> enable self-describing
data; if data is known to be a Multiformat, its exact type can be determined by
reading a few compact header bytes that are expressed at the beginning of the
data. <a href="#multibase-0">Multibase</a>, <a href="#multihash">Multihash</a>,
and <a href="#Multikey">Multikey</a> are types of Multiformats that are defined
by this specification.
      </p>

      <p>
The Multiformats specifications exist because application developers
appropriately choose different base-encoding functions, cryptographic
hashing functions, and cryptographic key formats, among other things,
based on different use cases and their requirements. No single
base-encoding function, cryptographic hashing function, or cryptographic
key format in the world has ever satisfied all requirement sets.
Multiformats provides an alternative means by which to encode and/or
detect any base-encoding, cryptographic hash, or cryptographic key
format in self-documenting data and documents.
      </p>

      <p>
To increase interoperability, specification authors are urged to minimize
the number of Multiformats — optimally, choosing only one — to
be used for any particular application or ecosystem.
      </p>

    </section>

    <section id="encrypted-data-in-controller-documents"><div class="header-wrapper"><h3 id="x5-7-encrypted-data-in-controller-documents"><bdi class="secno">5.7 </bdi>Encrypted Data in Controller Documents</h3><a class="self-link" href="#encrypted-data-in-controller-documents" aria-label="Permalink for Section 5.7"></a></div>
      
      <p>
Encryption algorithms have been known to fail due to advances in cryptography
and computing power. Implementers are advised to assume that any encrypted data
placed in a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-78">controlled identifier document</a> might eventually be made available in clear text
to the same audience to which the encrypted data is available. This is
particularly pertinent if the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-79">controlled identifier document</a> is public.
      </p>
      <p>
Encrypting all or parts of a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-80">controlled identifier document</a> is <em>not</em> an appropriate
means to protect data in the long term. Similarly, placing encrypted data in
a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-81">controlled identifier document</a> is not an appropriate means to protect personal data.
      </p>
      <p>
Given the caveats above, if encrypted data is included in a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-82">controlled identifier document</a>,
implementers are advised to not associate any correlatable information
that could be used to infer a relationship between the encrypted data
and an associated party. Examples of correlatable information include
public keys of a receiving party, identifiers to digital assets known to be
under the control of a receiving party, or human readable descriptions of a
receiving party.
      </p>

    </section>

    <section id="content-integrity-protection"><div class="header-wrapper"><h3 id="x5-8-content-integrity-protection"><bdi class="secno">5.8 </bdi>Content Integrity Protection</h3><a class="self-link" href="#content-integrity-protection" aria-label="Permalink for Section 5.8"></a></div>
      
      <p>
<a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-83">Controlled identifier documents</a> that include links to external machine-readable
content such as images, web pages, or schemas are vulnerable to tampering. It is
strongly advised that external links are integrity protected using mechanisms to
secure related resources such as those described in the <cite><a data-matched-text="[[[?VC-DATA-MODEL-2.0]]]" href="https://www.w3.org/TR/vc-data-model-2.0/">Verifiable Credentials Data Model v2.0</a></cite>
specification. External links are to be avoided if they cannot be integrity
protected and the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-84">controlled identifier document</a>'s integrity is dependent on the
external link.
      </p>
      <p>
One example of an external link where the integrity of the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-85">controlled identifier document</a> itself could be affected is the JSON-LD Context [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>],
when present. To protect against compromise,
<a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-86">controlled identifier document</a> consumers using JSON-LD are advised to cache
local static copies of JSON-LD contexts and/or verify the integrity of external
contexts against a cryptographic hash that is known to be associated with a safe
version of the external JSON-LD Context.
      </p>
    </section>

    <section id="integrity-protection-of-controllers"><div class="header-wrapper"><h3 id="x5-9-integrity-protection-of-controllers"><bdi class="secno">5.9 </bdi>Integrity Protection of Controllers</h3><a class="self-link" href="#integrity-protection-of-controllers" aria-label="Permalink for Section 5.9"></a></div>
      

      <p>
As described in Section <a href="#controllers" data-matched-text="[[[#controllers]]]" class="sec-ref"><bdi class="secno">2.1.2 </bdi>Controllers</a>, this specification includes a
mechanism by which to delegate change control of a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-87">controlled identifier document</a> to
an entity that is described in an external <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-88">controlled identifier document</a> through the
use of the <code>controller</code> property.
      </p>

      <p>
Delegating change control addresses a number of use cases including those
where the care of an entity is the responsibility of some other entity or
entities, as well as those where some entity desires that another entity
provide account recovery services, among other use cases. In such scenarios,
it can be beneficial to allow the guardian to manage the rotation of their
own key material. It can also be beneficial for the delegator to associate
a cryptographic hash of the remote <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-89">controlled identifier document</a> to "pin" the
remote document to a known good value.
      </p>

      <p>
While this document does not specify a particular mechanism for
cryptographically protected URLs, the <code>relatedResource</code> property in
<cite><a data-matched-text="[[[VC-DATA-MODEL-2.0]]]" href="https://www.w3.org/TR/vc-data-model-2.0/">Verifiable Credentials Data Model v2.0</a></cite> and the <code>digestMultibase</code> property in
<cite><a data-matched-text="[[[VC-DATA-INTEGRITY]]]" href="https://www.w3.org/TR/vc-data-integrity/">Verifiable Credential Data Integrity 1.0</a></cite> could be employed by a mechanism that can provide
such protection.
      </p>

    </section>

    <section id="level-of-assurance"><div class="header-wrapper"><h3 id="x5-10-level-of-assurance"><bdi class="secno">5.10 </bdi>Level of Assurance</h3><a class="self-link" href="#level-of-assurance" aria-label="Permalink for Section 5.10"></a></div>
      

      <p>
Additional information about the security context of authentication events is
often required for compliance reasons, especially in regulated areas such as the
financial and public sectors. This information is often referred to as a Level
of Assurance (LOA). Examples include the protection of secret cryptographic
material, the identity <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-26">proof</a>ing process, and the form-factor of the
authenticator.
      </p>

      <p>
<a target="_blank" href="https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=celex%3A32015L2366">
Payment services (PSD 2)</a> and <a target="_blank" href="https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=uriserv:OJ.L_.2014.257.01.0073.01.ENG">
eIDAS</a> introduce such requirements to the security context. Level of
assurance frameworks are classified and defined by regulations and
standards such as <a target="_blank" href="https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=uriserv:OJ.L_.2014.257.01.0073.01.ENG">
eIDAS</a>, <a target="_blank" href="https://pages.nist.gov/800-63-3/sp800-63-3.html"> NIST 800-63-3</a> and <a target="_blank" href="https://www.iso.org/standard/45138.html"> ISO/IEC
29115:2013</a>, including their requirements for the security context, and
making recommendations on how to achieve them. This might include strong user
authentication where <a target="_blank" href="https://fidoalliance.org/fido2/">FIDO2</a>/<a target="_blank" href="https://www.w3.org/TR/webauthn-2/">WebAuthn</a> can fulfill the
requirement.
      </p>

      <p>
Some regulated scenarios require the implementation of a specific level of
assurance. Since <a data-link-type="dfn|abstract-op" href="#dfn-verification-relationship" class="internalDFN" id="ref-for-dfn-verification-relationship-28">verification relationships</a> used to perform
<a href="#assertion">assertion</a> and <a data-link-type="dfn|abstract-op" href="#dfn-authenticated" class="internalDFN" id="ref-for-dfn-authenticated-12">authentication</a> might be
used in some of these situations, information about the applied security context
might need to be expressed and provided to a <em>verifier</em>. Whether and how
to encode this information in the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-90">controlled identifier document</a> data model is out
of scope for this specification. Interested readers might note that 1) the
information could be transmitted using Verifiable Credentials
[<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-model-2.0" title="Verifiable Credentials Data Model v2.0">VC-DATA-MODEL-2.0</a></cite>], and 2) the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-91">controlled identifier document</a> data model can be
extended to incorporate this information.
      </p>
    </section>

    <section id="service-endpoints-for-authentication-and-authorization"><div class="header-wrapper"><h3 id="x5-11-service-endpoints-for-authentication-and-authorization"><bdi class="secno">5.11 </bdi>Service Endpoints for Authentication and Authorization</h3><a class="self-link" href="#service-endpoints-for-authentication-and-authorization" aria-label="Permalink for Section 5.11"></a></div>
      

      <p>
If a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-92">controlled identifier document</a> publishes a <a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-14">service</a> intended for authentication
or authorization of the <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-22">subject</a> (see Section <a href="#services" data-matched-text="[[[#services]]]" class="sec-ref"><bdi class="secno">2.1.4 </bdi>Services</a>), it is the
responsibility of the <a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-15">service</a> provider, <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-23">subject</a>, and/or requesting party
to comply with the requirements of the authentication and/or authorization
protocols supported by that <a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-16">service</a> endpoint.
      </p>
    </section>

  </section>

  <section class="informative" id="privacy-considerations"><div class="header-wrapper"><h2 id="x6-privacy-considerations"><bdi class="secno">6. </bdi>Privacy Considerations</h2><a class="self-link" href="#privacy-considerations" aria-label="Permalink for Section 6."></a></div><p><em>This section is non-normative.</em></p>
    

    <p>
Since <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-93">controlled identifier documents</a> are designed to be administered directly by
the <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-46">controller</a>, it is critically important to apply the principles of
Privacy by Design [<cite><a class="bibref" data-link-type="biblio" href="#bib-privacy-by-design" title="Privacy by Design">PRIVACY-BY-DESIGN</a></cite>] to all aspects of the
<a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-94">controlled identifier document</a>. All seven of these principles have been applied
throughout the development of this specification. The design used in this
specification does not assume that there is a registrar, hosting company, nor
other intermediate service provider to recommend or apply additional privacy
safeguards. Privacy in this specification is preventive, not remedial, and is an
embedded default. The following sections cover privacy considerations that
implementers might find useful when building systems that utilize <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-95">controlled identifier documents</a>.
    </p>

    <section id="keep-personal-data-private"><div class="header-wrapper"><h3 id="x6-1-keep-personal-data-private"><bdi class="secno">6.1 </bdi>Keep Personal Data Private</h3><a class="self-link" href="#keep-personal-data-private" aria-label="Permalink for Section 6.1"></a></div>
      

      <p>
If a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-96">controlled identifier document</a> is about a specific individual and is
public-facing, it is <em>critical</em> that <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-97">controlled identifier documents</a> contain
no personal biometric or biographical data. While it is true that personal data
might include pseudonymous information, such as a public cryptographic key or an IP address,
publishing that sort of information does not create the same immediate privacy
dangers as publishing an individual's full name, profile photo, or social media
account in a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-98">controlled identifier document</a>. A better alternative is to transmit
such personal data through other means such as verifiable credentials
[<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-model-2.0" title="Verifiable Credentials Data Model v2.0">VC-DATA-MODEL-2.0</a></cite>] or other data formats sent over private and secure
communication channels.
      </p>
    </section>

    <section id="relationship-to-the-same-origin-policy"><div class="header-wrapper"><h3 id="x6-2-relationship-to-the-same-origin-policy"><bdi class="secno">6.2 </bdi>Relationship to the Same-Origin Policy</h3><a class="self-link" href="#relationship-to-the-same-origin-policy" aria-label="Permalink for Section 6.2"></a></div>
      

      <p>
The <a href="https://en.wikipedia.org/wiki/Same-origin_policy">
Same-origin policy</a> is a security and privacy concept that constrains
information to the same Web domain by default. There are mechanisms, such as
<cite><a data-matched-text="[[[?WEBAUTHN]]]" href="https://www.w3.org/TR/webauthn-1/">Web Authentication:An API for accessing Public Key Credentials Level 1</a></cite>, that extend this policy to cryptographic keys. When a
cryptographic key is bound to a specific domain, it is sometimes referred to
as a <dfn data-plurals="pairwise identifiers" id="dfn-pairwise-identifier" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">pairwise identifier</dfn>.
      </p>
      <p>
The same-origin policy can be overridden for a variety of use cases, such as
for
<a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">
Cross-origin resource sharing</a> (CORS). This specification allows for the
cross-origin resource sharing of verification methods and service endpoints,
which means that correlatable identifiers might be shared between origins. While
resource sharing can lead to positive security outcomes (reduced cryptographic
key registration burden), it can also lead to negative privacy outcomes
(tracking). Those that use this specification are warned that there are
trade-offs with each approach and to use the mechanism that maximizes security
and privacy according to the needs of the individual or organization. Using a
<a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-99">controlled identifier document</a> for all use cases is not always advantageous when a
same-origin bound cryptographic key would suffice.
      </p>
    </section>

    <section id="identifier-correlation-risks"><div class="header-wrapper"><h3 id="x6-3-identifier-correlation-risks"><bdi class="secno">6.3 </bdi>Identifier Correlation Risks</h3><a class="self-link" href="#identifier-correlation-risks" aria-label="Permalink for Section 6.3"></a></div>
      

      <p>
Identifiers can be used for unwanted correlation. <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-47">Controllers</a> can
mitigate this privacy risk by using <a data-link-type="dfn|abstract-op" href="#dfn-pairwise-identifier" class="internalDFN" id="ref-for-dfn-pairwise-identifier-1">pairwise identifiers</a> that are unique to
each relationship or interaction domain; in effect, each identifier acts as a pseudonym. A <a data-link-type="dfn|abstract-op" href="#dfn-pairwise-identifier" class="internalDFN" id="ref-for-dfn-pairwise-identifier-2">pairwise identifier</a> need only be shared with more than one party when correlation
across contexts is explicitly desired. If <a data-link-type="dfn|abstract-op" href="#dfn-pairwise-identifier" class="internalDFN" id="ref-for-dfn-pairwise-identifier-3">pairwise identifiers</a> are the default,
then the only
need to publish an identifier openly, or to share it with multiple parties, is
when the <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-48">controllers</a> and/or <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-24">subjects</a> explicitly desire public
identification and correlation across interaction domains.
      </p>
    </section>

    <section id="controller-document-correlation-risks"><div class="header-wrapper"><h3 id="x6-4-controller-document-correlation-risks"><bdi class="secno">6.4 </bdi>Controller Document Correlation Risks</h3><a class="self-link" href="#controller-document-correlation-risks" aria-label="Permalink for Section 6.4"></a></div>
      

      <p>
The anti-correlation protections of <a data-link-type="dfn|abstract-op" href="#dfn-pairwise-identifier" class="internalDFN" id="ref-for-dfn-pairwise-identifier-4">pairwise identifiers</a> are easily defeated
if the data in the corresponding <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-100">controlled identifier documents</a> can be correlated. For
example, using identical <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-118">verification methods</a> in multiple <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-101">controlled identifier documents</a> can provide as much correlation information as using the same
identifier. Therefore, the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-102">controlled identifier document</a> for a <a data-link-type="dfn|abstract-op" href="#dfn-pairwise-identifier" class="internalDFN" id="ref-for-dfn-pairwise-identifier-5">pairwise identifier</a>
also needs to use pairwise unique information, such as ensuring that
<a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-119">verification methods</a> are unique to the pairwise relationship.
      </p>

    </section>

    <section id="subject-classification"><div class="header-wrapper"><h3 id="x6-5-subject-classification"><bdi class="secno">6.5 </bdi>Subject Classification</h3><a class="self-link" href="#subject-classification" aria-label="Permalink for Section 6.5"></a></div>
      
      <p>
It is dangerous to add properties to the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-103">controlled identifier document</a> that can be
used to indicate, explicitly or through inference, what <em>type</em> or nature
of thing the <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-25">subject</a> is, particularly if the <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-26">subject</a> is a person.
      </p>
      <p>
Not only do such properties potentially result in personal data (see
<a href="#keep-personal-data-private" data-matched-text="[[[#keep-personal-data-private]]]" class="sec-ref"><bdi class="secno">6.1 </bdi>Keep Personal Data Private</a>) or correlatable data (see <a href="#identifier-correlation-risks" class="sec-ref"> <bdi class="secno">6.3 </bdi>Identifier Correlation Risks</a> and
<a href="#controller-document-correlation-risks" data-matched-text="[[[#controller-document-correlation-risks]]]" class="sec-ref"><bdi class="secno">6.4 </bdi>Controller Document Correlation Risks</a>) being present in
the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-104">controlled identifier document</a>, but they can be used for grouping particular
identifiers in such a way that they are included in or excluded from certain
operations or functionalities.
      </p>
      <p>
Including <em>type</em> information in a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-105">controlled identifier document</a> can result
in personal privacy harms even for <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-27">subjects</a> that are non-person entities,
such as IoT devices. The aggregation of such information around a
<a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-49">controller</a> could serve as a form of digital fingerprint and this is best
avoided.
      </p>
      <p>
To minimize these risks, all properties in a <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-106">controlled identifier document</a> ought to
be for expressing <a data-link-type="dfn|abstract-op" href="#dfn-verification-method" class="internalDFN" id="ref-for-dfn-verification-method-120">verification methods</a> and <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-29">verification
relationships</a> related to using the identifier.
      </p>

    </section>

    <section id="service-privacy"><div class="header-wrapper"><h3 id="x6-6-service-privacy"><bdi class="secno">6.6 </bdi>Service Privacy</h3><a class="self-link" href="#service-privacy" aria-label="Permalink for Section 6.6"></a></div>
      
      <p>
The ability for a <a data-link-type="dfn|abstract-op" href="#dfn-controller-s" class="internalDFN" id="ref-for-dfn-controller-s-50">controller</a> to optionally express at least one <a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-17">service</a> in the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-107">controlled identifier document</a> increases their control and agency.
Each additional endpoint in the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-108">controlled identifier document</a> adds privacy risk either
due to correlation, such as across endpoint descriptions, or because the
<a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-18">services</a> are not protected by an authorization mechanism, or both.
      </p>
      <p>
<a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-109">Controlled identifier documents</a> are often public and, since they are standardized, will
be stored and indexed efficiently. This
risk is increased if <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-110">controlled identifier documents</a> are published to immutable
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-data-registries">verifiable data registries</a>. Access to a history of the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-111">controlled identifier documents</a> referenced by a URL enables a form of traffic analysis made more
efficient through the use of standards.
      </p>
      <p>
The degree of additional privacy risk caused by including multiple <a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-19">services</a> in
one <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-112">controlled identifier document</a> can be difficult to estimate. Privacy harms are
typically unintended consequences. URLs can refer to documents, <a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-20">services</a>,
schemas, and other things that might be associated with individual people,
households, clubs, and employers — and correlation of their <a data-link-type="dfn|abstract-op" href="#dfn-service" class="internalDFN" id="ref-for-dfn-service-21">services</a>
could become a powerful surveillance and inference tool. An example of
this potential harm can be seen when multiple common country-level top level
domains such as <code>https://example.co.uk</code> might be used to infer the approximate
location of the <a data-link-type="dfn|abstract-op" href="#dfn-subjects" class="internalDFN" id="ref-for-dfn-subjects-28">subject</a> with a greater degree of probability.
      </p>
    </section>

    </section>

    <section id="accessibility-considerations"><div class="header-wrapper"><h2 id="x7-accessibility-considerations"><bdi class="secno">7. </bdi>Accessibility Considerations</h2><a class="self-link" href="#accessibility-considerations" aria-label="Permalink for Section 7."></a></div>
      
      <p>
The following section describes accessibility considerations that developers
implementing this specification are urged to consider in order to ensure that
their software is usable by people with different cognitive, motor, and visual
needs. As a general rule, this specification is used by system software and does
not directly expose individuals to information subject to accessibility
considerations. However, there are instances where individuals might be
indirectly exposed to information expressed by this specification and thus the
guidance below is provided for those situations.
      </p>

      <section id="presenting-time-values"><div class="header-wrapper"><h3 id="x7-1-presenting-time-values"><bdi class="secno">7.1 </bdi>Presenting Time Values</h3><a class="self-link" href="#presenting-time-values" aria-label="Permalink for Section 7.1"></a></div>
        
        <p>
This specification enables the expression of dates and times related to the
validity period of <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-27">proofs</a>. This information might be indirectly
exposed to an individual if a <a data-link-type="dfn|abstract-op" href="#dfn-proof" class="internalDFN" id="ref-for-dfn-proof-28">proof</a> is processed and is detected to be outside
an allowable time range. When exposing these dates and times to an individual,
implementers are urged to take into account
<a href="https://www.w3.org/TR/vc-data-model-2.0/#representing-time">cultural normas and locales
when representing dates and times</a> in display software. In addition to these
considerations, presenting time values in a way that eases the cognitive burden
on the individual receiving the information is a suggested best practice.
        </p>
        <p>
For example, when conveying the expiration date for a particular set of
digitally signed information, implementers are urged to present the time of
expiration using language that is easier to understand rather than language that
optimizes for accuracy. Presenting the expiration time as "This ticket expired
three days ago." is preferred over a phrase such as "This ticket expired on July
25th 2023 at 3:43 PM." The former provides a relative time that is easier to
comprehend than the latter time, which requires the individual to do the
calculation in their head and presumes that they are capable of doing such a
calculation.
        </p>
      </section>

    </section>

    

    <section class="appendix informative" id="iana-considerations"><div class="header-wrapper"><h2 id="a-iana-considerations"><bdi class="secno">A. </bdi>IANA Considerations</h2><a class="self-link" href="#iana-considerations" aria-label="Permalink for Appendix A."></a></div><p><em>This section is non-normative.</em></p>
      

      <p>
This section will be submitted to the Internet Engineering Steering Group
(IESG) for review, approval, and registration with IANA.
      </p>

      <section id="controller-media-type"><div class="header-wrapper"><h3 id="a-1-application-cid"><bdi class="secno">A.1 </bdi>application/cid</h3><a class="self-link" href="#controller-media-type" aria-label="Permalink for Appendix A.1"></a></div>
        
        <p>
This specification registers the <code>application/cid</code> media type specifically for
identifying documents conforming to the <a data-link-type="dfn|abstract-op" href="#dfn-controlled-identifier-document" class="internalDFN" id="ref-for-dfn-controlled-identifier-document-113">controlled identifier document</a>
format.
        </p>
        <table>
          <tbody><tr>
            <td>Type name: </td>
            <td>application</td>
          </tr>
          <tr>
            <td>Subtype name: </td>
            <td>controller</td>
          </tr>
          <tr>
            <td>Required parameters: </td>
            <td>None</td>
          </tr>
          <tr>
            <td>Encoding considerations: </td>
            <td>
Resources that use the <code>application/cid</code> media type are required to conform to
all of the requirements for the <code>application/json</code> media type and are therefore
subject to the same encoding considerations specified in Section 11 of
<cite><a data-matched-text="[[[RFC7159]]]" href="https://www.rfc-editor.org/rfc/rfc7159">The JavaScript Object Notation (JSON) Data Interchange Format</a></cite>.
            </td>
          </tr>
          <tr>
            <td>Security considerations: </td>
            <td>As defined in the <cite><a data-matched-text="[[[CONTROLLER-DOCUMENT]]]" href="https://www.w3.org/TR/controller-document/">Controller Documents 1.0</a></cite>.</td>
          </tr>
          <tr>
            <td>Contact: </td>
            <td>
<abbr title="World Wide Web Consortium">W3C</abbr> Verifiable Credentials Working Group
<a href="mailto:public-vc-wg@w3.org">public-vc-wg@w3.org</a>
            </td>
          </tr>
        </tbody></table>

      </section>
    </section>

    <section class="appendix informative" id="examples"><div class="header-wrapper"><h2 id="b-examples"><bdi class="secno">B. </bdi>Examples</h2><a class="self-link" href="#examples" aria-label="Permalink for Appendix B."></a></div><p><em>This section is non-normative.</em></p>
      

      <p>
This section contains more detailed examples of the concepts introduced in
the specification.
      </p>
      <section class="informative" id="multikey-examples"><div class="header-wrapper"><h3 id="b-1-multikey-examples"><bdi class="secno">B.1 </bdi>Multikey Examples</h3><a class="self-link" href="#multikey-examples" aria-label="Permalink for Appendix B.1"></a></div><p><em>This section is non-normative.</em></p>
        

        <p>
This section contains various Multikey examples that might be useful for
developers seeking test values.
        </p>

          <div class="example" id="example-a-p-256-public-key-encoded-as-a-multikey">
        <div class="marker">
    <a class="self-link" href="#example-a-p-256-public-key-encoded-as-a-multikey">Example<bdi> 24</bdi></a><span class="example-title">: A P-256 public key encoded as a Multikey</span>
  </div> <pre class="nohighlight">{
  "id": "https://multikey.example/issuer/123#key-0",
  "type": "Multikey",
  "controller": "https://multikey.example/issuer/123",
  "publicKeyMultibase": "zDnaerx9CtbPJ1q36T5Ln5wYt3MQYeGRG5ehnPAmxcf5mDZpv"
}</pre>
      </div>

          <div class="example" id="example-a-p-384-public-key-encoded-as-a-multikey">
        <div class="marker">
    <a class="self-link" href="#example-a-p-384-public-key-encoded-as-a-multikey">Example<bdi> 25</bdi></a><span class="example-title">: A P-384 public key encoded as a Multikey</span>
  </div> <pre class="nohighlight">{
  "id": "https://multikey.example/issuer/123#key-0",
  "type": "Multikey",
  "controller": "https://multikey.example/issuer/123",
  "publicKeyMultibase": "z82LkvCwHNreneWpsgPEbV3gu1C6NFJEBg4srfJ5gdxEsMGRJ
    Uz2sG9FE42shbn2xkZJh54"
}</pre>
      </div>

          <div class="example" id="example-an-ed25519-public-key-encoded-as-a-multikey">
        <div class="marker">
    <a class="self-link" href="#example-an-ed25519-public-key-encoded-as-a-multikey">Example<bdi> 26</bdi></a><span class="example-title">: An Ed25519 public key encoded as a Multikey</span>
  </div> <pre class="nohighlight">{
  "id": "https://multikey.example/issuer/123#key-0",
  "type": "Multikey",
  "controller": "https://multikey.example/issuer/123",
  "publicKeyMultibase": "z6Mkf5rGMoatrSj1f4CyvuHBeXJELe9RPdzo2PKGNCKVtZxP"
}</pre>
      </div>

          <div class="example" id="example-a-bls12-381-g2-group-public-key-encoded-as-a-multikey">
        <div class="marker">
    <a class="self-link" href="#example-a-bls12-381-g2-group-public-key-encoded-as-a-multikey">Example<bdi> 27</bdi></a><span class="example-title">: A BLS12-381 G2 group public key, encoded as a Multikey</span>
  </div> <pre class="nohighlight">{
  "id": "https://multikey.example/issuer/123#key-0",
  "type": "Multikey",
  "controller": "https://multikey.example/issuer/123",
  "publicKeyMultibase": "zUC7EK3ZakmukHhuncwkbySmomv3FmrkmS36E4Ks5rsb6VQSRpoCrx6
  Hb8e2Nk6UvJFSdyw9NK1scFXJp21gNNYFjVWNgaqyGnkyhtagagCpQb5B7tagJu3HDbjQ8h
  5ypoHjwBb"
}</pre>
      </div>

          <div class="example" id="example-multiple-public-keys-encoded-as-multikeys-in-a-controlled-identifier-document">
        <div class="marker">
    <a class="self-link" href="#example-multiple-public-keys-encoded-as-multikeys-in-a-controlled-identifier-document">Example<bdi> 28</bdi></a><span class="example-title">: Multiple public keys encoded as Multikeys in a controlled identifier document</span>
  </div> <pre class="nohighlight">{
  "@context": "https://www.w3.org/ns/cid/v1",
  "id": "https://controller.example/123",
  "verificationMethod": [{
    "id": "https://multikey.example/issuer/123#key-1",
    "type": "Multikey",
    "controller": "https://multikey.example/issuer/123",
    "publicKeyMultibase": "zDnaerx9CtbPJ1q36T5Ln5wYt3MQYeGRG5ehnPAmxcf5mDZpv"
  }, {
    "id": "https://multikey.example/issuer/123#key-2",
    "type": "Multikey",
    "controller": "https://multikey.example/issuer/123",
    "publicKeyMultibase": "z6Mkf5rGMoatrSj1f4CyvuHBeXJELe9RPdzo2PKGNCKVtZxP"
  }, {
    "id": "https://multikey.example/issuer/123#key-3",
    "type": "Multikey",
    "controller": "https://multikey.example/issuer/123",
    "publicKeyMultibase": "zUC7EK3ZakmukHhuncwkbySmomv3FmrkmS36E4Ks5rsb6VQSRpoCrx6
    Hb8e2Nk6UvJFSdyw9NK1scFXJp21gNNYFjVWNgaqyGnkyhtagagCpQb5B7tagJu3HDbjQ8h
    5ypoHjwBb"
  }],
  "authentication": [
    "https://controller.example/123#key-1"
  ],
  "assertionMethod": [
    "https://controller.example/123#key-2"
    "https://controller.example/123#key-3"
  ],
  "capabilityDelegation": [
    "https://controller.example/123#key-2"
  ],
  "capabilityInvocation": [
    "https://controller.example/123#key-2"
  ]
}</pre>
      </div>
        </section>
        <section class="informative" id="jsonwebkey-examples"><div class="header-wrapper"><h3 id="b-2-jsonwebkey-examples"><bdi class="secno">B.2 </bdi>JsonWebKey Examples</h3><a class="self-link" href="#jsonwebkey-examples" aria-label="Permalink for Appendix B.2"></a></div><p><em>This section is non-normative.</em></p>
        

        <p>
This section contains various JsonWebKey examples that might be useful for
developers seeking test values.
        </p>

          <div class="example" id="example-a-p-256-public-key-encoded-as-a-jsonwebkey">
        <div class="marker">
    <a class="self-link" href="#example-a-p-256-public-key-encoded-as-a-jsonwebkey">Example<bdi> 29</bdi></a><span class="example-title">: A P-256 public key encoded as a JsonWebKey</span>
  </div> <pre class="nohighlight">{
  "id": "https://jsonwebkey.example/issuer/123#key-0",
  "type": "JsonWebKey",
  "controller": "https://jsonwebkey.example/issuer/123",
  "publicKeyJwk": {
    "kty": "EC",
    "crv": "P-256",
    "x": "Ums5WVgwRkRTVVFnU3k5c2xvZllMbEcwM3NPRW91ZzN",
    "y": "nDQW6XZ7b_u2Sy9slofYLlG03sOEoug3I0aAPQ0exs4"
  }
}</pre>
      </div>

          <div class="example" id="example-a-p-384-public-key-encoded-as-a-jsonwebkey">
        <div class="marker">
    <a class="self-link" href="#example-a-p-384-public-key-encoded-as-a-jsonwebkey">Example<bdi> 30</bdi></a><span class="example-title">: A P-384 public key encoded as a JsonWebKey</span>
  </div> <pre class="nohighlight">{
  "id": "https://jsonwebkey.example/issuer/123#key-0",
  "type": "JsonWebKey",
  "controller": "https://jsonwebkey.example/issuer/123",
  "publicKeyJwk": {
    "kty": "EC",
    "crv": "P-384",
    "x": "VUZKSlUwMGdpSXplekRwODhzX2N4U1BYdHVYWUZsaXVDR25kZ1U0UXA4bDkxeHpE",
    "y": "jq4QoAHKiIzezDp88s_cxSPXtuXYFliuCGndgU4Qp8l91xzD1spCmFIzQgVjqvcP"
  }
}</pre>
      </div>

          <div class="example" id="example-an-ed25519-public-key-encoded-as-a-jsonwebkey">
        <div class="marker">
    <a class="self-link" href="#example-an-ed25519-public-key-encoded-as-a-jsonwebkey">Example<bdi> 31</bdi></a><span class="example-title">: An Ed25519 public key encoded as a JsonWebKey</span>
  </div> <pre class="nohighlight">{
  "id": "https://jsonwebkey.example/issuer/123#key-0",
  "type": "JsonWebKey",
  "controller": "https://jsonwebkey.example/issuer/123",
  "publicKeyJwk": {
    "kty": "OKP",
    "crv": "Ed25519",
    "x": "VCpo2LMLhn6iWku8MKvSLg2ZAoC-nlOyPVQaO3FxVeQ"
  }
}</pre>
      </div>

          <div class="example" id="example-a-bls12-381-g2-group-public-key-encoded-as-a-jsonwebkey">
        <div class="marker">
    <a class="self-link" href="#example-a-bls12-381-g2-group-public-key-encoded-as-a-jsonwebkey">Example<bdi> 32</bdi></a><span class="example-title">: A BLS12-381 G2 group public key, encoded as a JsonWebKey</span>
  </div> <pre class="nohighlight">{
  "id": "https://jsonwebkey.example/issuer/123#key-0",
  "type": "JsonWebKey",
  "controller": "https://jsonwebkey.example/issuer/123",
  "publicKeyJwk": {
    "kty": "EC",
    "crv": "BLS12381G2",
    "x": "Ajs8lstTgoTgXMF6QXdyh3m8k2ixxURGYLMaYylVK_x0F8HhE8zk0YWiGV3CHwpQEa2sH4PBZLaYCn8se-1clmCORDsKxbbw3Js_Alu4OmkV9gmbJsy1YF2rt7Vxzs6S",
    "y": "BVkkrVEib-P_FMPHNtqxJymP3pV-H8fCdvPkoWInpFfM9tViyqD8JAmwDf64zU2hBV_vvCQ632ScAooEExXuz1IeQH9D2o-uY_dAjZ37YHuRMEyzh8Tq-90JHQvicOqx"
  }
}</pre>
      </div>

          <div class="example" id="example-multiple-public-keys-encoded-as-jsonwebkey-in-a-controlled-identifier-document">
        <div class="marker">
    <a class="self-link" href="#example-multiple-public-keys-encoded-as-jsonwebkey-in-a-controlled-identifier-document">Example<bdi> 33</bdi></a><span class="example-title">: Multiple public keys encoded as JsonWebKey in a controlled identifier document</span>
  </div> <pre class="nohighlight">{
  "@context": "https://www.w3.org/ns/cid/v1",
  "id": "https://controller.example/123",
  "verificationMethod": [{
    "id": "https://jsonwebkey.example/issuer/123#key-1",
    "type": "JsonWebKey",
    "controller": "https://jsonwebkey.example/issuer/123",
    "publicKeyJwk": {
      "kty": "EC",
      "crv": "P-256",
      "x": "fyNYMN0976ci7xqiSdag3buk-ZCwgXU4kz9XNkBlNUI",
      "y": "hW2ojTNfH7Jbi8--CJUo3OCbH3y5n91g-IMA9MLMbTU"
    }
  }, {
    "id": "https://jsonwebkey.example/issuer/123#key-2",
    "type": "JsonWebKey",
    "controller": "https://jsonwebkey.example/issuer/123",
    "publicKeyJwk": {
      "kty": "EC",
      "crv": "P-521",
      "x": "ASUHPMyichQ0QbHZ9ofNx_l4y7luncn5feKLo3OpJ2nSbZoC7mffolj5uy7s6KSKXFmnNWxGJ42IOrjZ47qqwqyS",
      "y": "AW9ziIC4ZQQVSNmLlp59yYKrjRY0_VqO-GOIYQ9tYpPraBKUloEId6cI_vynCzlZWZtWpgOM3HPhYEgawQ703RjC"
    }
  }, {
    "id": "https://jsonwebkey.example/issuer/123#key-3",
    "type": "JsonWebKey",
    "controller": "https://jsonwebkey.example/issuer/123",
    "publicKeyJwk": {
      "kty": "OKP",
      "crv": "Ed25519",
      "x": "_eT7oDCtAC98L31MMx9J0T-w7HR-zuvsY08f9MvKne8"
    }
  }],
  "authentication": [
    "https://controller.example/123#key-1"
  ],
  "assertionMethod": [
    "https://controller.example/123#key-2"
    "https://controller.example/123#key-3"
  ],
  "capabilityDelegation": [
    "https://controller.example/123#key-2"
  ],
  "capabilityInvocation": [
    "https://controller.example/123#key-2"
  ]
}</pre>
      </div>
        </section>
      </section>

    

    <section class="appendix informative" id="revision-history"><div class="header-wrapper"><h2 id="c-revision-history"><bdi class="secno">C. </bdi>Revision History</h2><a class="self-link" href="#revision-history" aria-label="Permalink for Appendix C."></a></div><p><em>This section is non-normative.</em></p>
      

      <p>
This section contains the substantive changes that have been made to this
specification over time.
      </p>

      <ul>
        <li>
Populated Terminology section.
        </li>
        <li>
Apply wording updates from VC-JOSE-COSE spec.
        </li>
      </ul>

    </section>

    <section class="appendix informative" id="acknowledgements"><div class="header-wrapper"><h2 id="d-acknowledgements"><bdi class="secno">D. </bdi>Acknowledgements</h2><a class="self-link" href="#acknowledgements" aria-label="Permalink for Appendix D."></a></div><p><em>This section is non-normative.</em></p>
      

      <p>
The specification authors would like to thank the contributors to the
<a href="https://www.w3.org/TR/2022/REC-did-core-20220719/">
<abbr title="World Wide Web Consortium">W3C</abbr> Decentralized Identifiers (DIDs) v1.0</a> specification upon which this work
is based.
      </p>

      <p>
The Working Group gratefully acknowledges the work that led to the creation of
this specification, and extends sincere appreciation to those individuals that
worked on technologies and specifications that deeply influenced our work. In
particular, this includes the work of Phil Zimmerman, Jon Callas, Lutz
Donnerhacke, Hal Finney, David Shaw, and Rodney Thayer on <a href="https://en.wikipedia.org/wiki/Pretty_Good_Privacy"> Pretty Good Privacy
(PGP)</a> in the 1990s and 2000s.
      </p>

      <p>
In the mid-2010s, preliminary implementations of what would become Decentralized
Identifiers were <a href="https://github.com/web-payments/minutes/blob/master/2014-05-07/irc.log#L5">
built</a> in collaboration with Jeremie Miller's Telehash project and the <abbr title="World Wide Web Consortium">W3C</abbr>
Web Payments Community Group's work led by Dave Longley and Manu Sporny. Around
a year later, the XDI.org Registry Working Group
<a href="https://docs.google.com/document/d/1EP-KhH60y-nl4xkEzoeSf3DjmjLomfboF4p2umF51FA/">
began exploring</a> decentralized technologies for replacing its existing
identifier registry. Some of the first
<a href="https://github.com/WebOfTrustInfo/rwot1-sf/blob/master/final-documents/dpki.pdf">written</a>
<a href="https://github.com/WebOfTrustInfo/rwot2-id2020/blob/master/final-documents/requirements-for-dids.pdf">papers</a>
exploring the concept of Decentralized Identifiers can be traced back to the
first several Rebooting the Web of Trust workshops convened by Christopher
Allen. That work led to a key collaboration between Christopher Allen, Drummond
Reed, Les Chasen, Manu Sporny, and Anil John. Anil saw promise in the technology
and allocated the initial set of government funding to explore the space.
Without the support of Anil John and his guidance through the years, it is
unlikely that Decentralized Identifiers would be where they are today. Further
refinement at the Rebooting the Web of Trust workshops led to the <a href="https://github.com/WebOfTrustInfo/rwot3-sf/blob/master/final-documents/did-implementer-draft-10.pdf">first
implementers documentation</a>, edited by Drummond Reed, Les Chasen, Christopher
Allen, and Ryan Grant. Contributors included Manu Sporny, Dave Longley, Jason
Law, Daniel Hardman, Markus Sabadello, Christian Lundkvist, and Jonathan
Endersby. This initial work was then merged into the <abbr title="World Wide Web Consortium">W3C</abbr> Credentials Community
Group, incubated further, and then transitioned to the <abbr title="World Wide Web Consortium">W3C</abbr> Decentralized
Identifiers Working Group for global standardization. That work was then used
as the basis for this, more generalized and less decentralized, specification.
      </p>

      <p>
Portions of the work on this specification have been funded by the United States
Department of Homeland Security's (US DHS) Science and Technology Directorate
under contracts HSHQDC-16-R00012-H-SB2016-1-002, and HSHQDC-17-C-00019, as well
as the US DHS Silicon Valley Innovation Program under contracts
70RSAT20T00000003, 70RSAT20T00000010/P00001, 70RSAT20T00000029,
70RSAT20T00000030, 70RSAT20T00000033, 70RSAT20T00000045,
70RSAT21T00000016/P00001, 70RSAT23T00000005, 70RSAT23C00000030, and
70RSAT23R00000006. The content of this specification does not necessarily
reflect the position or the policy of the U.S. Government and no official
endorsement should be inferred.
      </p>

      <p>
Portions of the work on this specification have also been funded by the European
Union's StandICT.eu program under sub-grantee contract number CALL05/19. The
content of this specification does not necessarily reflect the position or the
policy of the European Union and no official endorsement should be inferred.
      </p>

      <p>
We would also like to thank the base-x software library contributors and the
Bitcoin Core developers who wrote the original code, shared under an MIT
License, found in Section <a href="#base-encode" data-matched-text="[[[#base-encode]]]" class="sec-ref"><bdi class="secno">3.1 </bdi>Base Encode</a> and Section <a href="#base-decode" data-matched-text="[[[#base-decode]]]" class="sec-ref"><bdi class="secno">3.2 </bdi>Base Decode</a>.
      </p>

      <p>
Work on this specification has also been supported by the
<a href="https://www.weboftrust.info/">Rebooting the Web of Trust</a> community
facilitated by Christopher Allen, Shannon Appelcline, Kiara Robles, Brian
Weller, Betty Dhamers, Kaliya Young, Kim Hamilton Duffy, Manu Sporny, Drummond
Reed, Joe Andrieu, Heather Vescent, Samantha Chase, Andrew Hughes, Erica
Connell, Shigeya Suzuki, and Zaïda Rivai. Development of this specification has
also been supported by the
<a href="https://w3c-ccg.github.io/"><abbr title="World Wide Web Consortium">W3C</abbr> Credentials Community Group</a>, which
has been Chaired by Kim Hamilton Duffy, Joe Andrieu, Christopher Allen, Heather
Vescent, and Wayne Chang. The participants in the Internet Identity Workshop,
facilitated by Phil Windley, Kaliya Young, Doc Searls, and Heidi Nobantu Saul,
also supported this work through numerous working sessions designed to debate,
improve, and educate participants about this specification.
      </p>

      <p>
The Working Group thanks the following individuals for their contributions to
this specification (in alphabetical order, Github handles start with <code>@</code> and
are sorted as last names): Denis Ah-Kang, Nacho Alamillo, Christopher Allen, Joe
Andrieu, Antonio, Phil Archer, George Aristy, Baha, Juan Benet, BigBlueHat, Dan
Bolser, Chris Boscolo, Pelle Braendgaard, Daniel Buchner, Daniel Burnett, Juan
Caballero, @cabo, Tim Cappalli, Melvin Carvalho, David Chadwick, Wayne Chang,
Sam Curren, Hai Dang, Tim Daubenschütz, Oskar van Deventer, Kim Hamilton Duffy,
Arnaud Durand, Ken Ebert, Veikko Eeva, @ewagner70, Carson Farmer, Nikos Fotiou,
Gabe, Gayan, @gimly-jack, @gjgd, Ryan Grant, Peter Grassberger, Adrian Gropper,
Amy Guy, Daniel Hardman, Kyle Den Hartog, Philippe Le Hegaret, Ivan Herman,
Michael Herman, Alen Horvat, Dave Huseby, Marcel Jackisch, Mike Jones, Andrew
Jones, Tom Jones, jonnycrunch, Gregg Kellogg, Michael Klein, @kdenhartog-sybil1,
Paul Knowles, @ktobich, David I. Lehn, Charles E. Lehner, Michael Lodder,
@mooreT1881, Dave Longley, Tobias Looker, Wolf McNally, Robert Mitwicki, Mircea
Nistor, Grant Noble, Mark Nottingham, @oare, Darrell O'Donnell, Vinod Panicker,
Dirk Porsche, Praveen, Mike Prorock, @pukkamustard, Drummond Reed, Julian
Reschke, Yancy Ribbens, Justin Richer, Rieks, @rknobloch, Mikeal Rogers,
Evstifeev Roman, Troy Ronda, Leonard Rosenthol, Michael Ruminer, Markus
Sabadello, Cihan Saglam, Samu, Rob Sanderson, Wendy Seltzer, Mehran Shakeri,
Jaehoon (Ace) Shim, Samuel Smith, James M Snell, SondreB, Manu Sporny, @ssstolk,
Orie Steele, Shigeya Suzuki, Sammotic Switchyarn, @tahpot, Oliver Terbu,  Ted
Thibodeau Jr., Joel Thorstensson, Tralcan, Henry Tsai, Rod Vagg, Mike Varley,
Kaliya "Identity Woman" Young, Eric Welton, Fuqiao Xue, @Yue, Dmitri Zagidulin,
@zhanb, and Brent Zundel.
      </p>


    </section>

  

<section id="references" class="appendix"><div class="header-wrapper"><h2 id="e-references"><bdi class="secno">E. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix E."></a></div><section id="normative-references"><div class="header-wrapper"><h3 id="e-1-normative-references"><bdi class="secno">E.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix E.1"></a></div>
    
    <dl class="bibliography"><dt id="bib-did-extensions-properties">[DID-EXTENSIONS-PROPERTIES]</dt><dd>
      <a href="https://www.w3.org/TR/did-extensions-properties/"><cite>DID Document Property Extensions</cite></a>. Manu Sporny; Markus Sabadello.  W3C. 19 November 2024. W3C Working Group Note. URL: <a href="https://www.w3.org/TR/did-extensions-properties/">https://www.w3.org/TR/did-extensions-properties/</a>
    </dd><dt id="bib-infra">[INFRA]</dt><dd>
      <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Anne van Kesteren; Domenic Denicola.  WHATWG. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
    </dd><dt id="bib-jose-registries">[JOSE-REGISTRIES]</dt><dd>
      <a href="https://www.iana.org/assignments/jose"><cite>The JSON Object Signing and Encryption (JOSE) Registries</cite></a>. The Internet Assigned Numbers Authority.  The Internet Assigned Numbers Authority. W3C Recommendation. URL: <a href="https://www.iana.org/assignments/jose">https://www.iana.org/assignments/jose</a>
    </dd><dt id="bib-rdf-concepts">[RDF-CONCEPTS]</dt><dd>
      <a href="https://www.w3.org/TR/rdf-concepts/"><cite>Resource Description Framework (RDF): Concepts and Abstract Syntax</cite></a>. Graham Klyne; Jeremy Carroll.  W3C. 10 February 2004. W3C Recommendation. URL: <a href="https://www.w3.org/TR/rdf-concepts/">https://www.w3.org/TR/rdf-concepts/</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc3986">[RFC3986]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc3986"><cite>Uniform Resource Identifier (URI): Generic Syntax</cite></a>. T. Berners-Lee; R. Fielding; L. Masinter.  IETF. January 2005. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>
    </dd><dt id="bib-rfc6234">[RFC6234]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc6234"><cite>US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)</cite></a>. D. Eastlake 3rd; T. Hansen.  IETF. May 2011. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc6234">https://www.rfc-editor.org/rfc/rfc6234</a>
    </dd><dt id="bib-rfc7515">[RFC7515]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7515"><cite>JSON Web Signature (JWS)</cite></a>. M. Jones; J. Bradley; N. Sakimura.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7515">https://www.rfc-editor.org/rfc/rfc7515</a>
    </dd><dt id="bib-rfc7517">[RFC7517]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7517"><cite>JSON Web Key (JWK)</cite></a>. M. Jones.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>
    </dd><dt id="bib-rfc7518">[RFC7518]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7518"><cite>JSON Web Algorithms (JWA)</cite></a>. M. Jones.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7518">https://www.rfc-editor.org/rfc/rfc7518</a>
    </dd><dt id="bib-rfc7638">[RFC7638]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7638"><cite>JSON Web Key (JWK) Thumbprint</cite></a>. M. Jones; N. Sakimura.  IETF. September 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7638">https://www.rfc-editor.org/rfc/rfc7638</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-rfc9457">[RFC9457]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc9457"><cite>Problem Details for HTTP APIs</cite></a>. M. Nottingham; E. Wilde; S. Dalal.  IETF. July 2023. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc9457">https://www.rfc-editor.org/rfc/rfc9457</a>
    </dd><dt id="bib-sha3">[SHA3]</dt><dd>
      <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf"><cite>SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions</cite></a>. National Institute of Standards and Technology.  U.S. Department of Commerce. National Standard. URL: <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf</a>
    </dd><dt id="bib-url">[URL]</dt><dd>
      <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Anne van Kesteren.  WHATWG. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
    </dd><dt id="bib-vc-data-model-2.0">[VC-DATA-MODEL-2.0]</dt><dd>
      <a href="https://www.w3.org/TR/vc-data-model-2.0/"><cite>Verifiable Credentials Data Model v2.0</cite></a>. Manu Sporny; Ted Thibodeau Jr; Ivan Herman; Michael Jones; Gabe Cohen.  W3C. 19 October 2024. W3C Candidate Recommendation. URL: <a href="https://www.w3.org/TR/vc-data-model-2.0/">https://www.w3.org/TR/vc-data-model-2.0/</a>
    </dd><dt id="bib-xmlschema11-2">[XMLSCHEMA11-2]</dt><dd>
      <a href="https://www.w3.org/TR/xmlschema11-2/"><cite>W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes</cite></a>. David Peterson; Sandy Gao; Ashok Malhotra; Michael Sperberg-McQueen; Henry Thompson; Paul V. Biron et al.  W3C. 5 April 2012. W3C Recommendation. URL: <a href="https://www.w3.org/TR/xmlschema11-2/">https://www.w3.org/TR/xmlschema11-2/</a>
    </dd></dl>
  </section><section id="informative-references"><div class="header-wrapper"><h3 id="e-2-informative-references"><bdi class="secno">E.2 </bdi>Informative references</h3><a class="self-link" href="#informative-references" aria-label="Permalink for Appendix E.2"></a></div>
    
    <dl class="bibliography"><dt id="bib-controller-document">[CONTROLLER-DOCUMENT]</dt><dd>
      <a href="https://www.w3.org/TR/controller-document/"><cite>Controller Documents 1.0</cite></a>. Manu Sporny; Michael Jones.  W3C. 28 October 2024. W3C Working Draft. URL: <a href="https://www.w3.org/TR/controller-document/">https://www.w3.org/TR/controller-document/</a>
    </dd><dt id="bib-did-core">[DID-CORE]</dt><dd>
      <a href="https://www.w3.org/TR/did-core/"><cite>Decentralized Identifiers (DIDs) v1.0</cite></a>. Manu Sporny; Amy Guy; Markus Sabadello; Drummond Reed.  W3C. 19 July 2022. W3C Recommendation. URL: <a href="https://www.w3.org/TR/did-core/">https://www.w3.org/TR/did-core/</a>
    </dd><dt id="bib-did-use-cases">[DID-USE-CASES]</dt><dd>
      <a href="https://www.w3.org/TR/did-use-cases/"><cite>Use Cases and Requirements for Decentralized Identifiers</cite></a>. Joe Andrieu; Phil Archer; Kim Duffy; Ryan Grant; Adrian Gropper.  W3C. 17 March 2021. W3C Working Group Note. URL: <a href="https://www.w3.org/TR/did-use-cases/">https://www.w3.org/TR/did-use-cases/</a>
    </dd><dt id="bib-html-rdfa">[HTML-RDFA]</dt><dd>
      <a href="https://www.w3.org/TR/html-rdfa/"><cite>HTML+RDFa 1.1 - Second Edition</cite></a>. Manu Sporny.  W3C. 17 March 2015. W3C Recommendation. URL: <a href="https://www.w3.org/TR/html-rdfa/">https://www.w3.org/TR/html-rdfa/</a>
    </dd><dt id="bib-json-ld11">[JSON-LD11]</dt><dd>
      <a href="https://www.w3.org/TR/json-ld11/"><cite>JSON-LD 1.1</cite></a>. Gregg Kellogg; Pierre-Antoine Champin; Dave Longley.  W3C. 16 July 2020. W3C Recommendation. URL: <a href="https://www.w3.org/TR/json-ld11/">https://www.w3.org/TR/json-ld11/</a>
    </dd><dt id="bib-privacy-by-design">[PRIVACY-BY-DESIGN]</dt><dd>
      <a href="https://iapp.org/media/pdf/resource_center/pbd_implement_7found_principles.pdf"><cite>Privacy by Design</cite></a>. Ann Cavoukian.  Information and Privacy Commissioner. 2011. URL: <a href="https://iapp.org/media/pdf/resource_center/pbd_implement_7found_principles.pdf">https://iapp.org/media/pdf/resource_center/pbd_implement_7found_principles.pdf</a>
    </dd><dt id="bib-rfc3552">[RFC3552]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc3552"><cite>Guidelines for Writing RFC Text on Security Considerations</cite></a>. E. Rescorla; B. Korver.  IETF. July 2003. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc3552">https://www.rfc-editor.org/rfc/rfc3552</a>
    </dd><dt id="bib-rfc7159">[RFC7159]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7159"><cite>The JavaScript Object Notation (JSON) Data Interchange Format</cite></a>. T. Bray, Ed. IETF. March 2014. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7159">https://www.rfc-editor.org/rfc/rfc7159</a>
    </dd><dt id="bib-turtle">[TURTLE]</dt><dd>
      <a href="https://www.w3.org/TR/turtle/"><cite>RDF 1.1 Turtle</cite></a>. Eric Prud'hommeaux; Gavin Carothers.  W3C. 25 February 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/turtle/">https://www.w3.org/TR/turtle/</a>
    </dd><dt id="bib-vc-data-integrity">[VC-DATA-INTEGRITY]</dt><dd>
      <a href="https://www.w3.org/TR/vc-data-integrity/"><cite>Verifiable Credential Data Integrity 1.0</cite></a>. Manu Sporny; Dave Longley; Greg Bernstein; Dmitri Zagidulin; Sebastian Crane.  W3C. 17 November 2024. W3C Candidate Recommendation. URL: <a href="https://www.w3.org/TR/vc-data-integrity/">https://www.w3.org/TR/vc-data-integrity/</a>
    </dd><dt id="bib-vc-extensions">[VC-EXTENSIONS]</dt><dd>
      <a href="https://www.w3.org/TR/vc-extensions/"><cite>Verifiable Credential Extensions</cite></a>. Manu Sporny.  W3C Verifiable Credentials Working Group. W3C Working Group Note. URL: <a href="https://www.w3.org/TR/vc-extensions/">https://www.w3.org/TR/vc-extensions/</a>
    </dd><dt id="bib-vc-use-cases">[VC-USE-CASES]</dt><dd>
      <a href="https://www.w3.org/TR/vc-use-cases/"><cite>Verifiable Credentials Use Cases</cite></a>. Shane McCarron; Joe Andrieu; Matt Stone; Tzviya Siegman; Gregg Kellogg; Ted Thibodeau Jr.  W3C. 24 September 2019. W3C Working Group Note. URL: <a href="https://www.w3.org/TR/vc-use-cases/">https://www.w3.org/TR/vc-use-cases/</a>
    </dd><dt id="bib-webauthn">[WEBAUTHN]</dt><dd>
      <a href="https://www.w3.org/TR/webauthn-1/"><cite>Web Authentication:An API for accessing Public Key Credentials Level 1</cite></a>. Dirk Balfanz; Alexei Czeskis; Jeff Hodges; J.C. Jones; Michael Jones; Akshay Kumar; Huakai Liao; Rolf Lindemann; Emil Lundberg.  W3C. 4 March 2019. W3C Recommendation. URL: <a href="https://www.w3.org/TR/webauthn-1/">https://www.w3.org/TR/webauthn-1/</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-conforming-controlled-identifier-document" aria-label="Links in this document to definition: conforming controlled identifier document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-conforming-controlled-identifier-document" aria-label="Permalink for definition: conforming controlled identifier document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-conforming-controlled-identifier-document-1" title="§ 1.3 Conformance">§ 1.3 Conformance</a> 
    </li><li>
      <a href="#ref-for-dfn-conforming-controlled-identifier-document-2" title="§ 3.3 Retrieve Verification Method">§ 3.3 Retrieve Verification Method</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-conforming-verification-method" aria-label="Links in this document to definition: conforming verification method">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-conforming-verification-method" aria-label="Permalink for definition: conforming verification method. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-conforming-verification-method-1" title="§ 1.3 Conformance">§ 1.3 Conformance</a> 
    </li><li>
      <a href="#ref-for-dfn-conforming-verification-method-2" title="§ 3.3 Retrieve Verification Method">§ 3.3 Retrieve Verification Method</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-conforming-document" aria-label="Links in this document to definition: conforming document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-conforming-document" aria-label="Permalink for definition: conforming document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-conforming-document-1" title="§ 1.3 Conformance">§ 1.3 Conformance</a> 
    </li><li>
      <a href="#ref-for-dfn-conforming-document-2" title="§ 2.1.4 Services">§ 2.1.4 Services</a> 
    </li><li>
      <a href="#ref-for-dfn-conforming-document-3" title="§ 4.2.1 Context Injection">§ 4.2.1 Context Injection</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-conforming-processor" aria-label="Links in this document to definition: conforming processor">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-conforming-processor" aria-label="Permalink for definition: conforming processor. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-conforming-processor-1" title="§ 4.2.1 Context Injection">§ 4.2.1 Context Injection</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-authenticated" aria-label="Links in this document to definition: authentication">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-authenticated" aria-label="Permalink for definition: authentication. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-authenticated-1" title="§ 1.4 Terminology">§ 1.4 Terminology</a> 
    </li><li>
      <a href="#ref-for-dfn-authenticated-2" title="§ 2.1.2 Controllers">§ 2.1.2 Controllers</a> <a href="#ref-for-dfn-authenticated-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-authenticated-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-authenticated-5" title="Reference 4">(4)</a> <a href="#ref-for-dfn-authenticated-6" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-authenticated-7" title="§ 2.2 Verification Methods">§ 2.2 Verification Methods</a> 
    </li><li>
      <a href="#ref-for-dfn-authenticated-8" title="§ 2.3 Verification Relationships">§ 2.3 Verification Relationships</a> 
    </li><li>
      <a href="#ref-for-dfn-authenticated-9" title="§ 2.3.1 Authentication">§ 2.3.1 Authentication</a> <a href="#ref-for-dfn-authenticated-10" title="Reference 2">(2)</a> <a href="#ref-for-dfn-authenticated-11" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-authenticated-12" title="§ 5.10 Level of Assurance">§ 5.10 Level of Assurance</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-authorized" aria-label="Links in this document to definition: authorization">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-authorized" aria-label="Permalink for definition: authorization. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-authorized-1" title="§ 2.1.2 Controllers">§ 2.1.2 Controllers</a> <a href="#ref-for-dfn-authorized-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-authorized-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-authorized-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-authorized-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-authorized-6" title="Reference 6">(6)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-controlled-identifier" aria-label="Links in this document to definition: controlled identifier">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-controlled-identifier" aria-label="Permalink for definition: controlled identifier. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-controlled-identifier-document" aria-label="Links in this document to definition: controlled identifier document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-controlled-identifier-document" aria-label="Permalink for definition: controlled identifier document. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-controlled-identifier-document-1" title="§ 1. Introduction">§ 1. Introduction</a> <a href="#ref-for-dfn-controlled-identifier-document-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-4" title="§ 1.4 Terminology">§ 1.4 Terminology</a> <a href="#ref-for-dfn-controlled-identifier-document-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-6" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-7" title="§ 2. Data Model">§ 2. Data Model</a> <a href="#ref-for-dfn-controlled-identifier-document-8" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-9" title="§ 2.1 Controller Documents">§ 2.1 Controller Documents</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-10" title="§ 2.1.1 Subjects">§ 2.1.1 Subjects</a> <a href="#ref-for-dfn-controlled-identifier-document-11" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-12" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controlled-identifier-document-13" title="Reference 4">(4)</a> <a href="#ref-for-dfn-controlled-identifier-document-14" title="Reference 5">(5)</a> <a href="#ref-for-dfn-controlled-identifier-document-15" title="Reference 6">(6)</a> <a href="#ref-for-dfn-controlled-identifier-document-16" title="Reference 7">(7)</a> <a href="#ref-for-dfn-controlled-identifier-document-17" title="Reference 8">(8)</a> <a href="#ref-for-dfn-controlled-identifier-document-18" title="Reference 9">(9)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-19" title="§ 2.1.2 Controllers">§ 2.1.2 Controllers</a> <a href="#ref-for-dfn-controlled-identifier-document-20" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-21" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controlled-identifier-document-22" title="Reference 4">(4)</a> <a href="#ref-for-dfn-controlled-identifier-document-23" title="Reference 5">(5)</a> <a href="#ref-for-dfn-controlled-identifier-document-24" title="Reference 6">(6)</a> <a href="#ref-for-dfn-controlled-identifier-document-25" title="Reference 7">(7)</a> <a href="#ref-for-dfn-controlled-identifier-document-26" title="Reference 8">(8)</a> <a href="#ref-for-dfn-controlled-identifier-document-27" title="Reference 9">(9)</a> <a href="#ref-for-dfn-controlled-identifier-document-28" title="Reference 10">(10)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-29" title="§ 2.1.3 Also Known As">§ 2.1.3 Also Known As</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-30" title="§ 2.1.4 Services">§ 2.1.4 Services</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-31" title="§ 2.2 Verification Methods">§ 2.2 Verification Methods</a> <a href="#ref-for-dfn-controlled-identifier-document-32" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-33" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controlled-identifier-document-34" title="Reference 4">(4)</a> <a href="#ref-for-dfn-controlled-identifier-document-35" title="Reference 5">(5)</a> <a href="#ref-for-dfn-controlled-identifier-document-36" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-37" title="§ 2.2.1 Verification Material">§ 2.2.1 Verification Material</a> <a href="#ref-for-dfn-controlled-identifier-document-38" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-39" title="§ 2.2.4 Referring to Verification Methods">§ 2.2.4 Referring to Verification Methods</a> <a href="#ref-for-dfn-controlled-identifier-document-40" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-41" title="§ 2.3 Verification Relationships">§ 2.3 Verification Relationships</a> <a href="#ref-for-dfn-controlled-identifier-document-42" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-43" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controlled-identifier-document-44" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-45" title="§ 2.3.1 Authentication">§ 2.3.1 Authentication</a> <a href="#ref-for-dfn-controlled-identifier-document-46" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-47" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-48" title="§ 2.3.4 Capability Invocation">§ 2.3.4 Capability Invocation</a> <a href="#ref-for-dfn-controlled-identifier-document-49" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-50" title="§ 3.3 Retrieve Verification Method">§ 3.3 Retrieve Verification Method</a> <a href="#ref-for-dfn-controlled-identifier-document-51" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-52" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controlled-identifier-document-53" title="Reference 4">(4)</a> <a href="#ref-for-dfn-controlled-identifier-document-54" title="Reference 5">(5)</a> <a href="#ref-for-dfn-controlled-identifier-document-55" title="Reference 6">(6)</a> <a href="#ref-for-dfn-controlled-identifier-document-56" title="Reference 7">(7)</a> <a href="#ref-for-dfn-controlled-identifier-document-57" title="Reference 8">(8)</a> <a href="#ref-for-dfn-controlled-identifier-document-58" title="Reference 9">(9)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-59" title="§ 3.4 Processing Errors">§ 3.4 Processing Errors</a> <a href="#ref-for-dfn-controlled-identifier-document-60" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-61" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controlled-identifier-document-62" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-63" title="§ 4.2.1 Context Injection">§ 4.2.1 Context Injection</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-64" title="§ 5.1 Proving Control and Binding">§ 5.1 Proving Control and Binding</a> <a href="#ref-for-dfn-controlled-identifier-document-65" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-66" title="§ 5.1.1 Proving Control of an Identifier and/or Controller Document">§ 5.1.1 Proving Control of an Identifier and/or Controller Document</a> <a href="#ref-for-dfn-controlled-identifier-document-67" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-68" title="§ 5.1.2 Binding to Physical Identity">§ 5.1.2 Binding to Physical Identity</a> <a href="#ref-for-dfn-controlled-identifier-document-69" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-70" title="§ 5.4 Verification Method Rotation">§ 5.4 Verification Method Rotation</a> <a href="#ref-for-dfn-controlled-identifier-document-71" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-72" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-73" title="§ 5.5 Verification Method Revocation">§ 5.5 Verification Method Revocation</a> <a href="#ref-for-dfn-controlled-identifier-document-74" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-75" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-76" title="§ 5.5.1 Revocation Semantics">§ 5.5.1 Revocation Semantics</a> <a href="#ref-for-dfn-controlled-identifier-document-77" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-78" title="§ 5.7 Encrypted Data in Controller Documents">§ 5.7 Encrypted Data in Controller Documents</a> <a href="#ref-for-dfn-controlled-identifier-document-79" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-80" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controlled-identifier-document-81" title="Reference 4">(4)</a> <a href="#ref-for-dfn-controlled-identifier-document-82" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-83" title="§ 5.8 Content Integrity Protection">§ 5.8 Content Integrity Protection</a> <a href="#ref-for-dfn-controlled-identifier-document-84" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-85" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controlled-identifier-document-86" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-87" title="§ 5.9 Integrity Protection of Controllers">§ 5.9 Integrity Protection of Controllers</a> <a href="#ref-for-dfn-controlled-identifier-document-88" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-89" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-90" title="§ 5.10 Level of Assurance">§ 5.10 Level of Assurance</a> <a href="#ref-for-dfn-controlled-identifier-document-91" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-92" title="§ 5.11 Service Endpoints for Authentication and Authorization">§ 5.11 Service Endpoints for Authentication and Authorization</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-93" title="§ 6. Privacy Considerations">§ 6. Privacy Considerations</a> <a href="#ref-for-dfn-controlled-identifier-document-94" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-95" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-96" title="§ 6.1 Keep Personal Data Private">§ 6.1 Keep Personal Data Private</a> <a href="#ref-for-dfn-controlled-identifier-document-97" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-98" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-99" title="§ 6.2 Relationship to the Same-Origin Policy">§ 6.2 Relationship to the Same-Origin Policy</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-100" title="§ 6.4 Controller Document Correlation Risks">§ 6.4 Controller Document Correlation Risks</a> <a href="#ref-for-dfn-controlled-identifier-document-101" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-102" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-103" title="§ 6.5 Subject Classification">§ 6.5 Subject Classification</a> <a href="#ref-for-dfn-controlled-identifier-document-104" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-105" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controlled-identifier-document-106" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-107" title="§ 6.6 Service Privacy">§ 6.6 Service Privacy</a> <a href="#ref-for-dfn-controlled-identifier-document-108" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controlled-identifier-document-109" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controlled-identifier-document-110" title="Reference 4">(4)</a> <a href="#ref-for-dfn-controlled-identifier-document-111" title="Reference 5">(5)</a> <a href="#ref-for-dfn-controlled-identifier-document-112" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dfn-controlled-identifier-document-113" title="§ A.1 application/cid">§ A.1 application/cid</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-controller-s" aria-label="Links in this document to definition: controller">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-controller-s" aria-label="Permalink for definition: controller. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-controller-s-1" title="§ 1.4 Terminology">§ 1.4 Terminology</a> 
    </li><li>
      <a href="#ref-for-dfn-controller-s-2" title="§ 2.1.2 Controllers">§ 2.1.2 Controllers</a> <a href="#ref-for-dfn-controller-s-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-s-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controller-s-5" title="Reference 4">(4)</a> <a href="#ref-for-dfn-controller-s-6" title="Reference 5">(5)</a> <a href="#ref-for-dfn-controller-s-7" title="Reference 6">(6)</a> <a href="#ref-for-dfn-controller-s-8" title="Reference 7">(7)</a> <a href="#ref-for-dfn-controller-s-9" title="Reference 8">(8)</a> <a href="#ref-for-dfn-controller-s-10" title="Reference 9">(9)</a> <a href="#ref-for-dfn-controller-s-11" title="Reference 10">(10)</a> <a href="#ref-for-dfn-controller-s-12" title="Reference 11">(11)</a> <a href="#ref-for-dfn-controller-s-13" title="Reference 12">(12)</a> <a href="#ref-for-dfn-controller-s-14" title="Reference 13">(13)</a> <a href="#ref-for-dfn-controller-s-15" title="Reference 14">(14)</a> <a href="#ref-for-dfn-controller-s-16" title="Reference 15">(15)</a> <a href="#ref-for-dfn-controller-s-17" title="Reference 16">(16)</a> <a href="#ref-for-dfn-controller-s-18" title="Reference 17">(17)</a> <a href="#ref-for-dfn-controller-s-19" title="Reference 18">(18)</a> 
    </li><li>
      <a href="#ref-for-dfn-controller-s-20" title="§ 2.1.4 Services">§ 2.1.4 Services</a> <a href="#ref-for-dfn-controller-s-21" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-controller-s-22" title="§ 2.2 Verification Methods">§ 2.2 Verification Methods</a> <a href="#ref-for-dfn-controller-s-23" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-s-24" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controller-s-25" title="Reference 4">(4)</a> <a href="#ref-for-dfn-controller-s-26" title="Reference 5">(5)</a> <a href="#ref-for-dfn-controller-s-27" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dfn-controller-s-28" title="§ 2.3.2 Assertion">§ 2.3.2 Assertion</a> 
    </li><li>
      <a href="#ref-for-dfn-controller-s-29" title="§ 2.3.3 Key Agreement">§ 2.3.3 Key Agreement</a> <a href="#ref-for-dfn-controller-s-30" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-controller-s-31" title="§ 2.3.4 Capability Invocation">§ 2.3.4 Capability Invocation</a> <a href="#ref-for-dfn-controller-s-32" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-s-33" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-controller-s-34" title="§ 2.3.5 Capability Delegation">§ 2.3.5 Capability Delegation</a> <a href="#ref-for-dfn-controller-s-35" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-s-36" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-controller-s-37" title="§ 5.4 Verification Method Rotation">§ 5.4 Verification Method Rotation</a> <a href="#ref-for-dfn-controller-s-38" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-controller-s-39" title="§ 5.5 Verification Method Revocation">§ 5.5 Verification Method Revocation</a> <a href="#ref-for-dfn-controller-s-40" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-s-41" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controller-s-42" title="Reference 4">(4)</a> <a href="#ref-for-dfn-controller-s-43" title="Reference 5">(5)</a> <a href="#ref-for-dfn-controller-s-44" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dfn-controller-s-45" title="§ 5.5.1 Revocation Semantics">§ 5.5.1 Revocation Semantics</a> 
    </li><li>
      <a href="#ref-for-dfn-controller-s-46" title="§ 6. Privacy Considerations">§ 6. Privacy Considerations</a> 
    </li><li>
      <a href="#ref-for-dfn-controller-s-47" title="§ 6.3 Identifier Correlation Risks">§ 6.3 Identifier Correlation Risks</a> <a href="#ref-for-dfn-controller-s-48" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-controller-s-49" title="§ 6.5 Subject Classification">§ 6.5 Subject Classification</a> 
    </li><li>
      <a href="#ref-for-dfn-controller-s-50" title="§ 6.6 Service Privacy">§ 6.6 Service Privacy</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-cryptosuite" aria-label="Links in this document to definition: cryptographic suite">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-cryptosuite" aria-label="Permalink for definition: cryptographic suite. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-cryptosuite-1" title="§ 2.2.1 Verification Material">§ 2.2.1 Verification Material</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-private-key" aria-label="Links in this document to definition: private key">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-private-key" aria-label="Permalink for definition: private key. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-private-key-1" title="§ 1.4 Terminology">§ 1.4 Terminology</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-proof" aria-label="Links in this document to definition: proof">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-proof" aria-label="Permalink for definition: proof. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-proof-1" title="§ 1. Introduction">§ 1. Introduction</a> <a href="#ref-for-dfn-proof-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-proof-3" title="§ 1.4 Terminology">§ 1.4 Terminology</a> <a href="#ref-for-dfn-proof-4" title="Reference 2">(2)</a> <a href="#ref-for-dfn-proof-5" title="Reference 3">(3)</a> <a href="#ref-for-dfn-proof-6" title="Reference 4">(4)</a> <a href="#ref-for-dfn-proof-7" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-proof-8" title="§ 2.1.1 Subjects">§ 2.1.1 Subjects</a> 
    </li><li>
      <a href="#ref-for-dfn-proof-9" title="§ 2.1.2 Controllers">§ 2.1.2 Controllers</a> <a href="#ref-for-dfn-proof-10" title="Reference 2">(2)</a> <a href="#ref-for-dfn-proof-11" title="Reference 3">(3)</a> <a href="#ref-for-dfn-proof-12" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-proof-13" title="§ 2.2 Verification Methods">§ 2.2 Verification Methods</a> <a href="#ref-for-dfn-proof-14" title="Reference 2">(2)</a> <a href="#ref-for-dfn-proof-15" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-proof-16" title="§ 2.3 Verification Relationships">§ 2.3 Verification Relationships</a> 
    </li><li>
      <a href="#ref-for-dfn-proof-17" title="§ 2.3.1 Authentication">§ 2.3.1 Authentication</a> <a href="#ref-for-dfn-proof-18" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-proof-19" title="§ 3.4 Processing Errors">§ 3.4 Processing Errors</a> <a href="#ref-for-dfn-proof-20" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-proof-21" title="§ 5.4 Verification Method Rotation">§ 5.4 Verification Method Rotation</a> <a href="#ref-for-dfn-proof-22" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-proof-23" title="§ 5.5 Verification Method Revocation">§ 5.5 Verification Method Revocation</a> <a href="#ref-for-dfn-proof-24" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-proof-25" title="§ 5.5.1 Revocation Semantics">§ 5.5.1 Revocation Semantics</a> 
    </li><li>
      <a href="#ref-for-dfn-proof-26" title="§ 5.10 Level of Assurance">§ 5.10 Level of Assurance</a> 
    </li><li>
      <a href="#ref-for-dfn-proof-27" title="§ 7.1 Presenting Time Values">§ 7.1 Presenting Time Values</a> <a href="#ref-for-dfn-proof-28" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-public-key" aria-label="Links in this document to definition: public key">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-public-key" aria-label="Permalink for definition: public key. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-public-key-1" title="§ 1. Introduction">§ 1. Introduction</a> 
    </li><li>
      <a href="#ref-for-dfn-public-key-2" title="§ 2.2 Verification Methods">§ 2.2 Verification Methods</a> <a href="#ref-for-dfn-public-key-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-public-key-4" title="§ 2.2.3 JsonWebKey">§ 2.2.3 JsonWebKey</a> <a href="#ref-for-dfn-public-key-5" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-public-key-6" title="§ 2.3.1 Authentication">§ 2.3.1 Authentication</a> 
    </li><li>
      <a href="#ref-for-dfn-public-key-7" title="§ 2.3.3 Key Agreement">§ 2.3.3 Key Agreement</a> 
    </li><li>
      <a href="#ref-for-dfn-public-key-8" title="§ 3.3 Retrieve Verification Method">§ 3.3 Retrieve Verification Method</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-subjects" aria-label="Links in this document to definition: subject">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-subjects" aria-label="Permalink for definition: subject. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-subjects-1" title="§ 1. Introduction">§ 1. Introduction</a> <a href="#ref-for-dfn-subjects-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-subjects-3" title="§ 1.4 Terminology">§ 1.4 Terminology</a> 
    </li><li>
      <a href="#ref-for-dfn-subjects-4" title="§ 2.1 Controller Documents">§ 2.1 Controller Documents</a> 
    </li><li>
      <a href="#ref-for-dfn-subjects-5" title="§ 2.1.1 Subjects">§ 2.1.1 Subjects</a> <a href="#ref-for-dfn-subjects-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-subjects-7" title="Reference 3">(3)</a> <a href="#ref-for-dfn-subjects-8" title="Reference 4">(4)</a> <a href="#ref-for-dfn-subjects-9" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-subjects-10" title="§ 2.1.3 Also Known As">§ 2.1.3 Also Known As</a> <a href="#ref-for-dfn-subjects-11" title="Reference 2">(2)</a> <a href="#ref-for-dfn-subjects-12" title="Reference 3">(3)</a> <a href="#ref-for-dfn-subjects-13" title="Reference 4">(4)</a> <a href="#ref-for-dfn-subjects-14" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-subjects-15" title="§ 2.3 Verification Relationships">§ 2.3 Verification Relationships</a> 
    </li><li>
      <a href="#ref-for-dfn-subjects-16" title="§ 2.3.1 Authentication">§ 2.3.1 Authentication</a> 
    </li><li>
      <a href="#ref-for-dfn-subjects-17" title="§ 5.2 Identifier Ambiguity">§ 5.2 Identifier Ambiguity</a> <a href="#ref-for-dfn-subjects-18" title="Reference 2">(2)</a> <a href="#ref-for-dfn-subjects-19" title="Reference 3">(3)</a> <a href="#ref-for-dfn-subjects-20" title="Reference 4">(4)</a> <a href="#ref-for-dfn-subjects-21" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-subjects-22" title="§ 5.11 Service Endpoints for Authentication and Authorization">§ 5.11 Service Endpoints for Authentication and Authorization</a> <a href="#ref-for-dfn-subjects-23" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-subjects-24" title="§ 6.3 Identifier Correlation Risks">§ 6.3 Identifier Correlation Risks</a> 
    </li><li>
      <a href="#ref-for-dfn-subjects-25" title="§ 6.5 Subject Classification">§ 6.5 Subject Classification</a> <a href="#ref-for-dfn-subjects-26" title="Reference 2">(2)</a> <a href="#ref-for-dfn-subjects-27" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-subjects-28" title="§ 6.6 Service Privacy">§ 6.6 Service Privacy</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verification-method" aria-label="Links in this document to definition: verification method">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verification-method" aria-label="Permalink for definition: verification method. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-verification-method-1" title="§ 1. Introduction">§ 1. Introduction</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-2" title="§ 1.4 Terminology">§ 1.4 Terminology</a> <a href="#ref-for-dfn-verification-method-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-4" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-5" title="§ 2. Data Model">§ 2. Data Model</a> <a href="#ref-for-dfn-verification-method-6" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-7" title="§ 2.1 Controller Documents">§ 2.1 Controller Documents</a> <a href="#ref-for-dfn-verification-method-8" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-9" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-10" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-method-11" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-method-12" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-13" title="§ 2.1.2 Controllers">§ 2.1.2 Controllers</a> <a href="#ref-for-dfn-verification-method-14" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-15" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-16" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-method-17" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-18" title="§ 2.2 Verification Methods">§ 2.2 Verification Methods</a> <a href="#ref-for-dfn-verification-method-19" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-20" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-21" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-method-22" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-method-23" title="Reference 6">(6)</a> <a href="#ref-for-dfn-verification-method-24" title="Reference 7">(7)</a> <a href="#ref-for-dfn-verification-method-25" title="Reference 8">(8)</a> <a href="#ref-for-dfn-verification-method-26" title="Reference 9">(9)</a> <a href="#ref-for-dfn-verification-method-27" title="Reference 10">(10)</a> <a href="#ref-for-dfn-verification-method-28" title="Reference 11">(11)</a> <a href="#ref-for-dfn-verification-method-29" title="Reference 12">(12)</a> <a href="#ref-for-dfn-verification-method-30" title="Reference 13">(13)</a> <a href="#ref-for-dfn-verification-method-31" title="Reference 14">(14)</a> <a href="#ref-for-dfn-verification-method-32" title="Reference 15">(15)</a> <a href="#ref-for-dfn-verification-method-33" title="Reference 16">(16)</a> <a href="#ref-for-dfn-verification-method-34" title="Reference 17">(17)</a> <a href="#ref-for-dfn-verification-method-35" title="Reference 18">(18)</a> <a href="#ref-for-dfn-verification-method-36" title="Reference 19">(19)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-37" title="§ 2.2.1 Verification Material">§ 2.2.1 Verification Material</a> <a href="#ref-for-dfn-verification-method-38" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-39" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-40" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-method-41" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-method-42" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-43" title="§ 2.2.2 Multikey">§ 2.2.2 Multikey</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-44" title="§ 2.2.3 JsonWebKey">§ 2.2.3 JsonWebKey</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-45" title="§ 2.2.4 Referring to Verification Methods">§ 2.2.4 Referring to Verification Methods</a> <a href="#ref-for-dfn-verification-method-46" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-47" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-48" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-method-49" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-method-50" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-51" title="§ 2.3 Verification Relationships">§ 2.3 Verification Relationships</a> <a href="#ref-for-dfn-verification-method-52" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-53" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-54" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-method-55" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-method-56" title="Reference 6">(6)</a> <a href="#ref-for-dfn-verification-method-57" title="Reference 7">(7)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-58" title="§ 2.3.1 Authentication">§ 2.3.1 Authentication</a> <a href="#ref-for-dfn-verification-method-59" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-60" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-61" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-62" title="§ 2.3.2 Assertion">§ 2.3.2 Assertion</a> <a href="#ref-for-dfn-verification-method-63" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-64" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-65" title="§ 2.3.3 Key Agreement">§ 2.3.3 Key Agreement</a> <a href="#ref-for-dfn-verification-method-66" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-67" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-68" title="§ 2.3.4 Capability Invocation">§ 2.3.4 Capability Invocation</a> <a href="#ref-for-dfn-verification-method-69" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-70" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-71" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-72" title="§ 2.3.5 Capability Delegation">§ 2.3.5 Capability Delegation</a> <a href="#ref-for-dfn-verification-method-73" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-74" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-75" title="§ 3.3 Retrieve Verification Method">§ 3.3 Retrieve Verification Method</a> <a href="#ref-for-dfn-verification-method-76" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-77" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-78" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-method-79" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-method-80" title="Reference 6">(6)</a> <a href="#ref-for-dfn-verification-method-81" title="Reference 7">(7)</a> <a href="#ref-for-dfn-verification-method-82" title="Reference 8">(8)</a> <a href="#ref-for-dfn-verification-method-83" title="Reference 9">(9)</a> <a href="#ref-for-dfn-verification-method-84" title="Reference 10">(10)</a> <a href="#ref-for-dfn-verification-method-85" title="Reference 11">(11)</a> <a href="#ref-for-dfn-verification-method-86" title="Reference 12">(12)</a> <a href="#ref-for-dfn-verification-method-87" title="Reference 13">(13)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-88" title="§ 3.4 Processing Errors">§ 3.4 Processing Errors</a> <a href="#ref-for-dfn-verification-method-89" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-90" title="§ 5.1.1 Proving Control of an Identifier and/or Controller Document">§ 5.1.1 Proving Control of an Identifier and/or Controller Document</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-91" title="§ 5.4 Verification Method Rotation">§ 5.4 Verification Method Rotation</a> <a href="#ref-for-dfn-verification-method-92" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-93" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-94" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-method-95" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-method-96" title="Reference 6">(6)</a> <a href="#ref-for-dfn-verification-method-97" title="Reference 7">(7)</a> <a href="#ref-for-dfn-verification-method-98" title="Reference 8">(8)</a> <a href="#ref-for-dfn-verification-method-99" title="Reference 9">(9)</a> <a href="#ref-for-dfn-verification-method-100" title="Reference 10">(10)</a> <a href="#ref-for-dfn-verification-method-101" title="Reference 11">(11)</a> <a href="#ref-for-dfn-verification-method-102" title="Reference 12">(12)</a> <a href="#ref-for-dfn-verification-method-103" title="Reference 13">(13)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-104" title="§ 5.5 Verification Method Revocation">§ 5.5 Verification Method Revocation</a> <a href="#ref-for-dfn-verification-method-105" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-106" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-107" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-method-108" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-method-109" title="Reference 6">(6)</a> <a href="#ref-for-dfn-verification-method-110" title="Reference 7">(7)</a> <a href="#ref-for-dfn-verification-method-111" title="Reference 8">(8)</a> <a href="#ref-for-dfn-verification-method-112" title="Reference 9">(9)</a> <a href="#ref-for-dfn-verification-method-113" title="Reference 10">(10)</a> <a href="#ref-for-dfn-verification-method-114" title="Reference 11">(11)</a> <a href="#ref-for-dfn-verification-method-115" title="Reference 12">(12)</a> <a href="#ref-for-dfn-verification-method-116" title="Reference 13">(13)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-117" title="§ 5.5.1 Revocation Semantics">§ 5.5.1 Revocation Semantics</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-118" title="§ 6.4 Controller Document Correlation Risks">§ 6.4 Controller Document Correlation Risks</a> <a href="#ref-for-dfn-verification-method-119" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-120" title="§ 6.5 Subject Classification">§ 6.5 Subject Classification</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verification-relationship" aria-label="Links in this document to definition: verification relationship">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verification-relationship" aria-label="Permalink for definition: verification relationship. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-verification-relationship-1" title="§ 1. Introduction">§ 1. Introduction</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-relationship-2" title="§ 2. Data Model">§ 2. Data Model</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-relationship-3" title="§ 2.1.2 Controllers">§ 2.1.2 Controllers</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-relationship-4" title="§ 2.2.4 Referring to Verification Methods">§ 2.2.4 Referring to Verification Methods</a> <a href="#ref-for-dfn-verification-relationship-5" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-relationship-6" title="§ 2.3 Verification Relationships">§ 2.3 Verification Relationships</a> <a href="#ref-for-dfn-verification-relationship-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-relationship-8" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-relationship-9" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-relationship-10" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-relationship-11" title="Reference 6">(6)</a> <a href="#ref-for-dfn-verification-relationship-12" title="Reference 7">(7)</a> <a href="#ref-for-dfn-verification-relationship-13" title="Reference 8">(8)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-relationship-14" title="§ 2.3.1 Authentication">§ 2.3.1 Authentication</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-relationship-15" title="§ 2.3.2 Assertion">§ 2.3.2 Assertion</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-relationship-16" title="§ 2.3.3 Key Agreement">§ 2.3.3 Key Agreement</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-relationship-17" title="§ 2.3.4 Capability Invocation">§ 2.3.4 Capability Invocation</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-relationship-18" title="§ 2.3.5 Capability Delegation">§ 2.3.5 Capability Delegation</a> <a href="#ref-for-dfn-verification-relationship-19" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-relationship-20" title="§ 3.3 Retrieve Verification Method">§ 3.3 Retrieve Verification Method</a> <a href="#ref-for-dfn-verification-relationship-21" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-relationship-22" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-relationship-23" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-relationship-24" title="§ 3.4 Processing Errors">§ 3.4 Processing Errors</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-relationship-25" title="§ 5.1.1 Proving Control of an Identifier and/or Controller Document">§ 5.1.1 Proving Control of an Identifier and/or Controller Document</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-relationship-26" title="§ 5.1.2 Binding to Physical Identity">§ 5.1.2 Binding to Physical Identity</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-relationship-27" title="§ 5.5 Verification Method Revocation">§ 5.5 Verification Method Revocation</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-relationship-28" title="§ 5.10 Level of Assurance">§ 5.10 Level of Assurance</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-relationship-29" title="§ 6.5 Subject Classification">§ 6.5 Subject Classification</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-identifier" aria-label="Links in this document to definition: identifier">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-identifier" aria-label="Permalink for definition: identifier. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-identifier-1" title="§ 1. Introduction">§ 1. Introduction</a> <a href="#ref-for-dfn-identifier-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-identifier-3" title="§ 2. Data Model">§ 2. Data Model</a> 
    </li><li>
      <a href="#ref-for-dfn-identifier-4" title="§ 2.1.1 Subjects">§ 2.1.1 Subjects</a> <a href="#ref-for-dfn-identifier-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-identifier-6" title="Reference 3">(3)</a> <a href="#ref-for-dfn-identifier-7" title="Reference 4">(4)</a> <a href="#ref-for-dfn-identifier-8" title="Reference 5">(5)</a> <a href="#ref-for-dfn-identifier-9" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dfn-identifier-10" title="§ 2.1.2 Controllers">§ 2.1.2 Controllers</a> <a href="#ref-for-dfn-identifier-11" title="Reference 2">(2)</a> <a href="#ref-for-dfn-identifier-12" title="Reference 3">(3)</a> <a href="#ref-for-dfn-identifier-13" title="Reference 4">(4)</a> <a href="#ref-for-dfn-identifier-14" title="Reference 5">(5)</a> <a href="#ref-for-dfn-identifier-15" title="Reference 6">(6)</a> <a href="#ref-for-dfn-identifier-16" title="Reference 7">(7)</a> <a href="#ref-for-dfn-identifier-17" title="Reference 8">(8)</a> 
    </li><li>
      <a href="#ref-for-dfn-identifier-18" title="§ 2.1.4 Services">§ 2.1.4 Services</a> 
    </li><li>
      <a href="#ref-for-dfn-identifier-19" title="§ 5.2 Identifier Ambiguity">§ 5.2 Identifier Ambiguity</a> <a href="#ref-for-dfn-identifier-20" title="Reference 2">(2)</a> <a href="#ref-for-dfn-identifier-21" title="Reference 3">(3)</a> <a href="#ref-for-dfn-identifier-22" title="Reference 4">(4)</a> <a href="#ref-for-dfn-identifier-23" title="Reference 5">(5)</a> <a href="#ref-for-dfn-identifier-24" title="Reference 6">(6)</a> <a href="#ref-for-dfn-identifier-25" title="Reference 7">(7)</a> <a href="#ref-for-dfn-identifier-26" title="Reference 8">(8)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-base-identifier" aria-label="Links in this document to definition: base identifier">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-base-identifier" aria-label="Permalink for definition: base identifier. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-base-identifier-1" title="§ 2.1.1 Subjects">§ 2.1.1 Subjects</a> <a href="#ref-for-dfn-base-identifier-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-base-identifier-3" title="§ 2.3.1 Authentication">§ 2.3.1 Authentication</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-canonical-url" aria-label="Links in this document to definition: canonical URL">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-canonical-url" aria-label="Permalink for definition: canonical URL. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-canonical-url-1" title="§ 2.1.1 Subjects">§ 2.1.1 Subjects</a> <a href="#ref-for-dfn-canonical-url-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-canonical-url-3" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-service" aria-label="Links in this document to definition: service">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-service" aria-label="Permalink for definition: service. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-service-1" title="§ 1. Introduction">§ 1. Introduction</a> <a href="#ref-for-dfn-service-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-service-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-service-4" title="§ 2.1 Controller Documents">§ 2.1 Controller Documents</a> 
    </li><li>
      <a href="#ref-for-dfn-service-5" title="§ 2.1.4 Services">§ 2.1.4 Services</a> <a href="#ref-for-dfn-service-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-service-7" title="Reference 3">(3)</a> <a href="#ref-for-dfn-service-8" title="Reference 4">(4)</a> <a href="#ref-for-dfn-service-9" title="Reference 5">(5)</a> <a href="#ref-for-dfn-service-10" title="Reference 6">(6)</a> <a href="#ref-for-dfn-service-11" title="Reference 7">(7)</a> <a href="#ref-for-dfn-service-12" title="Reference 8">(8)</a> <a href="#ref-for-dfn-service-13" title="Reference 9">(9)</a> 
    </li><li>
      <a href="#ref-for-dfn-service-14" title="§ 5.11 Service Endpoints for Authentication and Authorization">§ 5.11 Service Endpoints for Authentication and Authorization</a> <a href="#ref-for-dfn-service-15" title="Reference 2">(2)</a> <a href="#ref-for-dfn-service-16" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-service-17" title="§ 6.6 Service Privacy">§ 6.6 Service Privacy</a> <a href="#ref-for-dfn-service-18" title="Reference 2">(2)</a> <a href="#ref-for-dfn-service-19" title="Reference 3">(3)</a> <a href="#ref-for-dfn-service-20" title="Reference 4">(4)</a> <a href="#ref-for-dfn-service-21" title="Reference 5">(5)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verification-method-definition" aria-label="Links in this document to definition: verification method definition">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verification-method-definition" aria-label="Permalink for definition: verification method definition. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-verification-method-definition-1" title="§ 2.2 Verification Methods">§ 2.2 Verification Methods</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-method-definition-2" title="§ 2.3 Verification Relationships">§ 2.3 Verification Relationships</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verificationmethod" aria-label="Links in this document to definition: verificationMethod">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verificationmethod" aria-label="Permalink for definition: verificationMethod. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verification-method-identifier" aria-label="Links in this document to definition: verification method identifier">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verification-method-identifier" aria-label="Permalink for definition: verification method identifier. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-verification-method-identifier-1" title="§ 3.3 Retrieve Verification Method">§ 3.3 Retrieve Verification Method</a> <a href="#ref-for-dfn-verification-method-identifier-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-identifier-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-identifier-4" title="Reference 4">(4)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-revoked" aria-label="Links in this document to definition: revoked">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-revoked" aria-label="Permalink for definition: revoked. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-publickeymultibase" aria-label="Links in this document to definition: publicKeyMultibase">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-publickeymultibase" aria-label="Permalink for definition: publicKeyMultibase. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-secretkeymultibase" aria-label="Links in this document to definition: secretKeyMultibase">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-secretkeymultibase" aria-label="Permalink for definition: secretKeyMultibase. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-publickeyjwk" aria-label="Links in this document to definition: publicKeyJwk">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-publickeyjwk" aria-label="Permalink for definition: publicKeyJwk. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-secretkeyjwk" aria-label="Links in this document to definition: secretKeyJwk">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-secretkeyjwk" aria-label="Permalink for definition: secretKeyJwk. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-defn-keyAgreement" aria-label="Links in this document to definition: keyAgreement">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#defn-keyAgreement" aria-label="Permalink for definition: keyAgreement. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-defn-keyAgreement-1" title="§ 2.3 Verification Relationships">§ 2.3 Verification Relationships</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-multibase-header" aria-label="Links in this document to definition: Multibase header">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-multibase-header" aria-label="Permalink for definition: Multibase header. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-multibase-header-1" title="§ 4.3.1 The multibase Datatype">§ 4.3.1 The multibase Datatype</a> <a href="#ref-for-dfn-multibase-header-2" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-multiformats" aria-label="Links in this document to definition: Multiformats">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-multiformats" aria-label="Permalink for definition: Multiformats. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-pairwise-identifier" aria-label="Links in this document to definition: pairwise identifier">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-pairwise-identifier" aria-label="Permalink for definition: pairwise identifier. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-pairwise-identifier-1" title="§ 6.3 Identifier Correlation Risks">§ 6.3 Identifier Correlation Risks</a> <a href="#ref-for-dfn-pairwise-identifier-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-pairwise-identifier-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-pairwise-identifier-4" title="§ 6.4 Controller Document Correlation Risks">§ 6.4 Controller Document Correlation Risks</a> <a href="#ref-for-dfn-pairwise-identifier-5" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>